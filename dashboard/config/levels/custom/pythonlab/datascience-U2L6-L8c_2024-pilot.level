<Pythonlab>
  <config><![CDATA[{
  "published": true,
  "game_id": 72,
  "created_at": "2024-09-16T17:14:33.000Z",
  "level_num": "custom",
  "user_id": 18602,
  "properties": {
    "encrypted": "false",
    "long_instructions": "# New York City Air Pollution\r\n\r\n::: details [**✅ Step 1**]\r\nLoad the data and print the `head()`.\r\n:::\r\n\r\n::: details [**✅ Step 2**]\r\nYou'll notice there's a missing value in these rows. Replace the value of the empty element with **November** and print the `head()` again to confirm the updated value.\r\n:::\r\n\r\n::: details [**✅ Step 3**]\r\nUse the indexing operator to create a new DataFrame that contains entries where **Nitrogen Dioxide > 25**.  Print this subgroup.\r\n:::\r\n\r\n::: details [**✅ Step 4**]\r\n- Group data by the **Year** attribute. \r\n- Determine the average Nitrogen Dioxide value for each year. \r\n- Print these values.\r\n:::\r\n\r\n\r\n\r\n\r\n\r\n",
    "ai_tutor_available": "false",
    "submittable": "false",
    "hide_share_and_remix": "false",
    "predict_settings": {
      "isPredictLevel": false
    },
    "start_sources": {
      "files": {
        "0": {
          "id": "0",
          "name": "main.py",
          "language": "py",
          "contents": "import pandas as pd\n\n\n# Step 1\n\n\n# Step 2\n\n\n# Step 3\n\n\n# Step 4\n",
          "folderId": "0",
          "active": true,
          "open": true
        },
        "1": {
          "id": "1",
          "name": "ozone_nyc.csv",
          "language": "csv",
          "contents": "Month,Year,Location,Nitrogen Dioxide,Ozone\nOctober,2004,New York City,21.4448,357.578\n,2004,New York City,21.3901,341.235\nDecember,2004,New York City,24.3165,373.72\nJanuary,2005,New York City,18.6999,406.587\nFebruary,2005,New York City,23.625,417.148\nMarch,2005,New York City,19.4422,455.071\nApril,2005,New York City,21.681,444.608\nMay,2005,New York City,26.6562,456.196\nJune,2005,New York City,14.9779,393.892\nJuly,2005,New York City,14.5755,388.962\nAugust,2005,New York City,16.4903,376.653\nSeptember,2005,New York City,18.1885,359.431\nOctober,2005,New York City,24.8035,335.338\nNovember,2005,New York City,18.6414,340.151\nDecember,2005,New York City,24.3997,392.908\nJanuary,2006,New York City,21.6962,380.621\nFebruary,2006,New York City,25.9256,427.62\nMarch,2006,New York City,24.4936,441.466\nApril,2006,New York City,20.8246,436.603\nMay,2006,New York City,15.2572,440.581\nJune,2006,New York City,12.9584,414.302\nJuly,2006,New York City,13.6318,393.9\nAugust,2006,New York City,12.234,385.913\nSeptember,2006,New York City,11.9404,366.901\nOctober,2006,New York City,18.9465,377.904\nNovember,2006,New York City,21.2108,358.957\nDecember,2006,New York City,19.6616,369.154\nJanuary,2007,New York City,16.0655,406.758\nFebruary,2007,New York City,19.4094,450.972\nMarch,2007,New York City,20.497,421.733\nApril,2007,New York City,17.2094,441.08\nMay,2007,New York City,16.8304,429.358\nJune,2007,New York City,12.1696,407.595\nJuly,2007,New York City,10.0839,397.967\nAugust,2007,New York City,14.0504,378.954\nSeptember,2007,New York City,15.57,359.362\nOctober,2007,New York City,20.7719,322.237\nNovember,2007,New York City,20.8522,350.138\nDecember,2007,New York City,15.4079,357.547\nJanuary,2008,New York City,15.4185,390.321\nFebruary,2008,New York City,21.8586,409.531\nMarch,2008,New York City,19.5798,422.887\nApril,2008,New York City,19.6348,408.095\nMay,2008,New York City,13.9391,430.117\nJune,2008,New York City,12.5028,396.371\nJuly,2008,New York City,10.9497,388.392\nAugust,2008,New York City,11.1076,390.707\nSeptember,2008,New York City,12.8904,356.25\nOctober,2008,New York City,16.0657,360.582\nNovember,2008,New York City,14.336,360.643\nDecember,2008,New York City,18.3973,365.547\nJanuary,2009,New York City,20.8982,407.699\nFebruary,2009,New York City,12.4615,433.815\nMarch,2009,New York City,19.9466,411.592\nApril,2009,New York City,12.7163,429.312\nMay,2009,New York City,12.543,412.833\nJune,2009,New York City,8.74849,410.339\nJuly,2009,New York City,7.7351,399.485\nAugust,2009,New York City,11.9825,376.351\nSeptember,2009,New York City,10.5536,371.744\nOctober,2009,New York City,15.4783,347.563\nNovember,2009,New York City,16.054,342.798\nDecember,2009,New York City,16.0453,402.988\nJanuary,2010,New York City,14.0263,455.456\nFebruary,2010,New York City,14.1716,481.537\nMarch,2010,New York City,14.3445,452.643\nApril,2010,New York City,10.5701,463.435\nMay,2010,New York City,13.6873,423.006\nJune,2010,New York City,12.9109,408.137\nJuly,2010,New York City,7.58269,398.728\nAugust,2010,New York City,8.6017,383.17\nSeptember,2010,New York City,8.98291,363.72\nOctober,2010,New York City,12.9457,366.661\nNovember,2010,New York City,14.4979,352.286\nDecember,2010,New York City,14.5608,406.762\nJanuary,2011,New York City,13.27,419.048\nFebruary,2011,New York City,20.7507,404.431\nMarch,2011,New York City,10.3114,434.839\nApril,2011,New York City,10.6691,404.381\nMay,2011,New York City,10.1663,411.818\nJune,2011,New York City,9.9655,399.526\nJuly,2011,New York City,8.18558,384.114\nAugust,2011,New York City,6.2835,375.792\nSeptember,2011,New York City,11.3586,351.744\nOctober,2011,New York City,12.6044,346.289\nNovember,2011,New York City,13.3474,334.644\nDecember,2011,New York City,13.4291,347.583\nJanuary,2012,New York City,13.5292,417.021\nFebruary,2012,New York City,11.0613,416.202\nMarch,2012,New York City,13.9376,394.761\nApril,2012,New York City,9.24525,433.788\nMay,2012,New York City,8.14587,411.54\nJune,2012,New York City,8.40906,415.615\nJuly,2012,New York City,7.40788,387.228\nAugust,2012,New York City,10.7152,380.875\nSeptember,2012,New York City,11.3697,364.886\nOctober,2012,New York City,11.6855,342.042\nNovember,2012,New York City,15.9061,363.327\nDecember,2012,New York City,13.1638,370.87\nJanuary,2013,New York City,11.2405,373.744\nFebruary,2013,New York City,13.5219,427.036\nMarch,2013,New York City,10.7326,478.582\nApril,2013,New York City,12.2614,441.795\nMay,2013,New York City,9.53972,434.229\nJune,2013,New York City,7.51856,401.042\nJuly,2013,New York City,7.44733,387.205\nAugust,2013,New York City,7.09689,388.495\nSeptember,2013,New York City,8.83898,374.5\nOctober,2013,New York City,14.6247,351.761\nNovember,2013,New York City,14.6845,345.618\nDecember,2013,New York City,18.1723,395.369\nJanuary,2014,New York City,21.5517,419.114\nFebruary,2014,New York City,25.9998,442.182\nMarch,2014,New York City,15.1323,449.685\nApril,2014,New York City,9.60639,419.643\nMay,2014,New York City,7.87845,432.717\nJune,2014,New York City,11.6556,404.415\nJuly,2014,New York City,7.25833,401.46\nAugust,2014,New York City,7.93903,396.333\nSeptember,2014,New York City,9.39717,358.862\nOctober,2014,New York City,10.8681,355.935\nNovember,2014,New York City,13.5022,354.256\nDecember,2014,New York City,9.11496,376.101\nJanuary,2015,New York City,13.4013,429.125\nFebruary,2015,New York City,20.4398,452.176\nMarch,2015,New York City,14.9154,432.987\nApril,2015,New York City,9.03319,437.65\nMay,2015,New York City,11.6508,415.987\nJune,2015,New York City,6.83009,406.845\nJuly,2015,New York City,7.13967,404.601\nAugust,2015,New York City,5.65089,392.917\nSeptember,2015,New York City,8.79215,367.356\nOctober,2015,New York City,12.9867,358.954\nNovember,2015,New York City,11.1724,334.717\nDecember,2015,New York City,13.0691,346.25\nJanuary,2016,New York City,11.5215,405.243\nFebruary,2016,New York City,18.0868,435.056\nMarch,2016,New York City,12.6298,424.327\nApril,2016,New York City,10.3395,444.22\nMay,2016,New York City,10.5598,437.137\nJune,2016,New York City,9.55518,403.99\nJuly,2016,New York City,8.79179,386.734\nAugust,2016,New York City,6.4161,375.548\nSeptember,2016,New York City,6.49711,352.881\nOctober,2016,New York City,9.43156,353.577\nNovember,2016,New York City,8.81719,339.794\nDecember,2016,New York City,8.80614,372.039\nJanuary,2017,New York City,6.50745,394.781\nFebruary,2017,New York City,12.6879,417.194\nMarch,2017,New York City,6.4583,436.719\nApril,2017,New York City,7.79941,411.65\nMay,2017,New York City,6.43321,420.286\nJune,2017,New York City,4.93194,415.792\nJuly,2017,New York City,5.74547,388.238\nAugust,2017,New York City,4.98636,377.381\nSeptember,2017,New York City,5.1658,355.69\nOctober,2017,New York City,8.5261,347.606\nNovember,2017,New York City,8.84373,355.238\nDecember,2017,New York City,17.3075,387.205\nJanuary,2018,New York City,8.61834,404.964\nFebruary,2018,New York City,11.0723,403.162\nMarch,2018,New York City,9.98548,491.463\nApril,2018,New York City,8.72573,467.143\nMay,2018,New York City,6.89626,410.75\nJune,2018,New York City,4.85209,403.574\nJuly,2018,New York City,5.37983,391.804\nAugust,2018,New York City,7.23755,380.835\nSeptember,2018,New York City,4.65838,345.726\nOctober,2018,New York City,5.76362,361.841\nNovember,2018,New York City,8.0288,360.708\nDecember,2018,New York City,8.71927,376.929\nJanuary,2019,New York City,12.2302,381.554\nFebruary,2019,New York City,9.12729,376.059\nMarch,2019,New York City,15.0021,451.812\nApril,2019,New York City,8.18956,430.725\nMay,2019,New York City,5.11994,413.571\nJune,2019,New York City,6.78321,420.21\nJuly,2019,New York City,5.17626,392.603\nAugust,2019,New York City,7.66585,387.88\nSeptember,2019,New York City,6.17136,360.04\nOctober,2019,New York City,6.97901,333.786\nNovember,2019,New York City,8.27662,391.481\nDecember,2019,New York City,12.6224,396.169\nJanuary,2020,New York City,12.0122,413.5\nFebruary,2020,New York City,12.7607,419.653\nMarch,2020,New York City,8.00198,440.894\nApril,2020,New York City,7.37964,457.738\nMay,2020,New York City,4.27964,426.667\nJune,2020,New York City,4.00511,402.702\nJuly,2020,New York City,5.02008,388.22\nAugust,2020,New York City,5.94357,370.006\nSeptember,2020,New York City,4.37543,357.656\nOctober,2020,New York City,9.78407,352.506\nNovember,2020,New York City,9.46003,356.605\nDecember,2020,New York City,18.0666,352.651\nJanuary,2021,New York City,10.4491,426.053\nFebruary,2021,New York City,15.236,397\nMarch,2021,New York City,11.2124,420.429\nApril,2021,New York City,9.3951,479.994\nMay,2021,New York City,5.30841,424.94\nJune,2021,New York City,4.70262,409.903\nJuly,2021,New York City,5.98065,408.473\nAugust,2021,New York City,8.37333,378.903\nSeptember,2021,New York City,4.21921,369.851\n,,,,\n,,,,\n,,,,\n",
          "folderId": "0",
          "active": false,
          "open": true
        },
        "2": {
          "id": "2",
          "name": "test.py",
          "language": "py",
          "contents": "import unittest\nfrom io import StringIO\nimport sys\nimport pandas as pd\nimport ast\n\nclass TestNitrogenDioxideAnalysis(unittest.TestCase):\n\n    def setUp(self):\n        # Setup to capture the print output if needed later\n        self.captured_output = StringIO()\n        sys.stdout = self.captured_output\n\n    def tearDown(self):\n        # Reset redirect and clear print capture\n        sys.stdout = sys.__stdout__\n\n    def test_step_1(self):\n        \"\"\"Load the data and call .head() to confirm it is read successfully.\"\"\"\n        with open('main.py') as f:\n            script_content = f.read()\n\n        # Step 1: Parse the script using AST to check for the .head() call\n        tree = ast.parse(script_content)\n\n        # Track if a DataFrame and .head() call are detected\n        df_loaded = False\n        head_called = False\n\n        # Traverse the AST to find DataFrame creation and .head() call\n        for node in ast.walk(tree):\n            # Check for DataFrame creation by reading a CSV file\n            if isinstance(node, ast.Call) and isinstance(node.func, ast.Attribute):\n                if node.func.attr == 'read_csv':\n                    df_loaded = True\n\n            # Check for .head() method calls on a DataFrame\n            if isinstance(node, ast.Call) and isinstance(node.func, ast.Attribute):\n                if node.func.attr == 'head':\n                    head_called = True\n\n        # Validate that a DataFrame is created and .head() is called\n        self.assertTrue(df_loaded, \"The data should be loaded into a DataFrame.\")\n        self.assertTrue(head_called, \"The .head() method should be called to confirm the data is read successfully.\")\n\n    def test_step_2(self):\n        \"\"\"Replace the value of the empty element with 'November'.\"\"\"\n        with open('main.py') as f:\n            script_content = f.read()\n\n        # Execute the script once and capture the variables\n        local_vars = {}\n        exec(script_content, local_vars)\n\n        # Check if a DataFrame is present\n        df = None\n        for var_name, var_value in local_vars.items():\n            if isinstance(var_value, pd.DataFrame):\n                df = var_value\n                break\n\n        # Ensure a DataFrame exists\n        self.assertIsNotNone(df, \"A DataFrame should be created and loaded with data.\")\n\n        # Step 1: Capture the initial value at location (1, 0)\n        original_value = df.iloc[1, 0]  # Capture the original value\n        print(f\"Original Value at (1, 0): {original_value}\")\n\n        # Validate that 'November' was set correctly at this location\n        modified_value = df.iloc[1, 0]  # This should reflect the new value after replacement\n\n        # Check if the value at (1, 0) was replaced correctly with 'November'\n        self.assertEqual(modified_value, \"November\", \"The value at location (1, 0) should be replaced with 'November'.\")\n\n    def test_step_3(self):\n        \"\"\"Create a new DataFrame that contains rows where 'Nitrogen Dioxide' > 25 and print this subgroup.\"\"\"\n        with open('main.py') as f:\n            script_content = f.read()\n\n        # Execute the student code and capture the variables\n        local_vars = {}\n        exec(script_content, local_vars)\n\n        # Locate all DataFrames in the student script\n        high_nitrogen_df = None\n        original_df = None\n\n        # Identify the original DataFrame and the filtered high nitrogen DataFrame\n        for var_name, var_value in local_vars.items():\n            if isinstance(var_value, pd.DataFrame):\n                if 'Nitrogen Dioxide' in var_value.columns:\n                    if (var_value['Nitrogen Dioxide'] > 25).any():\n                        high_nitrogen_df = var_value\n                    else:\n                        original_df = var_value\n\n        # Ensure that a filtered DataFrame was created\n        self.assertIsNotNone(high_nitrogen_df, \"Create a new DataFrame that contains rows where 'Nitrogen Dioxide' > 25 and print this subgroup.\")\n\n        # Ensure that the filtered DataFrame only contains rows with 'Nitrogen Dioxide' > 25\n        self.assertTrue((high_nitrogen_df['Nitrogen Dioxide'] > 25).all(), \"All rows in the new DataFrame should have 'Nitrogen Dioxide' values greater than 25.\")\n\n    def test_step_4(self):\n        \"\"\"Group data by the ‘Year’ attribute and determine the average Nitrogen Dioxide value for each year. Print these values.\"\"\"\n        with open('main.py') as f:\n            script_content = f.read()\n\n        # Parse the script using AST for structural analysis\n        tree = ast.parse(script_content)\n\n        # Flags for detecting groupby and mean operations\n        groupby_detected = False\n        mean_detected = False\n\n        # Traverse the AST to identify `groupby` and `mean` operations\n        for node in ast.walk(tree):\n            if isinstance(node, ast.Call) and isinstance(node.func, ast.Attribute):\n                # Check for groupby('Year')\n                if node.func.attr == 'groupby':\n                    # Ensure it is grouping by 'Year'\n                    if len(node.args) > 0 and isinstance(node.args[0], ast.Str) and node.args[0].s == 'Year':\n                        groupby_detected = True\n\n                # Check for .mean() applied on Nitrogen Dioxide\n                if node.func.attr == 'mean':\n                    mean_detected = True\n\n        # Validate that both `groupby` and `mean` operations are detected in the correct order\n        self.assertTrue(groupby_detected, \"Group data by the ‘Year’ attribute.\")\n        self.assertTrue(mean_detected, \"Determine the average Nitrogen Dioxide value for each year and print these values.\")\n\nif __name__ == \"__main__\":\n    unittest.main()\n",
          "folderId": "0",
          "active": false,
          "open": true,
          "type": "validation"
        }
      },
      "folders": {
      },
      "openFiles": [
        "0",
        "1",
        "2"
      ]
    },
    "display_name": "NYC Air Pollution",
    "teacher_markdown": "When modifying data with iloc, students might accidentally reference the wrong position– remind students that rows and column indices begin at 0.\r\n\r\nWhen filtering data, it’s helpful to print out parts of the DataFrame before and after filtering to understand the changes.",
    "bubble_choice_description": "Practice accessing and grouping data to determine the average air pollution each year in New York City.",
    "thumbnail_url": "https://images.code.org/755d32e4d329e0ec9f20ce47c5ef4c64-statue.png"
  },
  "audit_log": "[{\"changed_at\":\"2024-09-16T17:14:33.826+00:00\",\"changed\":[\"cloned from \\\"datascience-U2L6-L8b_2024-pilot\\\"\"],\"cloned_from\":\"datascience-U2L6-L8b_2024-pilot\"},{\"changed_at\":\"2024-09-16 17:16:20 +0000\",\"changed\":[\"long_instructions\",\"predict_settings\",\"display_name\",\"bubble_choice_description\",\"thumbnail_url\"],\"changed_by_id\":18602,\"changed_by_email\":\"angelina+levelbuilder@code.org\"},{\"changed_at\":\"2024-09-16 17:17:08 +0000\",\"changed\":[\"start_sources\"],\"changed_by_id\":18602,\"changed_by_email\":\"angelina+levelbuilder@code.org\"},{\"changed_at\":\"2024-09-29 19:17:32 +0000\",\"changed\":[\"start_sources\"],\"changed_by_id\":18602,\"changed_by_email\":\"angelina+levelbuilder@code.org\"},{\"changed_at\":\"2024-09-29 19:17:53 +0000\",\"changed\":[\"long_instructions\",\"predict_settings\"],\"changed_by_id\":18602,\"changed_by_email\":\"angelina+levelbuilder@code.org\"},{\"changed_at\":\"2024-09-29 19:24:58 +0000\",\"changed\":[\"start_sources\"],\"changed_by_id\":18602,\"changed_by_email\":\"angelina+levelbuilder@code.org\"},{\"changed_at\":\"2024-09-29 19:25:03 +0000\",\"changed\":[\"predict_settings\"],\"changed_by_id\":18602,\"changed_by_email\":\"angelina+levelbuilder@code.org\"}]"
}]]></config>
</Pythonlab>
