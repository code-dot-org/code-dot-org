- homepage_data = {courses: @recent_courses}
- homepage_data[:showuitips] = show_ui_tips
- homepage_data[:initialtipsdismissed] = current_user.ui_tip_dismissed_homepage_header
- homepage_data[:userid] = current_user.id
- homepage_data[:valid_grades] = Section.valid_grades
- homepage_data[:topCourse] = @top_course

- if current_user
  - provider = current_user.provider
  - provider = 'google_classroom' if provider == 'google_oauth2'
  - homepage_data[:provider] = provider
  - if current_user.teacher?
    - homepage_data[:isTeacher] = true
  - else
    - homepage_data[:sections] = @student_sections
    - homepage_data[:isTeacher] = false
    - if current_user.teacher_managed_account?
      - homepage_data[:canLeave] = false
    -else
      - homepage_data[:canLeave] = true

- content_for(:head) do
  %script{src: minifiable_asset_path('js/home/_homepage.js'), data: {homepage: homepage_data.to_json}}

-# Components generated by HAML which might be pulled in and displayed by the React model.
.hiddenComponents{style: "display: none"}
  #flashes
    = show_flashes.html_safe

.clear{style: "clear: both"}

- if current_user
  - if current_user.teacher?
    #terms_reminder
      - unless current_user.accepted_latest_terms?
        = render template: 'api/accept_terms_reminder'
        = render partial: 'layouts/terms_interstitial'

#homepage-container

#workshop-links
  -if can? :read, Pd::Workshop
    %h1
      Workshop Dashboard
    %a{href:'/pd/workshop_dashboard'}
      %h3
        Manage PD Workshops
  -if current_user.permission?(UserPermission::CREATE_PROFESSIONAL_DEVELOPMENT_WORKSHOP) || current_user.permission?(UserPermission::WORKSHOP_ADMIN)
    %h1
      Old CSF Workshop Dashboard
    %a{href: CDO.code_org_url('/manage-professional-development-workshops')}
      %h3
        Manage Workshops
    %a{href: CDO.code_org_url('/professional-development-workshops')}
      %h3
        View Workshop Map
    %a{href:'https://docs.google.com/a/code.org/document/d/1lHBthPKdKx3G-khyWYhVYQlfdi9Sa1L9EcOxEa-Xt14/edit'}
      %h3
        View Affiliate Playbook
