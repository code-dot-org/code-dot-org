- homepage_data = {courses: @recent_courses}
- if current_user.teacher?
  - homepage_data[:sections] = @sections
- homepage_data[:codeorgurlprefix] = CDO.code_org_url

- content_for(:head) do
  %script{src: minifiable_asset_path('js/home/_homepage.js'), data: {homepage: homepage_data.to_json}}

-# Components generated by HAML which might be pulled in and displayed by the React model.
.hiddenComponents{style: "display: none"}
  -if current_user && !current_user.teacher?
    #user_hero
      = render template: 'api/user_hero'

.clear{style: "clear: both"}

- if current_user
  - if current_user.teacher?
    #terms_reminder
      - unless current_user.accepted_latest_terms?
        = render template: 'api/accept_terms_reminder'

#terms-modal.modal{'data-backdrop' => 'static', 'data-keyboard' => 'false', style: 'display: none;'}
  .modal-dialog
    .modal-content.no-modal-icon
      %h2.custom-h2= t('terms_interstitial.title')

      .right
        %iframe#print-frame{src: '/terms-and-privacy', style: 'display: none'}
        %a#print-terms{href: "#"}
          %i.fa.fa-print.right-margin-5
          = t('terms_interstitial.print')
      .clear
      .scroll-box
        = t('terms_interstitial.intro_desc').html_safe
        %br
        %br
        = t('terms_interstitial.intro_instructions')
        %h1.custom-h1= t('terms_interstitial.tos')
        = render partial: 'home/tos'
        %hr
        %h1= t('terms_interstitial.privacy')
        = render partial: 'home/privacy'
        %hr
        %h1= t('terms_interstitial.privacy_notice')
        = render partial: 'home/privacy_notice'

      %br
      .left
        = form_for(current_user, url: registration_url('user'), html: {id: 'edit_user'}) do |f|
          .form-group
            = f.label :terms_of_service_version do
              = f.check_box :terms_of_service_version, {class: 'terms-checkbox'}, current_user.latest_terms_version
              = t('terms_interstitial.accept_label', tos_url: CDO.code_org_url('/tos'), privacy_url: CDO.code_org_url('/privacy')).html_safe
          .form-group
            = f.submit t('terms_interstitial.accept'), id: 'accept-terms-submit', class: 'btn primary-button disabled-button', disabled: true
          = tag(:input, :type => "hidden", :name => request_forgery_protection_token.to_s, :value => form_authenticity_token)
      .clear

%script{src: minifiable_asset_path('js/layouts/_terms_interstitial.js')}

#homepage-container

#admin-extras
  -if current_user.admin?
    %a{href: CDO.code_org_url('/ops-dashboard#/districts'), style: 'text-decoration: none;'}
      %h2
        Manage Districts
  -if current_user.admin? || has_permission?('facilitator')
    %a{href: CDO.code_org_url('/ops-dashboard#/workshops'), style: 'text-decoration: none;'}
      %h2
        Manage PD Workshops
  -elsif has_permission?('district_contact')
    %a{href: CDO.code_org_url('/ops-dashboard#/workshops'), style: 'text-decoration: none;'}
      %h2
        View PD Workshops
  -if current_user.admin? || has_permission?('district_contact')
    %a{href: CDO.code_org_url('/ops-dashboard#/teacher-cohorts'), style: 'text-decoration: none;'}
      %h2
        Manage Teacher Cohorts
