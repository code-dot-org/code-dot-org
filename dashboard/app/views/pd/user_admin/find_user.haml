- content_for(:head) do
  = stylesheet_link_tag 'css/pd', media: 'all'

%h1 Manager User Permissions

#application-container.selectable

  = show_flashes.html_safe

%p Enter an Email or User ID to view and edit a User's permissions
= form_tag url_for(action: 'find_user'), method: 'get', class: 'form-inline', enforce_utf8: false do
  = text_field_tag :search_term, params[:search_term], class: 'form-control'
  %button.btn{type: 'submit'}
    %i.fa.fa-search
  -if @user
    %table.table.table-hover.table-condensed.table-auto-width
      %thead
        %th ID
        %th Email
        %th Name
      %tbody
        %tr
          %td= link_to @user.id, action: :find_user, user_id: @user.id
          %td= @user.email
          %td= @user.name
  -else
    %p No User Found
  -if @permissions
    = form_tag(action: 'assign_permission') do
      %table.table.table-hover.table-condensed.table-auto-width
        %thead
          %th Action
          %th Permission
          %th Granted At
        %tbody
          - @permissions.each do |permission|
            %tr
              %td Revoke
              %td= permission.permission
              %td= permission.created_at
            %tr
              %td
                .actions
                  = submit_tag('Assign Permission', id: 'submitAssignPermission')
              %td
                %input{:hidden => true, :name => "user_id", :value => @user.id}
                .field
                  = select_tag :pd_user_permission_id, options_for_select(UserPermission::VALID_PERMISSIONS)
              %td