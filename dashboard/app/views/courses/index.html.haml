:ruby
  lines_count = fetch_metrics['lines_of_code']
  lines_count = number_with_delimiter(lines_count, :delimiter => ',')
  students_count = fetch_user_metrics['number_students']
  students_count /= 1000000
  students_count = students_count.to_s

  courses_data = {}
  courses_data[:courses] = @recent_courses
  courses_data[:english] = @is_english
  courses_data[:teacher] = @is_teacher
  courses_data[:linescount] = lines_count
  courses_data[:studentscount] = students_count
  courses_data[:codeorgurlprefix] = CDO.code_org_url
  courses_data[:signedout] = @is_signed_out
  courses_data[:initialtipsdismissed] = current_user ? current_user.ui_tip_dismissed_teacher_courses : nil
  courses_data[:userid] = current_user.try(:id)

%link{:href=>'/shared/css/course-explorer.css', :rel=>'stylesheet'}

- if (current_user && current_user.show_race_interstitial?) || @force_race_interstitial
  = render partial: 'layouts/race_interstitial'

%script{src: minifiable_asset_path('js/courses/index.js'), data: {courses: courses_data.to_json}}

-# Components generated by HAML which might be pulled in and displayed by the React model.
.hiddenComponents{style: "display: none"}
  = render file: Rails.root.join('..', 'shared', 'haml', 'course_explorer_table.haml')
  = render file: Rails.root.join('..', 'shared', 'haml', 'tool_explorer_table.haml')
  = render partial: 'home/all_courses'
  -if current_user && !current_user.teacher?
    #user_hero
      = render template: 'api/user_hero'

  .standalone-tools
    %br/
    .row
      = render partial: 'shared/course_wide_block', locals: { id: "applab" }
      = render partial: 'shared/course_wide_block', locals: { id: "widgets" }
    %br/
    .row
      = render partial: 'shared/course_wide_block', locals: { id: "gamelab" }
    %br/

#courses-container
