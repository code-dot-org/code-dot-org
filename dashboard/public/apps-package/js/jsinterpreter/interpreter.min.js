"use strict";var Interpreter=function(a,b){this.initFunc_=b,this.UNDEFINED=this.createPrimitive(void 0),this.ast=acorn.parse(a),this.paused_=!1;var c=this.createScope(this.ast,null);this.stateStack=[{node:this.ast,scope:c,thisExpression:c}]};Interpreter.prototype.step=function(){if(!this.stateStack.length)return!1;if(this.paused_)return!0;var a=this.stateStack[0];return this["step"+a.node.type](),!0},Interpreter.prototype.run=function(){for(;!this.paused_&&this.step(););return this.paused_},Interpreter.prototype.initGlobalScope=function(a){this.setProperty(a,"Infinity",this.createPrimitive(1/0),!0),this.setProperty(a,"NaN",this.createPrimitive(NaN),!0),this.setProperty(a,"undefined",this.UNDEFINED,!0),this.setProperty(a,"window",a,!0),this.setProperty(a,"self",a,!1),this.initFunction(a),this.initObject(a),a.parent=this.OBJECT,this.initArray(a),this.initNumber(a),this.initString(a),this.initBoolean(a),this.initDate(a),this.initMath(a),this.initRegExp(a),this.initJSON(a);var b,c=this;b=function(a){return a=a||c.UNDEFINED,c.createPrimitive(isNaN(a.toNumber()))},this.setProperty(a,"isNaN",this.createNativeFunction(b)),b=function(a){return a=a||c.UNDEFINED,c.createPrimitive(isFinite(a.toNumber()))},this.setProperty(a,"isFinite",this.createNativeFunction(b)),b=function(a){return a=a||c.UNDEFINED,c.createPrimitive(parseFloat(a.toNumber()))},this.setProperty(a,"parseFloat",this.createNativeFunction(b)),b=function(a,b){return a=a||c.UNDEFINED,b=b||c.UNDEFINED,c.createPrimitive(parseInt(a.toString(),b.toNumber()))},this.setProperty(a,"parseInt",this.createNativeFunction(b));var d=this.createObject(this.FUNCTION);d.eval=!0,this.setProperty(d,"length",this.createPrimitive(1),!0),this.setProperty(a,"eval",d);for(var e=["escape","unescape","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent"],f=0;f<e.length;f++)b=function(a){return function(b){return b=b||c.UNDEFINED,c.createPrimitive(a(b.toString()))}}(window[e[f]]),this.setProperty(a,e[f],this.createNativeFunction(b));this.initFunc_&&this.initFunc_(this,a)},Interpreter.prototype.initFunction=function(a){var b,c=this;b=function(a){if(this.parent==c.FUNCTION)var b=this;else var b=c.createObject(c.FUNCTION);if(arguments.length)var d=arguments[arguments.length-1].toString();else var d="";for(var e=[],f=0;f<arguments.length-1;f++)e.push(arguments[f].toString());if(e=e.join(", "),-1!=e.indexOf(")"))throw new SyntaxError("Function arg string contains parenthesis");b.parentScope=c.stateStack[c.stateStack.length-1].scope;var g=acorn.parse("$ = function("+e+") {"+d+"};");return b.node=g.body[0].expression.right,c.setProperty(b,"length",c.createPrimitive(b.node.length),!0),b},this.FUNCTION=this.createObject(null),this.setProperty(a,"Function",this.FUNCTION),this.FUNCTION.type="function",this.setProperty(this.FUNCTION,"prototype",this.createObject(null)),this.FUNCTION.nativeFunc=b;var d={type:"FunctionApply_",params:[],id:null,body:null,start:0,end:0};this.setProperty(this.FUNCTION.properties.prototype,"apply",this.createFunction(d,{}),!1,!0),d={type:"FunctionCall_",params:[],id:null,body:null,start:0,end:0},this.setProperty(this.FUNCTION.properties.prototype,"call",this.createFunction(d,{}),!1,!0),b=function(){return c.createPrimitive(this.toString())},this.setProperty(this.FUNCTION.properties.prototype,"toString",this.createNativeFunction(b),!1,!0),this.setProperty(this.FUNCTION,"toString",this.createNativeFunction(b),!1,!0),b=function(){return c.createPrimitive(this.valueOf())},this.setProperty(this.FUNCTION.properties.prototype,"valueOf",this.createNativeFunction(b),!1,!0),this.setProperty(this.FUNCTION,"valueOf",this.createNativeFunction(b),!1,!0)},Interpreter.prototype.initObject=function(a){var b,c=this;b=function(a){if(this.parent==c.OBJECT)var b=this;else var b=c.createObject(c.OBJECT);return b},this.OBJECT=this.createNativeFunction(b),this.setProperty(a,"Object",this.OBJECT),b=function(){return c.createPrimitive(this.toString())},this.setProperty(this.OBJECT.properties.prototype,"toString",this.createNativeFunction(b),!1,!0),b=function(){return c.createPrimitive(this.valueOf())},this.setProperty(this.OBJECT.properties.prototype,"valueOf",this.createNativeFunction(b),!1,!0),b=function(a){for(var b in this.properties)if(b==a)return c.createPrimitive(!0);return c.createPrimitive(!1)},this.setProperty(this.OBJECT.properties.prototype,"hasOwnProperty",this.createNativeFunction(b),!1,!0),b=function(a){var b=c.createObject(c.ARRAY),d=0;for(var e in a.properties)c.setProperty(b,d,c.createPrimitive(e)),d++;return b},this.setProperty(this.OBJECT,"keys",this.createNativeFunction(b))},Interpreter.prototype.initArray=function(a){var b,c=this,d=function(a,b){var c=a?Math.floor(a.toNumber()):b;return isNaN(c)&&(c=b),c};b=function(a){if(this.parent==c.ARRAY)var b=this;else var b=c.createObject(c.ARRAY);var d=arguments[0];if(d&&"number"==d.type){if(isNaN(c.arrayIndex(d)))throw new RangeError("Invalid array length");b.length=d.data}else{for(var e=0;e<arguments.length;e++)b.properties[e]=arguments[e];b.length=e}return b},this.ARRAY=this.createNativeFunction(b),this.setProperty(a,"Array",this.ARRAY),b=function(){if(this.length){var a=this.properties[this.length-1];delete this.properties[this.length-1],this.length--}else var a=c.UNDEFINED;return a},this.setProperty(this.ARRAY.properties.prototype,"pop",this.createNativeFunction(b),!1,!0),b=function(a){for(var b=0;b<arguments.length;b++)this.properties[this.length]=arguments[b],this.length++;return c.createPrimitive(this.length)},this.setProperty(this.ARRAY.properties.prototype,"push",this.createNativeFunction(b),!1,!0),b=function(){if(this.length){for(var a=this.properties[0],b=1;b<this.length;b++)this.properties[b-1]=this.properties[b];this.length--,delete this.properties[this.length]}else var a=c.UNDEFINED;return a},this.setProperty(this.ARRAY.properties.prototype,"shift",this.createNativeFunction(b),!1,!0),b=function(a){for(var b=this.length-1;b>=0;b--)this.properties[b+arguments.length]=this.properties[b];this.length+=arguments.length;for(var b=0;b<arguments.length;b++)this.properties[b]=arguments[b];return c.createPrimitive(this.length)},this.setProperty(this.ARRAY.properties.prototype,"unshift",this.createNativeFunction(b),!1,!0),b=function(){for(var a=0;a<this.length/2;a++){var b=this.properties[this.length-a-1];this.properties[this.length-a-1]=this.properties[a],this.properties[a]=b}return c.UNDEFINED},this.setProperty(this.ARRAY.properties.prototype,"reverse",this.createNativeFunction(b),!1,!0),b=function(a,b,e){a=d(a,0),a=0>a?Math.max(this.length+a,0):Math.min(a,this.length),b=d(b,1/0),b=Math.min(b,this.length-a);for(var f=c.createObject(c.ARRAY),g=a;a+b>g;g++)f.properties[f.length++]=this.properties[g],this.properties[g]=this.properties[g+b];for(var g=a+b;g<this.length-b;g++)this.properties[g]=this.properties[g+b];for(var g=this.length-b;g<this.length;g++)delete this.properties[g];this.length-=b;for(var g=this.length-1;g>=a;g--)this.properties[g+arguments.length-2]=this.properties[g];this.length+=arguments.length-2;for(var g=2;g<arguments.length;g++)this.properties[a+g-2]=arguments[g];return f},this.setProperty(this.ARRAY.properties.prototype,"splice",this.createNativeFunction(b),!1,!0),b=function(a,b){var e=c.createObject(c.ARRAY),f=d(a,0);0>f&&(f=this.length+f),f=Math.max(0,Math.min(f,this.length));var g=d(b,this.length);0>g&&(g=this.length+g),g=Math.max(0,Math.min(g,this.length));for(var h=0,i=f;g>i;i++){var j=c.getProperty(this,i);c.setProperty(e,h++,j)}return e},this.setProperty(this.ARRAY.properties.prototype,"slice",this.createNativeFunction(b),!1,!0),b=function(a){if(a&&void 0!==a.data)var b=a.toString();else var b=void 0;for(var d=[],e=0;e<this.length;e++)d[e]=this.properties[e];return c.createPrimitive(d.join(b))},this.setProperty(this.ARRAY.properties.prototype,"join",this.createNativeFunction(b),!1,!0),b=function(a){for(var b=c.createObject(c.ARRAY),d=0,e=0;e<this.length;e++){var f=c.getProperty(this,e);c.setProperty(b,d++,f)}for(var e=0;e<arguments.length;e++){var g=arguments[e];if(c.isa(g,c.ARRAY))for(var h=0;h<g.length;h++){var f=c.getProperty(g,h);c.setProperty(b,d++,f)}else c.setProperty(b,d++,g)}return b},this.setProperty(this.ARRAY.properties.prototype,"concat",this.createNativeFunction(b),!1,!0),b=function(a,b){a=a||c.UNDEFINED;var e=d(b,0);0>e&&(e=this.length+e),e=Math.max(0,Math.min(e,this.length));for(var f=e;f<this.length;f++){var g=c.getProperty(this,f);if(0==c.comp(g,a))return c.createPrimitive(f)}return c.createPrimitive(-1)},this.setProperty(this.ARRAY.properties.prototype,"indexOf",this.createNativeFunction(b),!1,!0),b=function(a,b){a=a||c.UNDEFINED;var e=d(b,this.length);0>e&&(e=this.length+e),e=Math.max(0,Math.min(e,this.length));for(var f=e;f>=0;f--){var g=c.getProperty(this,f);if(0==c.comp(g,a))return c.createPrimitive(f)}return c.createPrimitive(-1)},this.setProperty(this.ARRAY.properties.prototype,"lastIndexOf",this.createNativeFunction(b),!1,!0),b=function(a){for(var b=[],d=0;d<this.length;d++)b[d]=this.properties[d];b.sort();for(var d=0;d<b.length;d++)c.setProperty(this,d,b[d]);return this},this.setProperty(this.ARRAY.properties.prototype,"sort",this.createNativeFunction(b),!1,!0)},Interpreter.prototype.initNumber=function(a){var b,c=this;b=function(a){return a=a?a.toNumber():0,this.parent==c.NUMBER?(this.toBoolean=function(){return!!a},this.toNumber=function(){return a},this.toString=function(){return String(a)},c.UNDEFINED):c.createPrimitive(a)},this.NUMBER=this.createNativeFunction(b),this.setProperty(a,"Number",this.NUMBER);for(var d=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],e=0;e<d.length;e++)this.setProperty(this.NUMBER,d[e],this.createPrimitive(Number[d[e]]));b=function(a){a=a?a.toNumber():void 0;var b=this.toNumber();return c.createPrimitive(b.toExponential(a))},this.setProperty(this.NUMBER.properties.prototype,"toExponential",this.createNativeFunction(b),!1,!0),b=function(a){a=a?a.toNumber():void 0;var b=this.toNumber();return c.createPrimitive(b.toFixed(a))},this.setProperty(this.NUMBER.properties.prototype,"toFixed",this.createNativeFunction(b),!1,!0),b=function(a){a=a?a.toNumber():void 0;var b=this.toNumber();return c.createPrimitive(b.toPrecision(a))},this.setProperty(this.NUMBER.properties.prototype,"toPrecision",this.createNativeFunction(b),!1,!0),b=function(a){a=a?a.toNumber():10;var b=this.toNumber();return c.createPrimitive(b.toString(a))},this.setProperty(this.NUMBER.properties.prototype,"toString",this.createNativeFunction(b),!1,!0)},Interpreter.prototype.initString=function(a){var b,c=this;b=function(a){return a=(a||c.UNDEFINED).toString(),this.parent==c.STRING?(this.toBoolean=function(){return!!a},this.toNumber=function(){return Number(a)},this.toString=function(){return a},this.valueOf=function(){return a},this.data=a,c.UNDEFINED):c.createPrimitive(a)},this.STRING=this.createNativeFunction(b),this.setProperty(a,"String",this.STRING);for(var d=["toLowerCase","toUpperCase","toLocaleLowerCase","toLocaleUpperCase"],e=0;e<d.length;e++)b=function(a){return function(){return c.createPrimitive(a.apply(this))}}(String.prototype[d[e]]),this.setProperty(this.STRING.properties.prototype,d[e],this.createNativeFunction(b),!1,!0);b=function(){var a=this.toString();return c.createPrimitive(a.replace(/^\s+|\s+$/g,""))},this.setProperty(this.STRING.properties.prototype,"trim",this.createNativeFunction(b),!1,!0),b=function(){var a=this.toString();return c.createPrimitive(a.replace(/^\s+/g,""))},this.setProperty(this.STRING.properties.prototype,"trimLeft",this.createNativeFunction(b),!1,!0),b=function(){var a=this.toString();return c.createPrimitive(a.replace(/\s+$/g,""))},this.setProperty(this.STRING.properties.prototype,"trimRight",this.createNativeFunction(b),!1,!0),b=function(a){var b=this.toString();return a=(a||c.UNDEFINED).toNumber(),c.createPrimitive(b.charAt(a))},this.setProperty(this.STRING.properties.prototype,"charAt",this.createNativeFunction(b),!1,!0),b=function(a){var b=this.toString();return a=(a||c.UNDEFINED).toNumber(),c.createPrimitive(b.charCodeAt(a))},this.setProperty(this.STRING.properties.prototype,"charCodeAt",this.createNativeFunction(b),!1,!0),b=function(a,b){var d=this.toString();return a=(a||c.UNDEFINED).toString(),b=b?b.toNumber():void 0,c.createPrimitive(d.indexOf(a,b))},this.setProperty(this.STRING.properties.prototype,"indexOf",this.createNativeFunction(b),!1,!0),b=function(a,b){var d=this.toString();return a=(a||c.UNDEFINED).toString(),b=b?b.toNumber():void 0,c.createPrimitive(d.lastIndexOf(a,b))},this.setProperty(this.STRING.properties.prototype,"lastIndexOf",this.createNativeFunction(b),!1,!0),b=function(a){var b=this.toString();return a=(a||c.UNDEFINED).toString(),c.createPrimitive(b.localeCompare(a))},this.setProperty(this.STRING.properties.prototype,"localeCompare",this.createNativeFunction(b),!1,!0),b=function(a,b){var d=this.toString();a=a?c.isa(a,c.REGEXP)?a.data:a.toString():void 0,b=b?b.toNumber():void 0;for(var e=d.split(a,b),f=c.createObject(c.ARRAY),g=0;g<e.length;g++)c.setProperty(f,g,c.createPrimitive(e[g]));return f},this.setProperty(this.STRING.properties.prototype,"split",this.createNativeFunction(b),!1,!0),b=function(a,b){var d=this.toString();return a=a?a.toNumber():void 0,b=b?b.toNumber():void 0,c.createPrimitive(d.substring(a,b))},this.setProperty(this.STRING.properties.prototype,"substring",this.createNativeFunction(b),!1,!0),b=function(a,b){var d=this.toString();return a=a?a.toNumber():void 0,b=b?b.toNumber():void 0,c.createPrimitive(d.substr(a,b))},this.setProperty(this.STRING.properties.prototype,"substr",this.createNativeFunction(b),!1,!0),b=function(a){for(var b=this.toString(),d=0;d<arguments.length;d++)b+=arguments[d].toString();return c.createPrimitive(b)},this.setProperty(this.STRING.properties.prototype,"concat",this.createNativeFunction(b),!1,!0),b=function(a,b){var d=this.toString();return a=a?a.toNumber():void 0,b=b?b.toNumber():void 0,c.createPrimitive(d.slice(a,b))},this.setProperty(this.STRING.properties.prototype,"slice",this.createNativeFunction(b),!1,!0),b=function(a){var b=this.toString();a=a?a.data:void 0;var d=b.match(a);if(null===d)return c.createPrimitive(null);for(var e=c.createObject(c.ARRAY),f=0;f<d.length;f++)c.setProperty(e,f,c.createPrimitive(d[f]));return e},this.setProperty(this.STRING.properties.prototype,"match",this.createNativeFunction(b),!1,!0),b=function(a){var b=this.toString();return a=a?a.data:void 0,c.createPrimitive(b.search(a))},this.setProperty(this.STRING.properties.prototype,"search",this.createNativeFunction(b),!1,!0)},Interpreter.prototype.initBoolean=function(a){var b,c=this;b=function(a){return a=a?a.toBoolean():!1,this.parent==c.STRING?(this.toBoolean=function(){return a},this.toNumber=function(){return Number(a)},this.toString=function(){return String(a)},this.valueOf=function(){return a},c.UNDEFINED):c.createPrimitive(a)},this.BOOLEAN=this.createNativeFunction(b),this.setProperty(a,"Boolean",this.BOOLEAN)},Interpreter.prototype.initDate=function(a){var b,c=this;b=function(a,b,d,e,f,g,h){if(this.parent==c.DATE)var i=this;else var i=c.createObject(c.DATE);var j=a;if(arguments.length)if(1!=arguments.length||"string"!=j.type&&!c.isa(j,c.STRING)){for(var k=[],l=0;l<arguments.length;l++)k[l]=arguments[l]?arguments[l].toNumber():void 0;i.date=new(Function.prototype.bind.apply(Date,k))}else i.date=new Date(j.toString());else i.date=new Date;return i.toString=function(){return String(this.date)},i.toNumber=function(){return Number(this.date)},i.valueOf=function(){return this.date.valueOf()},i},this.DATE=this.createNativeFunction(b),this.setProperty(a,"Date",this.DATE),b=function(){return c.createPrimitive((new Date).getTime())},this.setProperty(this.DATE,"now",this.createNativeFunction(b),!1,!0),b=function(a){return a=a?a.toString():void 0,c.createPrimitive(Date.parse(a))},this.setProperty(this.DATE,"parse",this.createNativeFunction(b),!1,!0),b=function(a,b,d,e,f,g,h){for(var i=[],j=0;j<arguments.length;j++)i[j]=arguments[j]?arguments[j].toNumber():void 0;return c.createPrimitive(Date.UTC.apply(Date,i))},this.setProperty(this.DATE,"UTC",this.createNativeFunction(b),!1,!0);for(var d=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear"],e=0;e<d.length;e++)b=function(a){return function(){return c.createPrimitive(this.date[a]())}}(d[e]),this.setProperty(this.DATE.properties.prototype,d[e],this.createNativeFunction(b),!1,!0);for(var f=["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"],e=0;e<f.length;e++)b=function(a){return function(b){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e]?arguments[e].toNumber():void 0;return c.createPrimitive(this.date[a].apply(this.date,d))}}(f[e]),this.setProperty(this.DATE.properties.prototype,f[e],this.createNativeFunction(b),!1,!0);d=["toDateString","toISOString","toGMTString","toLocaleDateString","toLocaleString","toLocaleTimeString","toTimeString","toUTCString"];for(var e=0;e<d.length;e++)b=function(a){return function(){return c.createPrimitive(this.date[a]())}}(d[e]),this.setProperty(this.DATE.properties.prototype,d[e],this.createNativeFunction(b),!1,!0)},Interpreter.prototype.initMath=function(a){var b=this,c=this.createObject(this.OBJECT);this.setProperty(a,"Math",c);for(var d=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],e=0;e<d.length;e++)this.setProperty(c,d[e],this.createPrimitive(Math[d[e]]));for(var f=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"],e=0;e<f.length;e++){var g=function(a){return function(){for(var c=0;c<arguments.length;c++)arguments[c]=arguments[c].toNumber();return b.createPrimitive(a.apply(Math,arguments))}}(Math[f[e]]);this.setProperty(c,f[e],this.createNativeFunction(g))}},Interpreter.prototype.initRegExp=function(a){var b,c=this;b=function(a,b){var d;return d=this.parent==c.REGEXP?this:c.createObject(c.REGEXP),a=a.toString(),b=b&&b.toString(),c.createRegExp(d,new RegExp(a,b||"")),d},this.REGEXP=this.createNativeFunction(b),this.setProperty(a,"RegExp",this.REGEXP),b=function(){return c.createPrimitive(this.data.toString())},this.setProperty(this.REGEXP.properties.prototype,"toString",this.createNativeFunction(b),!1,!0),b=function(a){return a=a.toString(),c.createPrimitive(this.data.test(a))},this.setProperty(this.REGEXP.properties.prototype,"test",this.createNativeFunction(b),!1,!0),b=function(a){a=a.toString(),this.data.lastIndex=c.getProperty(this,"lastIndex").toNumber();var b=this.data.exec(a);if(c.setProperty(this,"lastIndex",c.createPrimitive(this.data.lastIndex)),b){for(var d=c.createObject(c.ARRAY),e=0;e<b.length;e++)c.setProperty(d,e,c.createPrimitive(b[e]));return c.setProperty(d,"index",c.createPrimitive(b.index)),c.setProperty(d,"input",c.createPrimitive(b.input)),d}return c.createPrimitive(null)},this.setProperty(this.REGEXP.properties.prototype,"exec",this.createNativeFunction(b),!1,!0)},Interpreter.prototype.initJSON=function(a){function b(a){if("object"!=typeof a)return d.createPrimitive(a);var c;if(a instanceof Array){c=d.createObject(d.ARRAY);for(var e=0;e<a.length;e++)d.setProperty(c,e,b(a[e]))}else{c=d.createObject(d.OBJECT);for(var f in a)d.setProperty(c,f,b(a[f]))}return c}function c(a){if(a.isPrimitive)return a.data;var b;if(a.length){b=[];for(var d=0;d<a.length;d++)b[d]=c(a.properties[d])}else{b={};for(var e in a.properties)b[e]=c(a.properties[e])}return b}var d=this,e=d.createObject(this.OBJECT);this.setProperty(a,"JSON",e);var f=function(a){return function(){var c=arguments[0].data,d=a.call(JSON,c);return b(d)}}(JSON.parse);this.setProperty(e,"parse",this.createNativeFunction(f)),f=function(a){return function(){var b=c(arguments[0]);return d.createPrimitive(a.call(JSON,b))}}(JSON.stringify),this.setProperty(e,"stringify",this.createNativeFunction(f))},Interpreter.prototype.isa=function(a,b){return a&&b?a.parent==b?!0:a.parent&&a.parent.prototype?this.isa(a.parent.prototype,b):!1:!1},Interpreter.prototype.comp=function(a,b){return a.isPrimitive&&"number"==typeof a&&isNaN(a.data)||b.isPrimitive&&"number"==typeof b&&isNaN(b.data)?NaN:a.isPrimitive&&b.isPrimitive?(a=a.data,b=b.data,b>a?-1:a>b?1:0):NaN},Interpreter.prototype.arrayIndex=function(a){return a=Number(a),!isFinite(a)||a!=Math.floor(a)||0>a?NaN:a},Interpreter.prototype.createPrimitive=function(a){if(void 0===a&&this.UNDEFINED)return this.UNDEFINED;if(a instanceof RegExp)return this.createRegExp(this.createObject(this.REGEXP),a);var b=typeof a,c={data:a,isPrimitive:!0,type:b,toBoolean:function(){return Boolean(this.data)},toNumber:function(){return Number(this.data)},toString:function(){return String(this.data)},valueOf:function(){return this.data}};return"number"==b?c.parent=this.NUMBER:"string"==b?c.parent=this.STRING:"boolean"==b&&(c.parent=this.BOOLEAN),c},Interpreter.prototype.createObject=function(a){var b={isPrimitive:!1,type:"object",parent:a,fixed:Object.create(null),nonenumerable:Object.create(null),properties:Object.create(null),toBoolean:function(){return!0},toNumber:function(){return NaN},toString:function(){return"["+this.type+"]"},valueOf:function(){return this}};return this.isa(b,this.FUNCTION)&&(b.type="function",this.setProperty(b,"prototype",this.createObject(this.OBJECT||null))),this.isa(b,this.ARRAY)&&(b.length=0,b.toNumber=function(){return 0},b.toString=function(){for(var a=[],b=0;b<this.length;b++)a[b]=this.properties[b].toString();return a.join(",")}),b},Interpreter.prototype.createRegExp=function(a,b){return a.data=b,this.setProperty(a,"lastIndex",this.createPrimitive(a.data.lastIndex),!1,!0),this.setProperty(a,"source",this.createPrimitive(a.data.source),!0,!0),this.setProperty(a,"global",this.createPrimitive(a.data.global),!0,!0),this.setProperty(a,"ignoreCase",this.createPrimitive(a.data.ignoreCase),!0,!0),this.setProperty(a,"multiline",this.createPrimitive(a.data.multiline),!0,!0),a},Interpreter.prototype.createFunction=function(a,b){var c=this.createObject(this.FUNCTION);return c.parentScope=b||this.getScope(),c.node=a,this.setProperty(c,"length",this.createPrimitive(c.node.params.length),!0),c},Interpreter.prototype.createNativeFunction=function(a){var b=this.createObject(this.FUNCTION);return b.nativeFunc=a,this.setProperty(b,"length",this.createPrimitive(a.length),!0),b},Interpreter.prototype.createAsyncFunction=function(a){var b=this.createObject(this.FUNCTION);return b.asyncFunc=a,this.setProperty(b,"length",this.createPrimitive(a.length),!0),b},Interpreter.prototype.getProperty=function(a,b){if(b=b.toString(),this.isa(a,this.STRING)){if("length"==b)return this.createPrimitive(a.data.length);var c=this.arrayIndex(b);if(!isNaN(c)&&c<a.data.length)return this.createPrimitive(a.data[c])}else if(this.isa(a,this.ARRAY)&&"length"==b)return this.createPrimitive(a.length);for(;;){if(a.properties&&b in a.properties)return a.properties[b];if(!(a.parent&&a.parent.properties&&a.parent.properties.prototype))break;a=a.parent.properties.prototype}return this.UNDEFINED},Interpreter.prototype.hasProperty=function(a,b){if(b=b.toString(),a.isPrimitive)throw new TypeError("Primitive data type has no properties");if("length"==b&&(this.isa(a,this.STRING)||this.isa(a,this.ARRAY)))return!0;if(this.isa(a,this.STRING)){var c=this.arrayIndex(b);if(!isNaN(c)&&c<a.data.length)return!0}for(;;){if(a.properties&&b in a.properties)return!0;if(!(a.parent&&a.parent.properties&&a.parent.properties.prototype))break;a=a.parent.properties.prototype}return!1},Interpreter.prototype.setProperty=function(a,b,c,d,e){if(b=b.toString(),!a.isPrimitive&&!a.fixed[b]){if(this.isa(a,this.STRING)){var f=this.arrayIndex(b);if("length"==b||!isNaN(f)&&f<a.data.length)return}if(this.isa(a,this.ARRAY)){var g;if("length"==b){var h=this.arrayIndex(c.toNumber());if(isNaN(h))throw new RangeError("Invalid array length");if(h<a.length)for(g in a.properties)g=this.arrayIndex(g),!isNaN(g)&&g>=h&&delete a.properties[g];return void(a.length=h)}isNaN(g=this.arrayIndex(b))||(a.length=Math.max(a.length,g+1))}a.properties[b]=c,d&&(a.fixed[b]=!0),e&&(a.nonenumerable[b]=!0)}},Interpreter.prototype.deleteProperty=function(a,b){return b=b.toString(),a.isPrimitive||a.fixed[b]?!1:"length"==b&&this.isa(a,this.ARRAY)?!1:delete a.properties[b]},Interpreter.prototype.getScope=function(){for(var a=0;a<this.stateStack.length;a++)if(this.stateStack[a].scope)return this.stateStack[a].scope;throw"No scope found."},Interpreter.prototype.createScope=function(a,b){var c=this.createObject(null);if(c.parentScope=b,b||this.initGlobalScope(c),this.populateScope_(a,c),c.strict=!1,b&&b.strict)c.strict=!0;else{var d=a.body&&a.body[0];d&&d.expression&&"Literal"==d.expression.type&&"use strict"==d.expression.value&&(c.strict=!0)}return c},Interpreter.prototype.getValueFromScope=function(a){for(var b=this.getScope(),c=a.toString();b;){if(this.hasProperty(b,c))return this.getProperty(b,c);b=b.parentScope}this.throwException("Unknown identifier: "+c)},Interpreter.prototype.setValueToScope=function(a,b){for(var c=this.getScope(),d=c.strict,e=a.toString();c;){if(this.hasProperty(c,e)||!d&&!c.parentScope)return this.setProperty(c,e,b);c=c.parentScope}this.throwException("Unknown identifier: "+e)},Interpreter.prototype.populateScope_=function(a,b){function c(a){a.constructor==e.ast.constructor&&e.populateScope_(a,b)}if("VariableDeclaration"==a.type)for(var d=0;d<a.declarations.length;d++)this.setProperty(b,a.declarations[d].id.name,this.UNDEFINED);else{if("FunctionDeclaration"==a.type)return void this.setProperty(b,a.id.name,this.createFunction(a,b));if("FunctionExpression"==a.type)return}var e=this;for(var f in a){var g=a[f];if(g&&"object"==typeof g)if("number"==typeof g.length&&g.splice)for(var d=0;d<g.length;d++)c(g[d]);else c(g)}},Interpreter.prototype.getValue=function(a){if(a.length){var b=a[0],c=a[1];return this.getProperty(b,c)}return this.getValueFromScope(a)},Interpreter.prototype.setValue=function(a,b){if(a.length){var c=a[0],d=a[1];this.setProperty(c,d,b)}else this.setValueToScope(a,b)},Interpreter.prototype.stepArrayExpression=function(){var a=this.stateStack[0],b=a.node,c=a.n||0;a.array?this.setProperty(a.array,c-1,a.value):a.array=this.createObject(this.ARRAY),b.elements[c]?(a.n=c+1,this.stateStack.unshift({node:b.elements[c]})):(a.array.length=a.n||0,this.stateStack.shift(),this.stateStack[0].value=a.array)},Interpreter.prototype.stepAssignmentExpression=function(){var a=this.stateStack[0],b=a.node;if(a.doneLeft)if(a.doneRight){this.stateStack.shift();var c,d=a.leftSide,e=a.value;if("="==b.operator)c=e;else{var f=this.getValue(d),g=e,h=f.toNumber(),i=g.toNumber();if("+="==b.operator){var j,k;"string"==f.type||"string"==g.type?(j=f.toString(),k=g.toString()):(j=h,k=i),c=j+k}else if("-="==b.operator)c=h-i;else if("*="==b.operator)c=h*i;else if("/="==b.operator)c=h/i;else if("%="==b.operator)c=h%i;else if("<<="==b.operator)c=h<<i;else if(">>="==b.operator)c=h>>i;else if(">>>="==b.operator)c=h>>>i;else if("&="==b.operator)c=h&i;else if("^="==b.operator)c=h^i;else{if("|="!=b.operator)throw"Unknown assignment expression: "+b.operator;c=h|i}c=this.createPrimitive(c)}this.setValue(d,c),this.stateStack[0].value=c}else a.doneRight=!0,a.leftSide=a.value,this.stateStack.unshift({node:b.right});else a.doneLeft=!0,this.stateStack.unshift({node:b.left,components:!0})},Interpreter.prototype.stepBinaryExpression=function(){var a=this.stateStack[0],b=a.node;if(a.doneLeft)if(a.doneRight){this.stateStack.shift();var c,d=a.leftValue,e=a.value,f=this.comp(d,e);if("=="==b.operator||"!="==b.operator)c=d.isPrimitive&&e.isPrimitive?d.data==e.data:0===f,"!="==b.operator&&(c=!c);else if("==="==b.operator||"!=="==b.operator)c=d.isPrimitive&&e.isPrimitive?d.data===e.data:d===e,"!=="==b.operator&&(c=!c);else if(">"==b.operator)c=1==f;else if(">="==b.operator)c=1==f||0===f;else if("<"==b.operator)c=-1==f;else if("<="==b.operator)c=-1==f||0===f;else if("+"==b.operator){if("string"==d.type||"string"==e.type)var g=d.toString(),h=e.toString();else var g=d.toNumber(),h=e.toNumber();c=g+h}else if("in"==b.operator)c=this.hasProperty(e,d);else{var g=d.toNumber(),h=e.toNumber();if("-"==b.operator)c=g-h;else if("*"==b.operator)c=g*h;else if("/"==b.operator)c=g/h;else if("%"==b.operator)c=g%h;else if("&"==b.operator)c=g&h;else if("|"==b.operator)c=g|h;else if("^"==b.operator)c=g^h;else if("<<"==b.operator)c=g<<h;else if(">>"==b.operator)c=g>>h;else{if(">>>"!=b.operator)throw"Unknown binary operator: "+b.operator;c=g>>>h}}this.stateStack[0].value=this.createPrimitive(c)}else a.doneRight=!0,a.leftValue=a.value,this.stateStack.unshift({node:b.right});else a.doneLeft=!0,this.stateStack.unshift({node:b.left})},Interpreter.prototype.stepBreakStatement=function(){var a=this.stateStack.shift(),b=a.node,c=null;for(b.label&&(c=b.label.name),a=this.stateStack.shift();a&&"CallExpression"!=a.node.type&&"NewExpression"!=a.node.type;){if(c?c==a.label:a.isLoop||a.isSwitch)return;a=this.stateStack.shift()}throw new SyntaxError("Illegal break statement")},Interpreter.prototype.stepBlockStatement=function(){var a=this.stateStack[0],b=a.node,c=a.n_||0;b.body[c]?(a.n_=c+1,this.stateStack.unshift({node:b.body[c]})):this.stateStack.shift()},Interpreter.prototype.stepCallExpression=function(){var a=this.stateStack[0],b=a.node;if(a.doneCallee_){if(a.func_){var c=a.n_;a.arguments.length!=b.arguments.length&&(a.arguments[c-1]=a.value)}else{if("function"==a.value.type)a.func_=a.value;else if(a.member_=a.value[0],a.func_=this.getValue(a.value),!a.func_||"function"!=a.func_.type)throw new TypeError((a.func_&&a.func_.type)+" is not a function");"NewExpression"==a.node.type?(a.funcThis_=this.createObject(a.func_),a.isConstructor_=!0):a.value.length?a.funcThis_=a.value[0]:a.funcThis_=this.stateStack[this.stateStack.length-1].thisExpression,a.arguments=[];var c=0}if(b.arguments[c])a.n_=c+1,this.stateStack.unshift({node:b.arguments[c]});else if(a.doneExec)this.stateStack.shift(),a.isConstructor_&&"object"!==a.value.type?this.stateStack[0].value=a.funcThis_:this.stateStack[0].value=a.value;else{if(a.doneExec=!0,a.func_.node&&("FunctionApply_"==a.func_.node.type||"FunctionCall_"==a.func_.node.type)){if(a.funcThis_=a.arguments.shift(),"FunctionApply_"==a.func_.node.type){var d=a.arguments.shift();if(d&&this.isa(d,this.ARRAY)){a.arguments=[];for(var e=0;e<d.length;e++)a.arguments[e]=this.getProperty(d,e)}else a.arguments=[]}a.func_=a.member_}if(a.func_.node){for(var f=this.createScope(a.func_.node.body,a.func_.parentScope),e=0;e<a.func_.node.params.length;e++){var g=this.createPrimitive(a.func_.node.params[e].name),h=a.arguments.length>e?a.arguments[e]:this.UNDEFINED;this.setProperty(f,g,h)}for(var d=this.createObject(this.ARRAY),e=0;e<a.arguments.length;e++)this.setProperty(d,this.createPrimitive(e),a.arguments[e]);this.setProperty(f,"arguments",d);var i={node:a.func_.node.body,scope:f,thisExpression:a.funcThis_};this.stateStack.unshift(i),a.value=this.UNDEFINED}else if(a.func_.nativeFunc)a.value=a.func_.nativeFunc.apply(a.funcThis_,a.arguments);else{if(a.func_.asyncFunc){var j=this,k=function(b){a.value=b||j.UNDEFINED,j.paused_=!1},l=a.arguments.concat(k);return a.func_.asyncFunc.apply(a.funcThis_,l),void(this.paused_=!0)}if(!a.func_.eval)throw new TypeError("function not a function (huh?)");var m=a.arguments[0];if(m)if(m.isPrimitive){var n=new Interpreter(m.toString());n.stateStack[0].scope.parentScope=this.getScope(),a={node:{type:"Eval_"},interpreter:n},this.stateStack.unshift(a)}else a.value=m;else a.value=this.UNDEFINED}}}else a.doneCallee_=!0,this.stateStack.unshift({node:b.callee,components:!0})},Interpreter.prototype.stepConditionalExpression=function(){var a=this.stateStack[0];a.done?(this.stateStack.shift(),"ConditionalExpression"==a.node.type&&(this.stateStack[0].value=a.value)):a.test?(a.done=!0,
a.value.toBoolean()&&a.node.consequent?this.stateStack.unshift({node:a.node.consequent}):!a.value.toBoolean()&&a.node.alternate&&this.stateStack.unshift({node:a.node.alternate})):(a.test=!0,this.stateStack.unshift({node:a.node.test}))},Interpreter.prototype.stepContinueStatement=function(){var a=this.stateStack[0].node,b=null;a.label&&(b=a.label.name);for(var c=this.stateStack[0];c&&"CallExpression"!=c.node.type&&"NewExpression"!=c.node.type;){if(c.isLoop&&(!b||b==c.label))return;this.stateStack.shift(),c=this.stateStack[0]}throw new SyntaxError("Illegal continue statement")},Interpreter.prototype.stepDoWhileStatement=function(){var a=this.stateStack[0];a.isLoop=!0,"DoWhileStatement"==a.node.type&&void 0===a.test&&(a.value=this.createPrimitive(!0),a.test=!0),a.test?(a.test=!1,a.value.toBoolean()?a.node.body&&this.stateStack.unshift({node:a.node.body}):this.stateStack.shift()):(a.test=!0,this.stateStack.unshift({node:a.node.test}))},Interpreter.prototype.stepEmptyStatement=function(){this.stateStack.shift()},Interpreter.prototype.stepEval_=function(){var a=this.stateStack[0];a.interpreter.step()||(this.stateStack.shift(),this.stateStack[0].value=a.interpreter.value||this.UNDEFINED)},Interpreter.prototype.stepExpressionStatement=function(){var a=this.stateStack[0];a.done?(this.stateStack.shift(),this.value=a.value):(a.done=!0,this.stateStack.unshift({node:a.node.expression}))},Interpreter.prototype.stepForInStatement=function(){var a=this.stateStack[0];a.isLoop=!0;var b=a.node;if(a.doneVariable_)if(a.doneObject_){"undefined"==typeof a.iterator&&(a.object=a.value,a.iterator=0);var c=null;a:do{var d=a.iterator;for(var e in a.object.properties)if(!(e in a.object.nonenumerable)){if(0==d){c=e;break a}d--}a.object=a.object.parent&&a.object.parent.properties.prototype,a.iterator=0}while(a.object);a.iterator++,null===c?this.stateStack.shift():(this.setValueToScope(a.variable,this.createPrimitive(c)),b.body&&this.stateStack.unshift({node:b.body}))}else a.doneObject_=!0,a.variable=a.value,this.stateStack.unshift({node:b.right});else{a.doneVariable_=!0;var f=b.left;"VariableDeclaration"==f.type&&(f=f.declarations[0].id),this.stateStack.unshift({node:f,components:!0})}},Interpreter.prototype.stepForStatement=function(){var a=this.stateStack[0];a.isLoop=!0;var b=a.node,c=a.mode||0;0==c?(a.mode=1,b.init&&this.stateStack.unshift({node:b.init})):1==c?(a.mode=2,b.test&&this.stateStack.unshift({node:b.test})):2==c?(a.mode=3,a.value&&!a.value.toBoolean()?this.stateStack.shift():b.body&&this.stateStack.unshift({node:b.body})):3==c&&(a.mode=1,b.update&&this.stateStack.unshift({node:b.update}))},Interpreter.prototype.stepFunctionDeclaration=function(){this.stateStack.shift()},Interpreter.prototype.stepFunctionExpression=function(){var a=this.stateStack[0];this.stateStack.shift(),this.stateStack[0].value=this.createFunction(a.node)},Interpreter.prototype.stepIdentifier=function(){var a=this.stateStack[0];this.stateStack.shift();var b=this.createPrimitive(a.node.name);this.stateStack[0].value=a.components?b:this.getValueFromScope(b)},Interpreter.prototype.stepIfStatement=Interpreter.prototype.stepConditionalExpression,Interpreter.prototype.stepLabeledStatement=function(){var a=this.stateStack.shift();this.stateStack.unshift({node:a.node.body,label:a.node.label.name})},Interpreter.prototype.stepLiteral=function(){var a=this.stateStack[0];this.stateStack.shift(),this.stateStack[0].value=this.createPrimitive(a.node.value)},Interpreter.prototype.stepLogicalExpression=function(){var a=this.stateStack[0],b=a.node;if("&&"!=b.operator&&"||"!=b.operator)throw"Unknown logical operator: "+b.operator;a.doneLeft_?a.doneRight_?(this.stateStack.shift(),this.stateStack[0].value=a.value):"&&"==b.operator&&!a.value.toBoolean()||"||"==b.operator&&a.value.toBoolean()?(this.stateStack.shift(),this.stateStack[0].value=a.value):(a.doneRight_=!0,this.stateStack.unshift({node:b.right})):(a.doneLeft_=!0,this.stateStack.unshift({node:b.left}))},Interpreter.prototype.stepMemberExpression=function(){var a=this.stateStack[0],b=a.node;a.doneObject_?a.doneProperty_?(this.stateStack.shift(),a.components?this.stateStack[0].value=[a.object,a.value]:this.stateStack[0].value=this.getProperty(a.object,a.value)):(a.doneProperty_=!0,a.object=a.value,this.stateStack.unshift({node:b.property,components:!b.computed})):(a.doneObject_=!0,this.stateStack.unshift({node:b.object}))},Interpreter.prototype.stepNewExpression=Interpreter.prototype.stepCallExpression,Interpreter.prototype.stepObjectExpression=function(){var a=this.stateStack[0],b=a.node,c=a.valueToggle,d=a.n||0;a.object?c?a.key=a.value:this.setProperty(a.object,a.key,a.value):a.object=this.createObject(this.OBJECT),b.properties[d]?(c?(a.n=d+1,this.stateStack.unshift({node:b.properties[d].value})):this.stateStack.unshift({node:b.properties[d].key,components:!0}),a.valueToggle=!c):(this.stateStack.shift(),this.stateStack[0].value=a.object)},Interpreter.prototype.stepProgram=Interpreter.prototype.stepBlockStatement,Interpreter.prototype.stepReturnStatement=function(){var a=this.stateStack[0],b=a.node;if(b.argument&&!a.done)a.done=!0,this.stateStack.unshift({node:b.argument});else{var c=a.value||this.UNDEFINED;do{if(this.stateStack.shift(),0==this.stateStack.length)throw new SyntaxError("Illegal return statement");a=this.stateStack[0]}while("CallExpression"!=a.node.type&&"NewExpression"!=a.node.type);a.value=c}},Interpreter.prototype.stepSequenceExpression=function(){var a=this.stateStack[0],b=a.node,c=a.n||0;b.expressions[c]?(a.n=c+1,this.stateStack.unshift({node:b.expressions[c]})):(this.stateStack.shift(),this.stateStack[0].value=a.value)},Interpreter.prototype.stepSwitchStatement=function(){var a=this.stateStack[0];if(a.checked=a.checked||[],a.isSwitch=!0,a.test){a.switchValue||(a.switchValue=a.value);var b=a.index||0,c=a.node.cases[b];if(c)if(a.done||a.checked[b]||!c.test){if(a.done||!c.test||0==this.comp(a.value,a.switchValue)){a.done=!0;var d=a.n||0;if(c.consequent[d])return this.stateStack.unshift({node:c.consequent[d]}),void(a.n=d+1)}a.n=0,a.index=b+1}else a.checked[b]=!0,this.stateStack.unshift({node:c.test});else this.stateStack.shift()}else a.test=!0,this.stateStack.unshift({node:a.node.discriminant})},Interpreter.prototype.stepThisExpression=function(){this.stateStack.shift();for(var a=0;a<this.stateStack.length;a++)if(this.stateStack[a].thisExpression)return void(this.stateStack[0].value=this.stateStack[a].thisExpression);throw"No this expression found."},Interpreter.prototype.stepThrowStatement=function(){var a=this.stateStack[0],b=a.node;a.argument?this.throwException(a.value):(a.argument=!0,this.stateStack.unshift({node:b.argument}))},Interpreter.prototype.stepUnaryExpression=function(){var a=this.stateStack[0],b=a.node;if(a.done){this.stateStack.shift();var c;if("-"==b.operator)c=-a.value.toNumber();else if("+"==b.operator)c=a.value.toNumber();else if("!"==b.operator)c=!a.value.toBoolean();else if("~"==b.operator)c=~a.value.toNumber();else if("typeof"==b.operator)c=a.value.type;else if("delete"==b.operator){if(a.value.length)var d=a.value[0],e=a.value[1];else var d=this.getScope(),e=a.value;c=this.deleteProperty(d,e)}else{if("void"!=b.operator)throw"Unknown unary operator: "+b.operator;c=void 0}this.stateStack[0].value=this.createPrimitive(c)}else{a.done=!0;var f={node:b.argument};"delete"==b.operator&&(f.components=!0),this.stateStack.unshift(f)}},Interpreter.prototype.stepUpdateExpression=function(){var a=this.stateStack[0],b=a.node;if(a.done){this.stateStack.shift();var c,d=a.value,e=this.getValue(d).toNumber();if("++"==b.operator)c=this.createPrimitive(e+1);else{if("--"!=b.operator)throw"Unknown update expression: "+b.operator;c=this.createPrimitive(e-1)}this.setValue(d,c),this.stateStack[0].value=b.prefix?c:this.createPrimitive(e)}else a.done=!0,this.stateStack.unshift({node:b.argument,components:!0})},Interpreter.prototype.stepVariableDeclaration=function(){var a=this.stateStack[0],b=a.node,c=a.n||0;b.declarations[c]?(a.n=c+1,this.stateStack.unshift({node:b.declarations[c]})):this.stateStack.shift()},Interpreter.prototype.stepVariableDeclarator=function(){var a=this.stateStack[0],b=a.node;if(b.init&&!a.done)a.done=!0,this.stateStack.unshift({node:b.init});else{if(!this.hasProperty(this,b.id.name)||b.init){var c=b.init?a.value:this.UNDEFINED;this.setValue(this.createPrimitive(b.id.name),c)}this.stateStack.shift()}},Interpreter.prototype.stepWhileStatement=Interpreter.prototype.stepDoWhileStatement,Interpreter.prototype.stepTryStatement=function(){var a=this.stateStack[0],b=a.node;a.doneBlock?!a.doneFinalizer&&b.finalizer?(a.doneFinalizer=!0,this.stateStack.unshift({node:b.finalizer})):this.stateStack.shift():(a.doneBlock=!0,this.stateStack.unshift({node:b.block}))},Interpreter.prototype.createSpecialScope=function(a,b){if(!a)throw"parentScope required";var c=b||this.createObject(null);return c.parentScope=a,c.strict=a.strict,c},Interpreter.prototype.throwException=function(a){var b=this.stateStack[0];do this.stateStack.shift(),b=this.stateStack[0];while(b&&"TryStatement"!==b.node.type);if(!b)throw"Unhandled exception: "+a.toString();this.stateStack.unshift({node:b.node.handler,throwValue:a})},Interpreter.prototype.stepCatchClause=function(){var a=this.stateStack[0],b=a.node;if(a.doneBody)this.stateStack.shift();else{a.doneBody=!0;var c;if(b.param){c=this.createSpecialScope(this.getScope());var d=this.createPrimitive(b.param.name);this.setProperty(c,d,a.throwValue)}this.stateStack.unshift({node:b.body,scope:c})}},Interpreter.prototype.stepWithStatement=function(){var a=this.stateStack[0],b=a.node;if(a.doneObject)if(a.doneBody)this.stateStack.shift();else{a.doneBody=!0;var c=this.createSpecialScope(this.getScope(),a.value);this.stateStack.unshift({node:b.body,scope:c})}else a.doneObject=!0,this.stateStack.unshift({node:b.object})},window.Interpreter=Interpreter,Interpreter.prototype.step=Interpreter.prototype.step,Interpreter.prototype.run=Interpreter.prototype.run;