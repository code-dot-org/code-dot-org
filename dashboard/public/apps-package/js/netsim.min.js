require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({136:[function(a){var b=a("../appMain"),c=a("../StudioApp").singleton,d=a("./netsim"),e=a("./levels"),f=a("./skins");window.netsimMain=function(a){a.skinsModule=f,a.isEditorless=!0;var g=new d;g.injectStudioApp(c),b(g,e,a)}},{"../StudioApp":2,"../appMain":3,"./levels":135,"./netsim":137,"./skins":140}],140:[function(a,b,c){var d=a("../skins");c.load=function(a,b){var c=d.load(a,b);return c}},{"../skins":143}],137:[function(a,b){"use strict";var c=a("./page.html"),d=a("./NetSimConnection"),e=a("./DashboardUser"),f=a("./NetSimLobby"),g=a("./NetSimRouterPanel"),h=a("./NetSimSendWidget"),i=a("./NetSimLogWidget"),j=a("./RunLoop"),k=b.exports=function(){this.skin=null,this.level=null,this.heading=0,this.currentUser_=e.getCurrentUser(),this.connection_=null,this.runLoop_=new j};k.prototype.injectStudioApp=function(a){this.studioApp_=a},k.prototype.attachHandlers_=function(){},k.prototype.init=function(b){if(!this.studioApp_)throw new Error("NetSim requires a StudioApp");this.skin=b.skin,this.level=b.level,b.html=c({assetUrl:this.studioApp_.assetUrl,data:{visualization:"",localeDirection:this.studioApp_.localeDirection(),controls:a("./controls.html")({assetUrl:this.studioApp_.assetUrl})},hideRunButton:!0}),b.enableShowCode=!1,b.loadAudio=this.loadAudio_.bind(this),this.studioApp_.configureDom=this.configureDomOverride_.bind(this.studioApp_),this.studioApp_.onResize=this.onResizeOverride_.bind(this.studioApp_),this.studioApp_.init(b),this.attachHandlers_(),this.currentUser_.whenReady(function(){this.initWithUserName_(this.currentUser_)}.bind(this)),this.runLoop_.begin()},k.prototype.getOverrideShardID=function(){var a=location.search.split("?");if(1===a.length)return void 0;var b;return a[1].split("&").forEach(function(a){var c=a.split("=");c.length>1&&"s"===c[0]&&(b=c[1])}),b},k.prototype.initWithUserName_=function(a){this.mainContainer_=$("#netsim"),this.receivedMessageLog_=i.createWithin(document.getElementById("netsim_received"),"Received Messages"),this.sentMessageLog_=i.createWithin(document.getElementById("netsim_sent"),"Sent Messages"),this.connection_=new d(this.sentMessageLog_,this.receivedMessageLog_),this.connection_.attachToRunLoop(this.runLoop_),this.connection_.statusChanges.register(this.refresh_.bind(this));var b=document.getElementById("netsim_lobby_container");this.lobbyControl_=f.createWithin(b,this.connection_,a,this.getOverrideShardID());var c=document.getElementById("netsim_tabpanel");this.routerPanel_=g.createWithin(c,this.connection_);var e=document.getElementById("netsim_send");this.sendWidget_=h.createWithin(e,this.connection_),this.refresh_()},k.prototype.refresh_=function(){this.connection_.isConnectedToRouter()?this.mainContainer_.show():this.mainContainer_.hide()},k.prototype.loadAudio_=function(){},k.prototype.configureDomOverride_=function(a){var b=document.getElementById(a.containerId);b.innerHTML=a.html},k.prototype.onResizeOverride_=function(){var a=document.getElementById("appcontainer"),b=a.parentNode,c=window.getComputedStyle(b),d=parseInt(c.width,10);a.style.top=b.offsetTop+"px",a.style.width=d+"px"}},{"./DashboardUser":111,"./NetSimConnection":113,"./NetSimLobby":117,"./NetSimLogWidget":120,"./NetSimRouterPanel":126,"./NetSimSendWidget":128,"./RunLoop":133,"./controls.html":134,"./page.html":139}],139:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("");{var a=require("../../locale/current/common");require("../../locale/current/netsim")}buf.push('\n\n<div id="rotateContainer" style="background-image: url(',escape(assetUrl("media/mobile_tutorial_turnphone.png")),')">\n  <div id="rotateText">\n    <p>',escape(a.rotateText()),"<br>",escape(a.orientationLock()),"</p>\n  </div>\n</div>\n\n");var b=function(){buf.push('  <div id="bubble" class="clearfix">\n    <table id="prompt-table">\n      <tr>\n        <td id="prompt-icon-cell">\n          <img id="prompt-icon"/>\n        </td>\n        <td id="prompt-cell">\n          <p id="prompt">\n          </p>\n        </td>\n      </tr>\n    </table>\n    <div id="ani-gif-preview-wrapper">\n      <div id="ani-gif-preview">\n        <img id="play-button" src="',escape(assetUrl("media/play-circle.png")),'"/>\n      </div>\n    </div>\n  </div>\n')};buf.push("\n");var c=function(a){buf.push("  "),a&&buf.push('    <div id="helpArea">\n      ',a,"\n    </div>\n  "),buf.push("")};buf.push('\n<div id="appcontainer">\n  <div id="netsim_lobby_container"></div>\n  <div id="netsim">\n    <div id="netsim_rightcol">\n      <div id="netsim_vizualization">\n        <img src="',escape(assetUrl("media/netsim/netsim_viz_mock.png")),'" />\n      </div>\n      <div id="netsim_tabpanel"></div>\n    </div>\n    <div id="netsim_leftcol">\n      <div id="netsim_received"></div>\n      <div id="netsim_sent"></div>\n      <div id="netsim_send"></div>\n    </div>\n\n  </div>\n  <div id="footers" dir="',escape(data.localeDirection),'">\n    '),b(),buf.push("\n    "),c(data.helpHtml),buf.push('\n  </div>\n</div>\n\n<div class="clear"></div>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{"../../locale/current/common":189,"../../locale/current/netsim":194,ejs:205}],135:[function(a,b){var c=(a("../../locale/current/netsim"),b.exports={});c.netsim_demo={freePlay:!0}},{"../../locale/current/netsim":194}],194:[function(a,b){b.exports=window.blockly.appLocale},{}],134:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div id="slider-cell">\n  <img id="spinner" style="visibility: hidden;" src="',escape(assetUrl("media/turtle/loading.gif")),'" height=15 width=15>\n</div>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:205}],133:[function(a,b){"use strict";var c=a("./ObservableEvent"),d=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,e=30,f=1e3/e,g=b.exports=function(){this.enabled=!1,this.clock=new g.Clock,this.tick_=this.buildTickMethod_(),this.tick=new c,this.render=new c};g.Clock=function(){this.time=d(),this.deltaTime=0},g.prototype.buildTickMethod_=function(){var a,b=this;return a=window.requestAnimationFrame?function(c){b.enabled&&(b.clock.deltaTime=c-b.clock.time,b.clock.time=c,b.tick.notifyObservers(b.clock),b.render.notifyObservers(b.clock),requestAnimationFrame(a))}:function(){if(b.enabled){var c=d();b.clock.deltaTime=c-b.clock.time,b.clock.time=c,b.tick.notifyObservers(b.clock),b.render.notifyObservers(b.clock),setTimeout(a,f-b.clock.deltaTime)}}},g.prototype.begin=function(){this.enabled=!0,this.clock.time=d(),this.tick_(this.clock.time)},g.prototype.end=function(){this.enabled=!1}},{"./ObservableEvent":132}],128:[function(a,b){"use strict";var c=a("./NetSimSendWidget.html"),d=a("../dom"),e=b.exports=function(a){this.connection_=a,this.connection_.statusChanges.register(this.onConnectionStatusChange_.bind(this))};e.createWithin=function(a,b){var d=new e(b);return a.innerHTML=c({}),d.bindElements_(),d.refresh(),d},e.prototype.bindElements_=function(){this.rootDiv_=$("#netsim_send_widget"),this.toAddressTextbox_=this.rootDiv_.find("#to_address"),this.payloadTextbox_=this.rootDiv_.find("#payload"),this.sendButton_=this.rootDiv_.find("#send_button"),d.addClickTouchEvent(this.sendButton_[0],this.onSendButtonPress_.bind(this))},e.prototype.onConnectionStatusChange_=function(){},e.prototype.refresh=function(){},e.prototype.onSendButtonPress_=function(){var a=this.connection_.myNode;a&&a.sendMessage({toAddress:parseInt(this.toAddressTextbox_.val(),10),messageContent:this.payloadTextbox_.val()})}},{"../dom":44,"./NetSimSendWidget.html":127}],127:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div id="netsim_send_widget" class="netsim_send_widget">\n  <h1>Send a Message</h1>\n  <label for="to_address">To:</label>\n  <input id="to_address" type="text" />\n  <label for="payload">Payload</label>\n  <textarea id="payload"></textarea>\n  <input type="button" id="send_button" value="Send" />\n</div>')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:205}],126:[function(a,b){"use strict";var c=a("./NetSimRouterPanel.html"),d=a("./NetSimRouterNode"),e=d.DnsMode,f=a("./NetSimLogger"),g=new f(console,f.LogLevel.VERBOSE),h=b.exports=function(a){this.connection_=a,this.connection_.shardChange.register(this.onShardChange_.bind(this)),g.info("RouterPanel registered to connection shardChange"),this.myLocalNode=null,this.myConnectedRouter=null};h.createWithin=function(a,b){var d=new h(b);return a.innerHTML=c({}),d.bindElements_(),d.refresh(),d},h.prototype.bindElements_=function(){this.rootDiv_=$("#netsim_router_panel"),this.dnsModeRadios_=this.rootDiv_.find('input[type="radio"][name="dns_mode"]'),this.dnsModeRadios_.change(this.onDnsModeChange_.bind(this)),this.dnsModeManualControls_=this.rootDiv_.find("#dns_mode_manual_controls"),this.becomeDnsButton_=this.dnsModeManualControls_.find("#become_dns_button"),this.becomeDnsButton_.click(this.onBecomeDnsButtonClick_.bind(this)),this.connectedSpan_=this.rootDiv_.find("#connected"),this.notConnectedSpan_=this.rootDiv_.find("#not_connected"),this.networkTable_=this.rootDiv_.find("#netsim_router_network_table")},h.prototype.onShardChange_=function(a,b){this.myLocalNode=b,b&&(b.routerChange.register(this.onRouterChange_.bind(this)),g.info("RouterPanel registered to localNode routerChange"))},h.prototype.onRouterChange_=function(a,b){this.myConnectedRouter=b,this.refresh(),b&&(b.stateChange.register(this.onRouterStateChange_.bind(this)),g.info("RouterPanel registered to router stateChange"),b.wiresChange.register(this.onRouterWiresChange_.bind(this)),g.info("RouterPanel registered to router wiresChange"))},h.prototype.onRouterStateChange_=function(){this.refresh()},h.prototype.onRouterWiresChange_=function(){this.refreshAddressTable_(this.myConnectedRouter.getAddressTable())},h.prototype.onDnsModeChange_=function(){var a=this.myConnectedRouter;a.dnsMode=this.dnsModeRadios_.siblings(":checked").val(),a.update()},h.prototype.onBecomeDnsButtonClick_=function(){var a=this.myConnectedRouter;a.dnsNodeID=this.myLocalNode.entityID,a.update()},h.prototype.refresh=function(){this.myConnectedRouter?(this.connectedSpan_.show(),this.notConnectedSpan_.hide(),this.refreshDnsModeSelector_(),this.refreshAddressTable_(this.myConnectedRouter.getAddressTable())):(this.notConnectedSpan_.show(),this.connectedSpan_.hide())},h.prototype.refreshDnsModeSelector_=function(){var a=this.getDnsMode_();this.dnsModeRadios_.siblings('[value="'+a+'"]').prop("checked",!0),a===e.MANUAL?this.dnsModeManualControls_.show():this.dnsModeManualControls_.hide()},h.prototype.refreshAddressTable_=function(a){var b=this.getDnsMode_(),c=this.networkTable_.find("tbody");c.empty(),a.forEach(function(a){var d=a.hostname;a.isDnsNode&&b!==e.NONE&&(d+=" (DNS)");var f="";(b===e.NONE||a.isDnsNode||a.isLocal)&&(f=a.address);var g=$("<tr>");$("<td>").html(d).appendTo(g),$("<td>").html(f).appendTo(g),a.isLocal&&g.addClass("localNode"),a.isDnsNode&&b!==e.NONE&&g.addClass("dnsNode"),g.appendTo(c)})},h.prototype.getDnsMode_=function(){return this.myConnectedRouter?this.myConnectedRouter.dnsMode:e.NONE}},{"./NetSimLogger":121,"./NetSimRouterNode":124,"./NetSimRouterPanel.html":125}],125:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div id="netsim_router_panel">\n  <span id="not_connected">No router connected.</span>\n  <span id="connected">\n    <div id="dns_mode_control">\n      <h1>DNS Mode</h1>\n      <input id="dns_mode_none" type="radio" name="dns_mode" value="none" /><label for="dns_mode_none">None</label>\n      <br/><input id="dns_mode_manual" type="radio" name="dns_mode" value="manual" /><label for="dns_mode_manual">Manual</label>\n      <br/><input id="dns_mode_automatic" type="radio" name="dns_mode" value="automatic" /><label for="dns_mode_automatic">Automatic</label>\n    </div>\n    <div id="dns_mode_manual_controls">\n      <input id="become_dns_button" type="button" value="Become DNS" />\n    </div>\n    <div id="network_table">\n      <h1>My network</h1>\n      <table id="netsim_router_network_table">\n        <thead>\n          <tr>\n            <th>Hostname</th>\n            <th>Address</th>\n          </tr>\n        </thead>\n        <tbody></tbody>\n      </table>\n    </div>\n  </span>\n</div>')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:205}],120:[function(a,b){"use strict";var c=a("./NetSimLogWidget.html"),d=a("../dom"),e=b.exports=function(){};e.uniqueIDCounter=0,e.createWithin=function(a,b){var d=new e,f=e.uniqueIDCounter;return e.uniqueIDCounter++,a.innerHTML=c({logInstanceID:f,logTitle:b}),d.bindElements_(f),d},e.prototype.bindElements_=function(a){this.rootDiv_=$("#netsim_log_widget_"+a),this.scrollArea_=this.rootDiv_.find("#scroll_area"),this.clearButton_=this.rootDiv_.find("#clear_button"),d.addClickTouchEvent(this.clearButton_[0],this.onClearButtonPress_.bind(this))},e.prototype.onClearButtonPress_=function(){this.scrollArea_.empty()},e.prototype.log=function(a){var b=this.scrollArea_,c=b[0].scrollHeight-b[0].scrollTop<=b.outerHeight();if($("<div>").html(a).appendTo(this.scrollArea_),c){var d=250;b.animate({scrollTop:b[0].scrollHeight},d)}}},{"../dom":44,"./NetSimLogWidget.html":119}],119:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div id="netsim_log_widget_',escape(logInstanceID),'" class="netsim_log_widget">\n  <h1>',escape(logTitle),'</h1>\n  <div id="scroll_area"></div>\n  <input type="button" id="clear_button" value="Clear" />\n</div>')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:205}],117:[function(a,b){"use strict";var c=a("../dom"),d=a("../utils"),e=a("./netsimUtils"),f=a("./NetSimLogger"),g=a("./NetSimClientNode"),h=a("./NetSimRouterNode"),i=a("./NetSimLobby.html"),j=new f(console,f.LogLevel.VERBOSE),k="none",l=b.exports=function(a,b,c){this.connection_=a,this.connection_.statusChanges.register(this.refresh_.bind(this)),j.info("NetSimLobby registered to connection statusChanges"),this.connection_.shardChange.register(this.onShardChange_.bind(this)),j.info("NetSimLobby registered to connection shardChanges"),this.shard_=null,this.user_=b,this.overrideShardID_=c,this.selectedID_=void 0,this.selectedListItem_=void 0};l.createWithin=function(a,b,c,d){var e=new l(b,c,d);return a.innerHTML=i({}),e.bindElements_(),e.refresh_(),e},l.prototype.bindElements_=function(){this.openRoot_=$("#netsim_lobby_open"),this.closedRoot_=$("#netsim_lobby_closed"),this.displayNameView_=this.openRoot_.find("#display_name_view"),this.shardView_=this.openRoot_.find("#shard_view"),this.nameInput_=this.displayNameView_.find("#netsim_lobby_name"),this.setNameButton_=this.displayNameView_.find("#netsim_lobby_set_name_button"),c.addClickTouchEvent(this.setNameButton_[0],this.setNameButtonClick_.bind(this)),this.shardSelector_=this.shardView_.find("#netsim_shard_select"),this.shardSelector_.change(this.onShardSelectorChange_.bind(this)),this.addRouterButton_=this.shardView_.find("#netsim_lobby_add_router"),c.addClickTouchEvent(this.addRouterButton_[0],this.addRouterButtonClick_.bind(this)),this.lobbyList_=this.shardView_.find("#netsim_lobby_list"),this.connectButton_=this.shardView_.find("#netsim_lobby_connect"),c.addClickTouchEvent(this.connectButton_[0],this.connectButtonClick_.bind(this)),this.disconnectButton_=this.closedRoot_.find("#netsim_lobby_disconnect"),c.addClickTouchEvent(this.disconnectButton_[0],this.disconnectButtonClick_.bind(this)),this.connectionStatusSpan_=this.closedRoot_.find("#netsim_lobby_statusbar"),this.shardLinks_=$(".shardLink"),this.shardLinks_.hide(),this.user_.isSignedIn&&(this.nameInput_.val(this.user_.name),this.refreshShardList_())},l.prototype.onShardChange_=function(a){this.shard_=a,null!==this.shard_&&(this.shard_.nodeTable.tableChange.register(this.onNodeTableChange_.bind(this)),j.info("NetSimLobby registered to nodeTable tableChange"))},l.prototype.onNodeTableChange_=function(a){var b=e.nodesFromRows(this.shard_,a);this.refreshLobbyList_(b)},l.prototype.setNameButtonClick_=function(){this.nameInput_.prop("disabled",!0),this.setNameButton_.hide(),this.shardSelector_.attr("disabled",!1),this.refreshShardList_()},l.prototype.onShardSelectorChange_=function(){this.connection_.isConnectedToShard()&&(this.connection_.disconnectFromShard(),this.nameInput_.disabled=!1),this.shardSelector_.val()!==k&&(this.nameInput_.disabled=!0,this.connection_.connectToShard(this.shardSelector_.val(),this.nameInput_.val()))},l.prototype.addRouterButtonClick_=function(){this.connection_.addRouterToLobby()},l.prototype.connectButtonClick_=function(){this.selectedID_&&this.connection_.connectToRouter(this.selectedID_)},l.prototype.disconnectButtonClick_=function(){this.connection_.disconnectFromRouter()},l.prototype.refreshShardList_=function(){var a=this,b="demo",c=this.shardSelector_;return void 0!==this.overrideShardID_?void this.useShard(this.overrideShardID_):this.user_.isSignedIn?void this.getUserSections_(function(d){return 0===d.length?void this.useRandomShard():($(c).empty(),d.length>1&&$("<option>").val(k).html("-- PICK ONE --").appendTo(c),d.forEach(function(a){$("<option>").val("netsim_"+b+"_"+a.id).html(a.name).appendTo(c)}),void a.onShardSelectorChange_())}):void this.useRandomShard()},l.prototype.useRandomShard=function(){this.useShard("netsim_"+d.createUuid())},l.prototype.useShard=function(a){this.shardSelector_.empty(),$("<option>").val(a).html("My Private Network").appendTo(this.shardSelector_),this.shardLinks_.attr("href",this.buildShareLink(a)).show(),this.onShardSelectorChange_()},l.prototype.buildShareLink=function(a){var b=document.location.protocol+"//"+document.location.host+document.location.pathname;return b+"?s="+a},l.prototype.refresh_=function(){this.connection_.isConnectedToRouter()?this.refreshClosedLobby_():this.refreshOpenLobby_()},l.prototype.refreshClosedLobby_=function(){this.closedRoot_.show(),this.openRoot_.hide(),this.connectionStatusSpan_.html(this.connection_.myNode.getStatus()+" "+this.connection_.myNode.getStatusDetail())},l.prototype.refreshOpenLobby_=function(){return this.openRoot_.show(),this.closedRoot_.hide(),""===this.nameInput_.val()?(this.nameInput_.prop("disabled",!1),this.setNameButton_.show(),void this.shardView_.hide()):(this.nameInput_.prop("disabled",!0),this.setNameButton_.hide(),this.shardView_.show(),this.connection_.isConnectedToShard()?(this.addRouterButton_.show(),this.lobbyList_.show(),this.connectButton_.show(),void this.connection_.getAllNodes(function(a){this.refreshLobbyList_(a)}.bind(this))):(this.shardSelector_.val(k),this.addRouterButton_.hide(),this.lobbyList_.hide(),void this.connectButton_.hide()))},l.prototype.refreshLobbyList_=function(a){this.lobbyList_.empty(),a.sort(function(a,b){return a.getDisplayName()>b.getDisplayName()?1:-1}),this.selectedListItem_=void 0,a.forEach(function(a){var b=$("<li>").html(a.getDisplayName()+" : "+a.getStatus()+" "+a.getStatusDetail());a.getNodeType()===h.getNodeType()?b.addClass("router_row"):(b.addClass("user_row"),a.entityID===this.connection_.myNode.entityID&&b.addClass("own_row")),a.entityID===this.selectedID_&&(b.addClass("selected_row"),this.selectedListItem_=b),c.addClickTouchEvent(b[0],this.onRowClick_.bind(this,b,a)),b.appendTo(this.lobbyList_)}.bind(this)),this.onSelectionChange()},l.prototype.onRowClick_=function(a,b){if(g.getNodeType()!==b.getNodeType()){var c=this.selectedID_,d=this.selectedListItem_;d&&d.removeClass("selected_row"),this.selectedID_=void 0,this.selectedListItem_=void 0,b.entityID!==c&&(this.selectedID_=b.entityID,this.selectedListItem_=a,this.selectedListItem_.addClass("selected_row")),this.onSelectionChange()}},l.prototype.onSelectionChange=function(){this.connectButton_.attr("disabled",void 0===this.selectedListItem_)},l.prototype.getUserSections_=function(a){$.ajax({dataType:"json",url:"/v2/sections/membership",success:a})}},{"../dom":44,"../utils":184,"./NetSimClientNode":112,"./NetSimLobby.html":116,"./NetSimLogger":121,"./NetSimRouterNode":124,"./netsimUtils":138}],138:[function(a,b){"use strict";var c=a("./NetSimClientNode"),d=a("./NetSimRouterNode");b.exports.nodesFromRows=function(a,b){return b.map(function(b){if(b.type===c.getNodeType())return new c(a,b);if(b.type==d.getNodeType())return new d(a,b);throw new Error("Unable to map row to node.")})}},{"./NetSimClientNode":112,"./NetSimRouterNode":124}],116:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div id="netsim_lobby_open">\n  <div id="display_name_view">\n    <label for="netsim_lobby_name">My Name:</label>\n    <input id="netsim_lobby_name" type="text" />\n    <input id="netsim_lobby_set_name_button" type="button" value="Set Name" />\n  </div>\n  <div id="shard_view">\n    <label for="netsim_shard_select">My Section:</label>\n    <select id="netsim_shard_select"></select>\n    <a class="shardLink" href="#">Share this private network</a>\n    <input type="button" id="netsim_lobby_add_router" value="Add Router" />\n    <ul id="netsim_lobby_list"></ul>\n    <input type="button" id="netsim_lobby_connect" value="Connect" />\n  </div>\n</div>\n<div id="netsim_lobby_closed">\n    <span id="netsim_lobby_statusbar">...</span>\n    <a class="shardLink" href="#">Share this private network</a>\n    <input type="button" id="netsim_lobby_disconnect" value="Disconnect" />\n</div>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:205}],113:[function(a,b){"use strict";var c=a("./NetSimLogger"),d=a("./NetSimClientNode"),e=a("./NetSimRouterNode"),f=a("./NetSimLocalClientNode"),g=a("./ObservableEvent"),h=a("./NetSimShard"),i=new c(c.LogLevel.VERBOSE),j=b.exports=function(a,b){this.displayName_="",this.sentLog_=a,this.receivedLog_=b,this.shard_=null,this.myNode=null,this.shardChange=new g,this.statusChanges=new g,window.addEventListener("beforeunload",this.onBeforeUnload_.bind(this))};j.prototype.attachToRunLoop=function(a){a.tick.register(this.tick.bind(this))},j.prototype.tick=function(a){this.myNode&&(this.myNode.tick(a),this.shard_.tick(a))},j.prototype.getLogger=function(){return i},j.prototype.onBeforeUnload_=function(){this.isConnectedToShard()&&this.disconnectFromShard()},j.prototype.connectToShard=function(a,b){this.isConnectedToShard()&&(i.warn("Auto-closing previous connection..."),this.disconnectFromShard()),this.shard_=new h(a),this.createMyClientNode_(b)},j.prototype.disconnectFromShard=function(){return this.isConnectedToShard()?(this.isConnectedToRouter()&&this.disconnectFromRouter(),void this.myNode.destroy(function(){this.myNode.stopSimulation(),this.myNode=null,this.shardChange.notifyObservers(null,null),this.statusChanges.notifyObservers()}.bind(this))):void i.warn("Redundant disconnect call.")},j.prototype.createMyClientNode_=function(a){f.create(this.shard_,function(b){b?(this.myNode=b,this.myNode.onChange.register(this.onMyNodeChange_.bind(this)),this.myNode.setDisplayName(a),this.myNode.initializeSimulation(this.sentLog_,this.receivedLog_),this.myNode.update(function(){this.shardChange.notifyObservers(this.shard_,this.myNode),this.statusChanges.notifyObservers()}.bind(this))):i.error("Failed to create client node.")}.bind(this))},j.prototype.onMyNodeChange_=function(){"Offline"===this.myNode.getStatus()&&this.disconnectFromShard()},j.prototype.isConnectedToShard=function(){return null!==this.myNode},j.prototype.getAllNodes=function(a){if(!this.isConnectedToShard())return i.warn("Can't get lobby rows, not connected to shard."),void a([]);var b=this;this.shard_.nodeTable.readAll(function(c){if(!c)return i.warn("Lobby data request failed, using empty list."),void a([]);var f=c.map(function(a){return a.type===d.getNodeType()?new d(b.shard_,a):a.type===e.getNodeType()?new e(b.shard_,a):void 0}).filter(function(a){return void 0!==a});a(f)})},j.prototype.addRouterToLobby=function(){var a=this;e.create(this.shard_,function(){a.statusChanges.notifyObservers()})},j.prototype.isConnectedToRouter=function(){return this.myNode&&this.myNode.myRouter},j.prototype.connectToRouter=function(a){this.isConnectedToRouter()&&(i.warn("Auto-disconnecting from previous router."),this.disconnectFromRouter());var b=this;e.get(a,this.shard_,function(c){return c?void b.myNode.connectToRouter(c,function(a){a||i.warn("Failed to connect to "+c.getDisplayName()),b.statusChanges.notifyObservers()}):void i.warn("Failed to find router with ID "+a)})},j.prototype.disconnectFromRouter=function(){if(!this.isConnectedToRouter())return void i.warn("Cannot disconnect: Not connected.");var a=this;this.myNode.disconnectRemote(function(){a.statusChanges.notifyObservers()})}},{"./NetSimClientNode":112,"./NetSimLocalClientNode":118,"./NetSimLogger":121,"./NetSimRouterNode":124,"./NetSimShard":129,"./ObservableEvent":132}],129:[function(a,b){"use strict";var c=a("../appsApi").SharedTable,d=a("./NetSimTable"),e="localhost"===window.location.hostname.split(".")[0]?"JGW2rHUp_UCMW_fQmRf6iQ==":"HQJ8GCCMGP7Yh8MrtDusIA==",f=b.exports=function(a){this.nodeTable=new d(new c(e,a+"_n")),this.wireTable=new d(new c(e,a+"_w")),this.messageTable=new d(new c(e,a+"_m")),this.heartbeatTable=new d(new c(e,a+"_h"))};f.prototype.tick=function(a){this.nodeTable.tick(a),this.wireTable.tick(a),this.messageTable.tick(a)}},{"../appsApi":16,"./NetSimTable":130}],130:[function(a,b){"use strict";var c=a("../utils").getLodash(),d=a("./ObservableEvent"),e=5e3,f=b.exports=function(a){this.remoteTable_=a,this.tableChange=new d,this.cache_={},this.lastFullUpdateTime_=0};f.prototype.readAll=function(a){this.remoteTable_.readAll(function(b){a(b),null!==b&&this.fullCacheUpdate_(b)}.bind(this))},f.prototype.read=function(a,b){this.remoteTable_.read(a,function(c){b(c),void 0!==c&&this.updateCacheRow_(a,c)}.bind(this))},f.prototype.create=function(a,b){this.remoteTable_.create(a,function(a){b(a),void 0!==a&&this.addRowToCache_(a)}.bind(this))},f.prototype.update=function(a,b,c){this.remoteTable_.update(a,b,function(d){c(d),d&&this.updateCacheRow_(a,b)}.bind(this))},f.prototype["delete"]=function(a,b){this.remoteTable_["delete"](a,function(c){b(c),c&&this.removeRowFromCache_(a)}.bind(this))},f.prototype.fullCacheUpdate_=function(a){var b=a.reduce(function(a,b){return a[b.id]=b,a},{});c.isEqual(this.cache_,b)||(this.cache_=b,this.tableChange.notifyObservers(this.arrayFromCache_())),this.lastFullUpdateTime_=Date.now()},f.prototype.addRowToCache_=function(a){this.cache_[a.id]=a,this.tableChange.notifyObservers(this.arrayFromCache_())},f.prototype.removeRowFromCache_=function(a){void 0!==this.cache_[a]&&(delete this.cache_[a],this.tableChange.notifyObservers(this.arrayFromCache_()))},f.prototype.updateCacheRow_=function(a,b){var d=this.cache_[a],e=b;e.id=a,c.isEqual(d,e)||(this.cache_[a]=e,this.tableChange.notifyObservers(this.arrayFromCache_()))},f.prototype.arrayFromCache_=function(){var a=[];for(var b in this.cache_)this.cache_.hasOwnProperty(b)&&a.push(this.cache_[b]);return a},f.prototype.tick=function(){Date.now()-this.lastFullUpdateTime_>e&&this.readAll(function(){})}},{"../utils":184,"./ObservableEvent":132}],124:[function(a,b){"use strict";var c=a("../utils"),d=c.getLodash(),e=a("./NetSimNode"),f=a("./NetSimEntity"),g=a("./NetSimLogger"),h=a("./NetSimWire"),i=a("./NetSimMessage"),j=a("./NetSimHeartbeat"),k=a("./ObservableEvent"),l=new g(console,g.LogLevel.VERBOSE),m=6,n=b.exports=function(a,b){b=void 0!==b?b:{},e.call(this,a,b),this.dnsMode=void 0!==b.dnsMode?b.dnsMode:n.DnsMode.NONE,this.dnsNodeID=b.dnsNodeID,this.simulateForSender_=void 0,this.heartbeat_=null,this.stateCache_={},this.stateChange=new k,this.myWireRowCache_=[],this.wiresChange=new k};n.inherits(e);var o={NONE:"none",MANUAL:"manual",AUTOMATIC:"automatic"};n.DnsMode=o,n.create=function(a,b){f.create(n,a,function(c){return null===c?void b(null):void j.getOrCreate(a,c.entityID,function(a){return null===a?void b(null):(c.heartbeat_=a,void c.update(function(){b(c)}))})})},n.get=function(a,b,c){f.get(n,a,b,function(d){return null===d?void c(null):void j.getOrCreate(b,a,function(a){return null===a?void c(null):(d.heartbeat_=a,void c(d))})})},n.RouterStatus={INITIALIZING:"Initializing",READY:"Ready",FULL:"Full"};var p=n.RouterStatus;n.prototype.buildRow_=function(){return c.extend(n.superPrototype.buildRow_.call(this),{dnsMode:this.dnsMode,dnsNodeID:this.dnsNodeID})},n.prototype.tick=function(a){this.heartbeat_.tick(a)},n.prototype.update=function(a){a=a||function(){};var b=this;this.countConnections(function(c){b.status_=c>=m?p.FULL:p.READY,b.statusDetail_="("+c+"/"+m+")",n.superPrototype.update.call(b,a)})},n.prototype.getDisplayName=function(){return"Router "+this.entityID},n.prototype.getNodeType=function(){return n.getNodeType()},n.getNodeType=function(){return"router"},n.prototype.initializeSimulation=function(a){if(this.simulateForSender_=a,void 0!==a){var b=this.shard_.nodeTable.tableChange,c=this.onNodeTableChange_.bind(this);this.nodeChangeKey_=b.register(c),l.info("Router registered for nodeTable tableChange");var d=this.shard_.wireTable.tableChange,e=this.onWireTableChange_.bind(this);this.wireChangeKey_=d.register(e),l.info("Router registered for wireTable tableChange");var f=this.shard_.messageTable.tableChange,g=this.onMessageTableChange_.bind(this);this.newMessageEventKey_=f.register(g),l.info("Router registered for messageTable tableChange")}},n.prototype.stopSimulation=function(){if(void 0!==this.nodeChangeKey_){var a=this.shard_.messageTable.tableChange;a.unregister(this.nodeChangeKey_),this.nodeChangeKey_=void 0,l.info("Router unregistered from nodeTable tableChange")}if(void 0!==this.wireChangeKey_){var b=this.shard_.messageTable.tableChange;b.unregister(this.wireChangeKey_),this.wireChangeKey_=void 0,l.info("Router unregistered from wireTable tableChange")}if(void 0!==this.newMessageEventKey_){var c=this.shard_.messageTable.tableChange;c.unregister(this.newMessageEventKey_),this.newMessageEventKey_=void 0,l.info("Router unregistered from messageTable tableChange")}},n.prototype.getConnections=function(a){a=a||function(){};var b=this.shard_,c=this.entityID;this.shard_.wireTable.readAll(function(d){if(null===d)return void a([]);var e=d.map(function(a){return new h(b,a)
}).filter(function(a){return a.remoteNodeID===c});a(e)})},n.prototype.countConnections=function(a){a=a||function(){},this.getConnections(function(b){a(b.length)})};var q=function(a,b){return a.some(function(a){return a===b})};n.prototype.acceptConnection=function(a,b){var c=this;this.countConnections(function(a){return a>m?void b(!1):void c.update(b)})},n.prototype.requestAddress=function(a,b,c){c=c||function(){};var d=this;this.getConnections(function(e){for(var f=e.filter(function(a){return void 0!==a.localAddress}).map(function(a){return a.localAddress}),g=1;q(f,g);)g++;a.localAddress=g,a.localHostname=b,a.remoteAddress=0,a.remoteHostname=d.getHostname(),a.update(c)})},n.prototype.getAddressTable=function(){return this.myWireRowCache_.map(function(a){return{hostname:a.localHostname,address:a.localAddress,isLocal:a.localNodeID===this.simulateForSender_,isDnsNode:a.localNodeID===this.dnsNodeID}}.bind(this))},n.prototype.onNodeTableChange_=function(a){var b=d.find(a,function(a){return a.id===this.entityID}.bind(this));if(void 0===b)throw new Error("Unable to find router node in node table listing.");d.isEqual(this.stateCache_,b)||(this.stateCache_=b,l.info("Router state changed."),this.onMyStateChange_(b))},n.prototype.onMyStateChange_=function(a){this.dnsMode=a.dnsMode,this.dnsNodeID=a.dnsNodeID,this.stateChange.notifyObservers(this)},n.prototype.onWireTableChange_=function(a){var b=a.filter(function(a){return a.remoteNodeID===this.entityID}.bind(this));d.isEqual(this.myWireRowCache_,b)||(this.myWireRowCache_=b,l.info("Router wires changed."),this.wiresChange.notifyObservers())},n.prototype.onMessageTableChange_=function(a){if(this.simulateForSender_&&!this.isProcessingMessages_){var b=this,c=a.map(function(a){return new i(b.shard_,a)}).filter(function(a){return a.fromNodeID===b.simulateForSender_&&a.toNodeID===b.entityID});c.length>0&&(this.isProcessingMessages_=!0,this.getConnections(function(a){c.forEach(function(c){c.destroy(function(d){d?b.routeMessage_(c,a):l.error("Error pulling message off the wire for routing")})}),b.isProcessingMessages_=!1}))}},n.prototype.routeMessage_=function(a,b){var c=a.payload.toAddress;if(void 0===c)return void l.warn("Router encountered a malformed packet: "+JSON.stringify(a.payload));if(0===c)return void l.info("Router received: "+JSON.stringify(a.payload));var d=b.filter(function(a){return a.localAddress===c});if(0===d.length)return void l.info("Message left network: "+JSON.stringify(a.payload));var e=d[0];i.send(this.shard_,e.remoteNodeID,e.localNodeID,a.payload,function(b){l.info(b?"Message re-routed to "+e.localHostname+" (node "+e.localNodeID+")":"Dropped packet: "+JSON.stringify(a.payload))})}},{"../utils":184,"./NetSimEntity":114,"./NetSimHeartbeat":115,"./NetSimLogger":121,"./NetSimMessage":122,"./NetSimNode":123,"./NetSimWire":131,"./ObservableEvent":132}],118:[function(a,b){"use strict";a("../utils");var c=a("./NetSimClientNode"),d=a("./NetSimEntity"),e=a("./NetSimMessage"),f=a("./NetSimHeartbeat"),g=a("./NetSimLogger"),h=a("./ObservableEvent"),i=new g(console,g.LogLevel.VERBOSE),j=b.exports=function(a,b){c.call(this,a,b),this.myWire=null,this.myRouter=null,this.sentLog_=null,this.receivedLog_=null,this.heartbeat_=null,this.routerChange=new h};j.inherits(c),j.create=function(a,b){d.create(j,a,function(c){return null===c?void b(null):void f.getOrCreate(a,c.entityID,function(a){return null===a?void b(null):(c.heartbeat_=a,void b(c))})})},j.prototype.getStatus=function(){return this.status_?this.status_:"Online"},j.prototype.setDisplayName=function(a){this.displayName_=a},j.prototype.initializeSimulation=function(a,b){this.sentLog_=a,this.receivedLog_=b;var c=this.shard_.messageTable.tableChange,d=this.onMessageTableChange_.bind(this);this.newMessageEventKey_=c.register(d),i.info("Local node registered for messageTable tableChange")},j.prototype.stopSimulation=function(){if(void 0!==this.newMessageEventKey_){var a=this.shard_.messageTable.tableChange;a.unregister(this.newMessageEventKey_),this.newMessageEventKey_=void 0,i.info("Local node registered for messageTable tableChange")}},j.prototype.tick=function(a){this.heartbeat_.tick(a),this.myRouter&&this.myRouter.tick(a)},j.prototype.update=function(a,b){a||(a=function(){}),void 0===b&&(b=!0);var c=this;j.superPrototype.update.call(this,function(d){!d&&b?c.reconnect_(function(b){b||(c.status_="Offline",c.onChange.notifyObservers()),a(b)}):a(d)})},j.prototype.reconnect_=function(a){var b=this;j.create(this.shard_,function(c){return c?(b.entityID=c.entityID,void b.update(function(c){return c?void(null!==b.myWire?(b.myWire.localNodeID=b.entityID,b.myWire.update(function(b){return b?void a(!0):void a(!1)})):a(!0)):void a(!1)},!1)):void a(!1)})},j.prototype.connectToRouter=function(a,b){b||(b=function(){});var c=this;this.connectToNode(a,function(d){return d?(c.myWire=d,c.myRouter=a,c.myRouter.initializeSimulation(c.entityID),void a.requestAddress(d,c.getHostname(),function(e){return e?(c.myWire=d,c.myRouter=a,c.routerChange.notifyObservers(c.myWire,c.myRouter),c.status_="Connected to "+a.getDisplayName()+" with address "+d.localAddress,void c.update(b)):void d.destroy(function(){b(!1)})})):void b(!1)})},j.prototype.disconnectRemote=function(a){a||(a=function(){});var b=this;this.myWire.destroy(function(c){return c?(b.myWire=null,b.myRouter.update(a),b.myRouter.stopSimulation(),b.myRouter=null,void b.routerChange.notifyObservers(null,null)):void a(c)})},j.prototype.sendMessage=function(a){if(this.myWire){var b=this.myWire.localNodeID,c=this.myWire.remoteNodeID,d=this;e.send(this.shard_,b,c,a,function(b){b?(i.info("Local node sent message: "+JSON.stringify(a)),d.sentLog_&&d.sentLog_.log(JSON.stringify(a))):i.error("Failed to send message: "+JSON.stringify(a))})}},j.prototype.onMessageTableChange_=function(a){if(!this.isProcessingMessages_){var b=this,c=a.map(function(a){return new e(b.shard_,a)}).filter(function(a){return a.toNodeID===b.entityID});c.length>0&&(this.isProcessingMessages_=!0,c.forEach(function(a){a.destroy(function(c){c?b.handleMessage_(a):i.error("Error pulling message off the wire.")})}),this.isProcessingMessages_=!1)}},j.prototype.handleMessage_=function(a){this.receivedLog_&&this.receivedLog_.log(JSON.stringify(a.payload))}},{"../utils":184,"./NetSimClientNode":112,"./NetSimEntity":114,"./NetSimHeartbeat":115,"./NetSimLogger":121,"./NetSimMessage":122,"./ObservableEvent":132}],122:[function(a,b){"use strict";a("../utils");var c=a("./NetSimEntity"),d=b.exports=function(a,b){b=void 0!==b?b:{},c.call(this,a,b),this.fromNodeID=b.fromNodeID,this.toNodeID=b.toNodeID,this.payload=b.payload};d.inherits(c),d.send=function(a,b,c,e,f){var g=new d(a);g.fromNodeID=b,g.toNodeID=c,g.payload=e,g.getTable_().create(g.buildRow_(),function(a){f(void 0!==a)})},d.prototype.getTable_=function(){return this.shard_.messageTable},d.prototype.buildRow_=function(){return{fromNodeID:this.fromNodeID,toNodeID:this.toNodeID,payload:this.payload}}},{"../utils":184,"./NetSimEntity":114}],121:[function(a,b){"use strict";var c=b.exports=function(a,b){this.outputConsole_=a,this.log_=function(){},this.info=function(){},this.warn=function(){},this.error=function(){},this.initializeWithVerbosity_(void 0===b?d.VERBOSE:b)},d={NONE:0,ERROR:1,WARN:2,INFO:3,VERBOSE:4};c.LogLevel=d,c.prototype.initializeWithVerbosity_=function(a){this.log_=this.outputConsole_&&this.outputConsole_.log?this.outputConsole_.log.bind(this.outputConsole_):function(){},this.info=a>=d.INFO?this.outputConsole_&&this.outputConsole_.info?this.outputConsole_.info.bind(this.outputConsole_):this.log_:function(){},this.warn=a>=d.WARN?this.outputConsole_&&this.outputConsole_.warn?this.outputConsole_.warn.bind(this.outputConsole_):this.log_:function(){},this.error=a>=d.ERROR?this.outputConsole_&&this.outputConsole_.error?this.outputConsole_.error.bind(this.outputConsole_):this.log_:function(){}},c.prototype.log=function(a,b){switch(void 0===b&&(b=d.INFO),b){case d.ERROR:this.error(a);break;case d.WARN:this.warn(a);break;case d.INFO:this.info(a);break;default:this.log_(a)}}},{}],115:[function(a,b){"use strict";a("../utils");var c=a("./NetSimEntity"),d=5e3,e=b.exports=function(a,b){b=void 0!==b?b:{},c.call(this,a,b),this.nodeID=b.nodeID,this.time_=void 0!==b.time?b.time:0};e.inherits(c),e.create=function(a,b){c.create(e,a,b)},e.getOrCreate=function(a,b,c){a.heartbeatTable.readAll(function(d){var f=d.filter(function(a){return a.nodeID==b}).sort(function(a,b){return a.time<b.time?1:-1});f.length>0?c(new e(a,f[0])):e.create(a,function(a){a&&(a.nodeID=b),a.update(function(b){return b?void c(a):(a.destroy(),void c(null))})})})},e.prototype.getTable_=function(){return this.shard_.heartbeatTable},e.prototype.buildRow_=function(){return{nodeID:this.nodeID,time:this.time_}},e.prototype.tick=function(){Date.now()-this.time_>d&&(this.time_=Date.now(),this.update())}},{"../utils":184,"./NetSimEntity":114}],112:[function(a,b){"use strict";a("../utils");var c=a("./NetSimNode"),d=b.exports=function(a,b){c.call(this,a,b)};d.inherits(c),d.prototype.getNodeType=function(){return d.getNodeType()},d.getNodeType=function(){return"user"},d.prototype.getStatus=function(){return this.status_?this.status_:"Online"}},{"../utils":184,"./NetSimNode":123}],123:[function(a,b){"use strict";a("../utils");var c=a("./NetSimEntity"),d=a("./NetSimWire"),e=b.exports=function(a,b){b=void 0!==b?b:{},c.call(this,a,b),this.displayName_=b.name,this.status_=b.status,this.statusDetail_=b.statusDetail};e.inherits(c),e.prototype.getTable_=function(){return this.shard_.nodeTable},e.prototype.buildRow_=function(){return{type:this.getNodeType(),name:this.getDisplayName(),status:this.getStatus(),statusDetail:this.getStatusDetail()}},e.prototype.getDisplayName=function(){return this.displayName_?this.displayName_:"[New Node]"},e.prototype.getHostname=function(){return this.getDisplayName().replace(/[^\w\d]/g,"").toLowerCase()},e.prototype.getNodeType=function(){throw new Error("getNodeType method is not implemented")},e.prototype.getStatus=function(){return this.status_},e.prototype.getStatusDetail=function(){return this.statusDetail_?this.statusDetail_:""},e.prototype.connectToNode=function(a,b){b||(b=function(){});var c=this;d.create(this.shard_,function(d){return null===d?void b(null):(d.localNodeID=c.entityID,d.remoteNodeID=a.entityID,void d.update(function(e){return e?void a.acceptConnection(c,function(a){return a?void b(d):void d.destroy(function(){b(null)})}):void d.destroy(function(){b(null)})}))})},e.prototype.acceptConnection=function(a,b){b(!0)}},{"../utils":184,"./NetSimEntity":114,"./NetSimWire":131}],131:[function(a,b){"use strict";a("../utils");var c=a("./NetSimEntity"),d=b.exports=function(a,b){b=void 0!==b?b:{},c.call(this,a,b),this.localNodeID=b.localNodeID,this.remoteNodeID=b.remoteNodeID,this.localAddress=b.localAddress,this.remoteAddress=b.remoteAddress,this.localHostname=b.localHostname,this.remoteHostname=b.remoteHostname};d.inherits(c),d.create=function(a,b){c.create(d,a,b)},d.prototype.getTable_=function(){return this.shard_.wireTable},d.prototype.buildRow_=function(){return{localNodeID:this.localNodeID,remoteNodeID:this.remoteNodeID,localAddress:this.localAddress,remoteAddress:this.remoteAddress,localHostname:this.localHostname,remoteHostname:this.remoteHostname}}},{"../utils":184,"./NetSimEntity":114}],114:[function(a,b){"use strict";var c=a("./ObservableEvent"),d=b.exports=function(a,b){void 0===b&&(b={}),this.shard_=a,this.entityID=b.id,this.onChange=new c};d.create=function(a,b,c){var d=new a(b);d.getTable_().create(d.buildRow_(),function(d){c(d?new a(b,d):null)})},d.get=function(a,b,c,d){var e=new a(c);e.getTable_().read(b,function(b){d(b?new a(c,b):null)})},d.prototype.update=function(a){a=a||function(){},this.getTable_().update(this.entityID,this.buildRow_(),a)},d.prototype.destroy=function(a){a=a||function(){},this.getTable_()["delete"](this.entityID,a)},d.prototype.getTable_=function(){throw new Error("Method getTable_ is not implemented.")},d.prototype.buildRow_=function(){return{}}},{"./ObservableEvent":132}],132:[function(a,b){"use strict";var c=b.exports=function(){this.observerList_=[]};c.prototype.register=function(a){var b={toCall:a};return Object.freeze(b),this.observerList_.push(b),b},c.prototype.unregister=function(a){for(var b=0;b<this.observerList_.length;b++)if(a===this.observerList_[b])return this.observerList_.splice(b,1),!0;return!1},c.prototype.notifyObservers=function(){var a=Array.prototype.slice.call(arguments,0);this.observerList_.forEach(function(b){b.toCall.apply(void 0,a)})}},{}],111:[function(a,b){"use strict";var c=b.exports=function(){this.isReady=!1,this.whenReadyCallbacks_=[],this.id=void 0,this.name=""};c.currentUser_=null,c.getCurrentUser=function(){return c.currentUser_||(c.currentUser_=new c,$.ajax({url:"/v2/user",type:"get",dataType:"json",success:function(a){c.currentUser_.initialize(a)},error:function(){c.currentUser_.initialize({isSignedIn:!1})}})),c.currentUser_},c.prototype.initialize=function(a){this.id=a.id,this.name=a.name,this.isSignedIn=a.isSignedIn!==!1,this.isReady=!0,this.whenReadyCallbacks_.forEach(function(a){a(this)}.bind(this)),this.whenReadyCallbacks_=[]},c.prototype.whenReady=function(a){this.isReady?a(this):this.whenReadyCallbacks_.push(a)}},{}],16:[function(a,b){"use strict";a("./utils");var c=b.exports,d=function(a){this.apiBaseUrl_=a};d.prototype.get=function(a,b,c){$.ajax({url:this.apiBaseUrl_+a,type:"get",dataType:"json"}).done(function(a){b(a)}).fail(function(){b(c)})},d.prototype.post=function(a,b,c){$.ajax({url:this.apiBaseUrl_+a,type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(b)}).done(function(){c(!0)}).fail(function(){c(!1)})},d.prototype.postToGet=function(a,b,c,d){$.ajax({url:this.apiBaseUrl_+a,type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(b)}).done(function(a){c(a)}).fail(function(){c(d)})},d.prototype["delete"]=function(a,b){$.ajax({url:this.apiBaseUrl_+a,type:"delete"}).done(function(){b(!0)}).fail(function(){b(!1)})},c.AppsTable=function(){this.requestHelper_=new d("/v3/apps")},c.AppsTable.prototype.readAll=function(a){this.requestHelper_.get("",a,null)},c.AppsTable.prototype.read=function(a,b){this.requestHelper_.get("/"+a,b,void 0)},c.AppsTable.prototype.create=function(a,b){this.requestHelper_.postToGet("",a,b,void 0)},c.AppsTable.prototype.update=function(a,b,c){this.requestHelper_.post("/"+a,b,c)},c.AppsTable.prototype["delete"]=function(a,b){this.requestHelper_["delete"]("/"+a,b)},c.SharedTable=function(a,b){c.AppsTable.call(this),this.requestHelper_=new d("/v3/apps/"+a+"/shared-tables/"+b)},c.SharedTable.inherits(c.AppsTable),c.UserTable=function(a,b){c.AppsTable.call(this),this.requestHelper_=new d("/v3/apps/"+a+"/user-tables/"+b)},c.UserTable.inherits(c.AppsTable),c.PropertyBag=function(a){this.requestHelper_=new d("/v3/apps"+a+"/shared-properties")},c.PropertyBag.prototype.readAll=function(a){this.requestHelper_.get("",a,null)},c.PropertyBag.prototype.read=function(a,b){this.requestHelper_.get("/"+a,b,void 0)},c.PropertyBag.prototype.set=function(a,b,c){this.requestHelper_.post("/"+a,b,c)},c.PropertyBag.prototype["delete"]=function(a,b){this.requestHelper_["delete"]("/"+a,b)},c.UserPropertyBag=function(a){c.PropertyBag.call(this,a),this.requestHelper_=new d("/v3/apps/"+a+"/user-properties")},c.UserPropertyBag.inherits(c.PropertyBag)},{"./utils":184}]},{},[136]);