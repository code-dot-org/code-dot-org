<<<<<<< HEAD
require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({154:[function(a){(function(b){var c=a("../appMain");window.Studio=a("./studio"),"undefined"!=typeof b&&(b.Studio=window.Studio);var d=a("./blocks"),e=a("./levels"),f=a("./skins");window.studioMain=function(a){a.skinsModule=f,a.blocksModule=d,c(window.Studio,e,a)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../appMain":3,"./blocks":148,"./levels":153,"./skins":156,"./studio":157}],157:[function(a,b){"use strict";function c(){switch(N.map=O.map,N.timeoutFailureTick=O.timeoutFailureTick||1/0,N.minWorkspaceHeight=O.minWorkspaceHeight,N.softButtons_=O.softButtons||{},N.protagonistSpriteIndex=O.protagonistSpriteIndex||O.protaganistSpriteIndex,O.customGameType){case"Big Game":N.customLogic=new A(N);break;case"SamTheButterfly":}N.startAvatars=O.avatarList?O.avatarList.slice():d(P.avatarList,O.firstSpriteIndex);for(var a in O.scale)N.scale[a]=O.scale[a];N.ROWS=N.map.length,N.COLS=N.map[0].length,N.SQUARE_SIZE=50,N.MARKER_HEIGHT=100,N.MARKER_WIDTH=100,N.MAZE_WIDTH=N.SQUARE_SIZE*N.COLS,N.MAZE_HEIGHT=N.SQUARE_SIZE*N.ROWS,p.MAZE_WIDTH=N.MAZE_WIDTH,p.MAZE_HEIGHT=N.MAZE_HEIGHT}function d(a,b){return b=b||0,D.flatten([a.slice(b),a.slice(0,b)])}function e(a,b,c,d,e,f){return Math.abs(a-b)<=c&&Math.abs(d-e)<=f}function f(a,b){N.eventHandlers.forEach(function(c){if(p.isUsingBlockly()){if(c.name===a&&(b||0===c.cmdQueue.length)){N.currentCmdQueue=c.cmdQueue;try{c.func(p,u,N.Globals)}catch(d){}N.currentCmdQueue=null}}else c.name===a&&N.eventQueue.push({fn:c.func})})}function g(){for(var a=function(a,b,c){var d=c?N.sprite[a].height:N.sprite[a].width,e=c?N.sprite[b].height:N.sprite[b].width;return r.SPRITE_COLLIDE_DISTANCE_SCALING*(d+e)/2},b=function(a,b,c){var d=c?N.sprite[a].height:N.sprite[a].width,e=c?N.projectiles[b].height:N.projectiles[b].width;return r.SPRITE_COLLIDE_DISTANCE_SCALING*(d+e)/2},c=function(a,b,c){var d,e=c?N.sprite[a].height:N.sprite[a].width;return d="left"===b||"right"===b?c?N.MAZE_HEIGHT:0:c?0:N.MAZE_WIDTH,(e+d)/2},d=0;d<N.spriteCount;d++){var f=N.sprite[d];if(f.visible){for(var g=f.width/2,h=f.height/2,i=ub(d,!1,!1)+g,j=ub(d,!0,!1)+h,k=0;k<N.spriteCount;k++)if(d!=k&&N.sprite[k].visible){var l=ub(k,!1,!1)+N.sprite[k].width/2,o=ub(k,!0,!1)+N.sprite[k].height/2;e(i,l,a(d,k,!1),j,o,a(d,k,!0))?N.collideSpriteWith(d,k):f.endCollision(k),n(d,k)}for(k=0;k<N.projectiles.length;k++){var p=N.projectiles[k],q=p.getNextPosition();e(i,q.x,b(d,k,!1),j,q.y,b(d,k,!0))?p.startCollision(d)&&(N.currentEventParams={projectile:p},m(d,p.className,!0),N.currentEventParams=null):p.endCollision(d)}for(k=0;k<U.length&&O.edgeCollisions;k++){var s,t,u=U[k];switch(u){case"top":s=N.MAZE_WIDTH/2,t=0;break;case"left":s=0,t=N.MAZE_HEIGHT/2;break;case"bottom":s=N.MAZE_WIDTH/2,t=N.MAZE_HEIGHT;break;case"right":s=N.MAZE_WIDTH,t=N.MAZE_HEIGHT/2}e(i,s,c(d,u,!1),j,t,c(d,u,!0))?N.collideSpriteWith(d,u):f.endCollision(u)}for(k=0;k<U.length;k++)n(d,U[k]);for(k=0;k<T.length;k++)n(d,T[k])}}}function h(a,b){var c=N.sprite[a],d=0,e=new Date,f=e-N.startTime;return b&&b.walkDirection?Lb[c.displayDir]:b&&b.walkFrame&&c.timePerFrame?Math.floor(f/c.timePerFrame)%c.frameCounts.walk:8===c.frameCounts.turns&&c.displayDir!==F.SOUTH?c.frameCounts.normal+c.frameCounts.animation+1+Kb[c.displayDir]:7===c.frameCounts.turns&&c.displayDir!==F.SOUTH?c.frameCounts.normal+c.frameCounts.animation+Kb[c.displayDir]:(1===c.frameCounts.animation&&N.tickCount&&1===Math.round((N.tickCount+a*Nb)/Mb)%Ob&&(d=c.frameCounts.normal),c.frameCounts.normal>1&&c.timePerFrame&&(d=Math.floor(f/c.timePerFrame)%c.frameCounts.normal),!d&&c.emotion!==I.NORMAL&&c.frameCounts.emotions>0&&(d=c.frameCounts.normal+c.frameCounts.animation+c.frameCounts.turns+(c.emotion-1)),d)}function i(a){var b=N.sprite[a];return b.frameCounts.normal+b.frameCounts.animation+b.frameCounts.turns+b.frameCounts.emotions}function j(a){return/^\d*$/.test(a)}function k(a){return-1!==U.indexOf(a)}function l(a){return-1!==T.indexOf(a)}function m(a,b,c){var d="whenSpriteCollided-"+a+"-";f(d+b,c),f(d+"anything",c),j(b)?f(d+"any_actor",c):k(b)?f(d+"any_edge",c):l(b)&&f(d+"any_projectile",c)}function n(a,b){var c="whenSpriteCollided-"+a+"-";N.executeQueue(c+b),N.executeQueue(c+"any_actor"),N.executeQueue(c+"anything"),k(b)?N.executeQueue(c+"any_edge"):l(b)&&N.executeQueue(c+"any_projectile")}function o(a,b){var c=function(b){var c=b?a.height:a.width,d=b?N.MARKER_HEIGHT:N.MARKER_WIDTH;return r.FINISH_COLLIDE_DISTANCE_SCALING*(c+d)/2},d=a.x+a.width/2,f=a.y+a.height/2,g=b.x+N.MARKER_WIDTH/2,h=b.y+N.MARKER_HEIGHT/2;return e(d,g,c(!1),f,h,c(!0))}var p=a("../StudioApp").singleton,q=(a("../../locale/current/common"),a("../../locale/current/studio")),r=(a("../skins"),a("./constants")),s=a("../constants"),t=a("../codegen"),u=a("./api"),v=a("./blocks"),w=a("../templates/page.html"),x=a("../dom"),y=a("./collidable"),z=a("./projectile"),A=a("./bigGameLogic"),B=a("../xml").parseElement,C=a("../utils"),D=C.getLodash(),E=C.getHammer();if("undefined"!=typeof SVGElement){a("../canvg/rgbcolor.js"),a("../canvg/StackBlur.js"),a("../canvg/canvg.js"),a("../canvg/svg_todataurl")}var F=r.Direction,G=r.NextTurn,H=r.SquareType,I=r.Emotions,J=s.KeyCodes,K=p.ResultType,L=p.TestResults,M="http://www.w3.org/2000/svg",N=b.exports;N.keyState={},N.gesturesObserved={},N.btnState={};var O,P,Q={UP:0,DOWN:1},R={LEFT:"leftButton",UP:"upButton",RIGHT:"rightButton",DOWN:"downButton"},S=25,T=["blue_fireball","purple_fireball","red_fireball","purple_hearts","red_hearts","yellow_hearts"],U=["top","left","bottom","right"];p.setCheckForEmptyBlocks(!0),N.BLOCK_X_COORDINATE=20,N.BLOCK_Y_COORDINATE=20;var V=200;N.scale={snapRadius:1,stepSpeed:33};var W=5e3,X=60,Y=100,Z=20,$=24,_=7,ab=5,bb=15,cb=360,db=ab+bb+_*$,eb=20,fb=50,gb=5,hb=10,ib=20,jb=4,kb=5,lb=180,mb=20+jb*ib,nb=60,ob=500,pb={text:q.shareStudioTwitter(),hashtag:"StudioCode"},qb=function(){var a,b=document.getElementById("svgStudio");b.setAttribute("width",N.MAZE_WIDTH),b.setAttribute("height",N.MAZE_HEIGHT);var c=new E(b);c.on("tap",N.onSvgClicked),c.on("drag",N.onSvgDrag);var d=document.getElementById("visualizationColumn");if(d.style.width=N.MAZE_WIDTH+"px",P.background){var e=document.createElementNS(M,"image");e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P.background),e.setAttribute("id","background"),e.setAttribute("height",N.MAZE_HEIGHT),e.setAttribute("width",N.MAZE_WIDTH),e.setAttribute("x",0),e.setAttribute("y",0),b.appendChild(e)}if(N.spriteStart_){for(a=0;a<N.spriteCount;a++){var f=document.createElementNS(M,"clipPath");f.setAttribute("id","spriteClipPath"+a);var g=document.createElementNS(M,"rect");g.setAttribute("id","spriteClipRect"+a),f.appendChild(g),b.appendChild(f);var h=document.createElementNS(M,"image");h.setAttribute("id","sprite"+a),h.setAttribute("clip-path","url(#spriteClipPath"+a+")"),b.appendChild(h);var i=document.createElementNS(M,"image");i.setAttribute("id","spriteWalk"+a),i.setAttribute("clip-path","url(#spriteWalkClipPath"+a+")"),b.appendChild(i);var j=document.createElementNS(M,"clipPath");j.setAttribute("id","spriteWalkClipPath"+a);var k=document.createElementNS(M,"rect");k.setAttribute("id","spriteWalkClipRect"+a),j.appendChild(k),b.appendChild(j),x.addMouseDownTouchEvent(h,rb(this,N.onSpriteClicked,a))}for(a=0;a<N.spriteCount;a++){var l=document.createElementNS(M,"g");l.setAttribute("id","speechBubble"+a),l.setAttribute("visibility","hidden");var m=document.createElementNS(M,"path");m.setAttribute("id","speechBubblePath"+a),m.setAttribute("class","studio-speech-bubble-path");var n=document.createElementNS(M,"text");n.setAttribute("id","speechBubbleText"+a),n.setAttribute("class","studio-speech-bubble"),l.appendChild(m),l.appendChild(n),b.appendChild(l)}}if(N.spriteGoals_)for(a=0;a<N.spriteGoals_.length;a++){var o=document.createElementNS(M,"clipPath");o.setAttribute("id","finishClipPath"+a);var p=document.createElementNS(M,"rect");p.setAttribute("id","finishClipRect"+a),p.setAttribute("width",N.MARKER_WIDTH),p.setAttribute("height",N.MARKER_HEIGHT),o.appendChild(p),b.appendChild(o);var q=document.createElementNS(M,"image");q.setAttribute("id","spriteFinish"+a),q.setAttribute("height",N.MARKER_HEIGHT),q.setAttribute("width",O.goalOverride&&O.goalOverride.imageWidth||N.MARKER_WIDTH),q.setAttribute("clip-path","url(#finishClipPath"+a+")"),b.appendChild(q)}var r=document.createElementNS(M,"text");r.setAttribute("id","score"),r.setAttribute("class","studio-score"),r.setAttribute("x",N.MAZE_WIDTH/2),r.setAttribute("y",nb),r.appendChild(document.createTextNode("")),r.setAttribute("visibility","hidden"),b.appendChild(r);var s=document.createElementNS(M,"text");s.setAttribute("id","titleScreenTitle"),s.setAttribute("class","studio-ts-title"),s.setAttribute("x",N.MAZE_WIDTH/2),s.setAttribute("y",X),s.appendChild(document.createTextNode("")),s.setAttribute("visibility","hidden"),b.appendChild(s);var t=document.createElementNS(M,"g"),u=(N.MAZE_WIDTH-cb)/2;t.setAttribute("id","titleScreenTextGroup"),t.setAttribute("x",u),t.setAttribute("y",Y),t.setAttribute("transform","translate("+u+","+Y+")"),t.setAttribute("visibility","hidden");var v=document.createElementNS(M,"rect");v.setAttribute("id","titleScreenTextRect"),v.setAttribute("x",0),v.setAttribute("y",0),v.setAttribute("width",cb),v.setAttribute("class","studio-ts-text-rect");var w=document.createElementNS(M,"text");w.setAttribute("id","titleScreenText"),w.setAttribute("class","studio-ts-text"),w.setAttribute("x",cb/2),w.setAttribute("y",0),w.appendChild(document.createTextNode("")),t.appendChild(v),t.appendChild(w),b.appendChild(t)},rb=function(a,b,c){return function(){var d=Array.prototype.slice.apply(arguments).concat(c);b.apply(a,d)}},sb=function(a,b,c){var d=0;return N.eventHandlers.forEach(function(e){var f=e.cmdQueue[0];if(f&&"moveDistance"===f.name&&f.opts.spriteIndex===a){var g,h=Math.min(f.opts.queuedDistance,N.sprite[f.opts.spriteIndex].speed);switch(f.opts.dir){case F.NORTH:g=b?-1:0;break;case F.WEST:g=b?0:-1;break;case F.SOUTH:g=b?1:0;break;case F.EAST:g=b?0:1}c&&0!==g&&(f.opts.queuedDistance-=h,"0.00"===Math.abs(f.opts.queuedDistance).toFixed(2)&&(f.opts.queuedDistance=0)),d+=h*g}}),d},tb=function(a,b){N.eventHandlers.forEach(function(c){var d=c.cmdQueue[0];if(d&&"moveDistance"===d.name&&d.opts.spriteIndex===a){var e=d.opts.dir;!b||e!==F.NORTH&&e!==F.SOUTH?b||e!==F.EAST&&e!==F.WEST||(d.opts.queuedDistance=0):d.opts.queuedDistance=0}})},ub=function(a,b,c){var d=b?N.sprite[a].y:N.sprite[a].x;return d+sb(a,b,c)},vb=function(a){var b=N.sprite[a],c=b.x,d=b.y,e=ub(a,!1,!0),f=ub(a,!0,!0);if(O.allowSpritesOutsidePlayspace)b.x=e,b.y=f;else{var g=Math.min(N.MAZE_WIDTH-b.width,Math.max(0,e));e!=g&&tb(a,!1),b.x=g;var h=Math.min(N.MAZE_HEIGHT-b.height,Math.max(0,f));f!=h&&tb(a,!0),b.y=h}(c!==b.x||d!==b.y)&&(b.lastMove=N.tickCount)},wb=function(a){for(;a.svgText.firstChild;)a.svgText.removeChild(a.svgText.firstChild);var b=a.text.toString().split(" "),c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttribute("x",a.width/2),c.setAttribute("dy",a.lineHeight+a.topMargin);var d=document.createTextNode(b[0]);c.appendChild(d),a.svgText.appendChild(c);for(var e=1,f=1;f<b.length;f++){var g=c.firstChild.data.length;if(c.firstChild.data+=" "+b[f],c.getComputedTextLength&&c.getComputedTextLength()>a.width-2*a.sideMargin){if(c.firstChild.data=c.firstChild.data.slice(0,g),a.maxLines===e)return a.fullHeight;c=document.createElementNS("http://www.w3.org/2000/svg","tspan"),c.setAttribute("x",a.width/2),c.setAttribute("dy",a.lineHeight),d=document.createTextNode(b[f]),c.appendChild(d),a.svgText.appendChild(c),e++}}var h=a.maxLines-Math.max(1,e);return a.fullHeight-h*a.lineHeight};N.onTick=function(){if(N.tickCount++,N.customLogic&&N.customLogic.onTick(),N.interpreter)for(var a=!1,b=0;V>b&&!a;b++){var c=t.selectCurrentCode(N.interpreter,N.cumulativeLength,N.userCodeStartOffset,N.userCodeLength,p.editor);try{N.interpreter.step(),a=-1!==c&&N.interpreter.stateStack[0]&&N.interpreter.stateStack[0].done}catch(d){return N.executionError=d,void N.onPuzzleComplete()}}else 1===N.tickCount&&f("whenGameStarts"),N.executeQueue("whenGameStarts");f("repeatForever"),N.executeQueue("repeatForever");for(var e=0;e<N.spriteCount;e++)N.executeQueue("whenSpriteClicked-"+e);for(var h in J)if(N.keyState[J[h]]&&"keydown"===N.keyState[J[h]])switch(J[h]){case J.LEFT:f("when-left");break;case J.UP:f("when-up");break;case J.RIGHT:f("when-right");break;case J.DOWN:f("when-down")}for(var i in R)if(N.btnState[R[i]]&&N.btnState[R[i]]===Q.DOWN)switch(R[i]){case R.LEFT:f("when-left");break;case R.UP:f("when-up");break;case R.RIGHT:f("when-right");break;case R.DOWN:f("when-down")}for(var j in N.gesturesObserved){switch(j){case"left":f("when-left");break;case"up":f("when-up");break;case"right":f("when-right");break;case"down":f("when-down")}0===N.gesturesObserved[j]--&&delete N.gesturesObserved[j]}for(N.executeQueue("when-left"),N.executeQueue("when-up"),N.executeQueue("when-right"),N.executeQueue("when-down"),g(),e=0;e<N.spriteCount;e++){vb(e);var k=!0;(1/0===N.sprite[e].lastMove||N.tickCount-N.sprite[e].lastMove>Pb)&&(N.sprite[e].dir=F.SOUTH,k=!1),N.displaySprite(e,k)}for(e=0;e<N.projectiles.length;e++)N.projectiles[e].moveToNextPosition(),N.projectiles[e].outOfBounds()?(N.projectiles[e].removeElement(),N.projectiles.splice(e,1),e--):N.projectiles[e].display();$b()&&N.onPuzzleComplete()},N.onSvgDrag=function(a){N.tickCount>0&&(N.gesturesObserved[a.gesture.direction]=Math.round(a.gesture.distance/S),a.gesture.preventDefault())},N.onKey=function(a){N.keyState[a.keyCode]=a.type,N.tickCount>0&&a.keyCode>=J.LEFT&&a.keyCode<=J.DOWN&&a.preventDefault()},N.onArrowButtonDown=function(a,b){N.btnState[b]=Q.DOWN,a.preventDefault()},N.onSpriteClicked=function(a,b){N.tickCount>0&&f("whenSpriteClicked-"+b),a.preventDefault()},N.onSvgClicked=function(a){N.tickCount>0&&N.eventHandlers.forEach(function(a){var b=a.cmdQueue[0];b&&b.opts.waitForClick&&!b.opts.complete&&(b.opts.waitCallback&&b.opts.waitCallback(),b.opts.complete=!0)}),a.preventDefault()},N.onArrowButtonUp=function(a,b){N.btnState[b]=Q.UP},N.onMouseUp=function(){N.btnState={}},N.initSprites=function(){N.spriteCount=0,N.sprite=[],N.projectiles=[],N.startTime=null,N.spriteGoals_=[];for(var a=0;a<N.ROWS;a++)for(var b=0;b<N.COLS;b++)N.map[a][b]&H.SPRITEFINISH?N.spriteGoals_.push({x:b*N.SQUARE_SIZE,y:a*N.SQUARE_SIZE,finished:!1}):N.map[a][b]&H.SPRITESTART&&(0===N.spriteCount&&(N.spriteStart_=[]),N.spriteStart_[N.spriteCount]={x:b*N.SQUARE_SIZE,y:a*N.SQUARE_SIZE},N.spriteCount++);p.isUsingBlockly()&&(v.setSpriteCount(Blockly,N.spriteCount),v.setStartAvatars(N.startAvatars),O.projectileCollisions&&v.enableProjectileCollisions(Blockly),O.edgeCollisions&&v.enableEdgeCollisions(Blockly),O.allowSpritesOutsidePlayspace&&v.enableSpritesOutsidePlayspace(Blockly))},N.initReadonly=function(a){P=a.skin,O=a.level,c(),N.initSprites(),p.initReadonly(a)};var xb=function(a){for(var b,c=B(a.level.startBlocks),d=0,e=p.sortBlocksByVisibility(c.childNodes),f=0;e&&f<e.length;f++)b=e[f],1!==b.nodeType||b.getAttribute("y")||d++;if(d){var g=0,h=(a.level.minWorkspaceHeight||800)-N.BLOCK_Y_COORDINATE,i=h/d;for(f=0,b;e&&f<e.length;f++)b=e[f],1!==b.nodeType||b.getAttribute("y")||(b.setAttribute("x",b.getAttribute("x")||N.BLOCK_X_COORDINATE),b.setAttribute("y",N.BLOCK_Y_COORDINATE+i*g),g+=1);a.level.startBlocks=Blockly.Xml.domToText(c)}};N.init=function(b){N.clearEventHandlersKillTickLoop(),P=b.skin,O=b.level,c(),window.addEventListener("keydown",N.onKey,!1),window.addEventListener("keyup",N.onKey,!1);var d=D.isEmpty(O.softButtons),e=a("./controls.html")({assetUrl:p.assetUrl,finishButton:d}),f=a("./extraControlRows.html")({assetUrl:p.assetUrl,finishButton:!d});b.html=w({assetUrl:p.assetUrl,data:{localeDirection:p.localeDirection(),visualization:a("./visualization.html")(),controls:e,extraControlRows:f,blockUsed:void 0,idealBlockNumber:void 0,editCode:O.editCode,blockCounterClass:"block-counter-default"}}),b.loadAudio=function(){p.loadAudio(P.winSound,"win"),p.loadAudio(P.startSound,"start"),p.loadAudio(P.failureSound,"failure"),p.loadAudio(P.rubberSound,"rubber"),p.loadAudio(P.crunchSound,"crunch"),p.loadAudio(P.flagSound,"flag"),p.loadAudio(P.winPointSound,"winpoint"),p.loadAudio(P.winPoint2Sound,"winpoint2"),p.loadAudio(P.losePointSound,"losepoint"),p.loadAudio(P.losePoint2Sound,"losepoint2"),p.loadAudio(P.goal1Sound,"goal1"),p.loadAudio(P.goal2Sound,"goal2"),p.loadAudio(P.woodSound,"wood"),p.loadAudio(P.retroSound,"retro"),p.loadAudio(P.slapSound,"slap"),p.loadAudio(P.hitSound,"hit")},b.afterInject=function(){for(var a in R)x.addClickTouchEvent(document.getElementById(R[a]),rb(this,N.onArrowButtonUp,R[a])),x.addMouseDownTouchEvent(document.getElementById(R[a]),rb(this,N.onArrowButtonDown,R[a]));document.addEventListener("mouseup",N.onMouseUp,!1),p.isUsingBlockly()&&(Blockly.HSV_SATURATION=.6,Blockly.SNAP_RADIUS*=N.scale.snapRadius),qb()},p.isUsingBlockly()&&"toolbox_blocks"!=b.level.edit_blocks&&xb(b),b.twitter=pb,b.makeYourOwn=b.share,b.makeString=q.makeYourOwn(),b.makeUrl="http://code.org/studio",b.makeImage=p.assetUrl("media/promo.png"),b.enableShowCode=!1,b.varsInGlobals=!0,b.generateFunctionPassBlocks=!!b.level.generateFunctionPassBlocks,N.initSprites(),p.init(b);var g=document.getElementById("finishButton");x.addClickTouchEvent(g,N.onPuzzleComplete),b.skin.preloadAssets&&(Bb(),Ab(),zb())};var yb=function(a){var b=new Image;b.src=a},zb=function(){if(p.isUsingBlockly())for(var a=P.backgroundChoicesK1,b=0;b<a.length;b++)yb(a[b][0])},Ab=function(){for(var a=0;a<T.length;a++)yb(P[T[a]])},Bb=function(){for(var a=0;a<P.avatarList.length;a++)yb(P[P.avatarList[a]].sprite)};N.clearEventHandlersKillTickLoop=function(){N.eventHandlers&&N.eventHandlers.forEach(function(a){var b=a.cmdQueue[0];b&&b.opts.waitTimeout&&!b.opts.complete&&window.clearTimeout(b.opts.waitTimeout)}),N.eventHandlers=[],N.perExecutionTimeouts&&N.perExecutionTimeouts.forEach(function(a){clearInterval(a)}),N.perExecutionTimeouts=[],N.tickCount=0;for(var a=0;a<N.spriteCount;a++)N.sprite[a]&&N.sprite[a].bubbleTimeout&&window.clearTimeout(N.sprite[a].bubbleTimeout);if(N.projectiles){for(a=0;a<N.projectiles.length;a++)N.projectiles[a].removeElement();N.projectiles=[]}},p.reset=function(){var a;N.clearEventHandlersKillTickLoop();var b=0;for(a=0;a<N.softButtons_.length;a++)document.getElementById(N.softButtons_[a]).style.display="inline",b++;if(b){var c=document.getElementById("soft-buttons");c.className="soft-buttons-"+b}for(;N.projectiles.length;){var d=N.projectiles.pop();d.removeElement()}for(N.playerScore=0,N.scoreText=null,document.getElementById("score").setAttribute("visibility","hidden"),document.getElementById("titleScreenTitle").setAttribute("visibility","hidden"),document.getElementById("titleScreenTextGroup").setAttribute("visibility","hidden"),N.setBackground(O.coordinateGridBackground?{value:"grid"}:{value:O.background||P.defaultBackground}),N.gesturesObserved={},N.currentCmdQueue=null,N.sayComplete=0,N.playSoundCount=0,O.goal&&(O.goal.successState={}),N.Globals={},p.editCode&&(N.eventQueue=[],N.executionError=null,N.interpreter=null),a=0;a<N.spriteCount;a++){N.sprite[a]=new y({x:N.spriteStart_[a].x,y:N.spriteStart_[a].y,speed:r.DEFAULT_SPRITE_SPEED,size:r.DEFAULT_SPRITE_SIZE,dir:F.NONE,displayDir:F.SOUTH,emotion:O.defaultEmotion||I.NORMAL,lastMove:1/0,visible:!O.spritesHiddenToStart});var e={spriteIndex:a,value:N.startAvatars[a%N.startAvatars.length],forceHidden:O.spritesHiddenToStart};N.setSprite(e),N.displaySprite(a),document.getElementById("speechBubble"+a).setAttribute("visibility","hidden"),document.getElementById("sprite"+a).removeAttribute("opacity");var f=document.getElementById("explosion"+a);f&&f.setAttribute("visibility","hidden")}var g=(document.getElementById("svgStudio"),P.goal);for(O.goalOverride&&O.goalOverride.goal&&(g=P[O.goalOverride.goal]),a=0;a<N.spriteGoals_.length;a++){N.spriteGoals_[a].finished=!1;var h=document.getElementById("spriteFinish"+a);h.setAttribute("x",N.spriteGoals_[a].x),h.setAttribute("y",N.spriteGoals_[a].y),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);var i=document.getElementById("finishClipRect"+a);i.setAttribute("x",N.spriteGoals_[a].x),i.setAttribute("y",N.spriteGoals_[a].y)}N.levelRestarted=!0},p.runButtonClick=function(){var a=document.getElementById("runButton"),b=document.getElementById("resetButton");if(b.style.minWidth||(b.style.minWidth=a.offsetWidth+"px"),p.toggleRunReset("reset"),p.isUsingBlockly()&&Blockly.mainBlockSpace.traceOn(!0),p.reset(!1),p.attempts++,N.startTime=new Date,N.execute(),O.freePlay&&(!p.hideSource||O.showFinish)){var c=document.getElementById("share-cell");c.className="share-cell-enabled"}O.showZeroScore&&N.displayScore()};var Cb=function(){N.waitingForReport||p.displayFeedback({app:"studio",skin:P.id,feedbackType:N.testResults,response:N.response,level:O,showingSharing:!O.disableSharing&&O.freePlay,feedbackImage:N.feedbackImage,twitter:pb,saveToGalleryUrl:O.freePlay&&N.response&&N.response.save_to_gallery_url,appStrings:{reinfFeedbackMsg:q.reinfFeedbackMsg(),sharingText:q.shareGame()}})};N.onReportComplete=function(a){N.response=a,N.waitingForReport=!1,Cb()};var Db=function(a,b,c){a.push({name:b,func:c,cmdQueue:[]})},Eb=function(a,b,c,d,e,f,g){for(var h=Blockly.mainBlockSpace.getTopBlocks(),i=0;h[i];i++){var j=h[i],k=j.getTitleValue(d)||"0",l=j.getTitleValue(f)||"0";if(!(j.type!==b||d&&e!==k||f&&g!==l)){var m=Blockly.Generator.blocksToCode("JavaScript",[j]);if(m){var n=t.functionFromCode(m,{StudioApp:p,Studio:u,Globals:N.Globals}),o=c;d&&(o+="-"+e),f&&(o+="-"+g),Db(a,o,n)}}}},Fb=function(a,b,c,d){for(var e=0;e<N.spriteCount;e++)Eb(a,b,c,d,String(e))},Gb=function(a,b,c,d,e){for(var f=0;f<e.length;f++)Eb(a,b,c,d,e[f])},Hb=function(a,b,c,d,e){var f,g=function(g){Eb(a,b,c,d,String(f),e,g)};for(f=0;f<N.spriteCount;f++){for(var h=0;h<N.spriteCount;h++)f!==h&&Eb(a,b,c,d,String(f),e,String(h));T.forEach(g),U.forEach(g),Eb(a,b,c,d,String(f),e,"any_actor"),Eb(a,b,c,d,String(f),e,"any_edge"),Eb(a,b,c,d,String(f),e,"any_projectile"),Eb(a,b,c,d,String(f),e,"anything")}},Ib=function(a){var b=Blockly.Generator.blockSpaceToCode("JavaScript",a);try{t.evalWith(b,{StudioApp:p,Studio:u,Globals:N.Globals})}catch(c){}},Jb=function(){return N.eventQueue.shift()};N.execute=function(){var a;N.result=p.UNSET,N.testResults=L.NO_TESTS_RUN,N.waitingForReport=!1,N.response=null;O.editCode&&(a=C.generateCodeAliases(O.codeFunctions,null,"Studio"),a+=p.editor.getValue());var b=[];if(p.isUsingBlockly()&&(Eb(b,"when_run","whenGameStarts"),Eb(b,"functional_start_setBackground","whenGameStarts"),Eb(b,"functional_start_setSpeeds","whenGameStarts"),Eb(b,"functional_start_setBackgroundAndSpeeds","whenGameStarts"),Eb(b,"functional_start_setFuncs","whenGameStarts"),Eb(b,"studio_whenLeft","when-left"),Eb(b,"studio_whenRight","when-right"),Eb(b,"studio_whenUp","when-up"),Eb(b,"studio_whenDown","when-down"),Gb(b,"studio_whenArrow","when","VALUE",["left","right","up","down"]),Eb(b,"studio_repeatForever","repeatForever"),Fb(b,"studio_whenSpriteClicked","whenSpriteClicked","SPRITE"),Hb(b,"studio_whenSpriteCollided","whenSpriteCollided","SPRITE1","SPRITE2")),p.playAudio("start"),p.reset(!1),O.editCode){var c=C.generateCodeAliases(O.codeFunctions,null,"Studio");N.userCodeStartOffset=c.length,c+=p.editor.getValue(),N.userCodeLength=c.length-N.userCodeStartOffset,c+="\nwhile (true) { var obj = getCallback(); if (obj) { obj.fn.apply(null, obj.arguments ? obj.arguments : null); }}";var d=p.editor.aceEditor.getSession();N.cumulativeLength=t.aceCalculateCumulativeLength(d);var e=function(a,b){t.initJSInterpreter(a,b,{StudioApp:p,Studio:u,Globals:N.Globals});var c=(a.createObject(a.FUNCTION),t.makeNativeMemberFunction(a,Jb,null));a.setProperty(b,"getCallback",a.createNativeFunction(c))};N.interpreter=new window.Interpreter(c,e)}else Ib("procedures_defreturn"),Ib("procedures_defnoreturn"),Ib("functional_definition"),N.eventHandlers=b;N.perExecutionTimeouts=[],N.perExecutionTimeouts.push(window.setInterval(N.onTick,N.scale.stepSpeed))},N.feedbackImage="",N.encodedFeedbackImage="",N.onPuzzleComplete=function(){N.executionError?N.result=K.ERROR:O.freePlay&&(N.result=K.SUCCESS),N.clearEventHandlersKillTickLoop();var a=N.result===K.SUCCESS;N.testResults=O.freePlay?L.FREE_PLAY:p.getTestResults(a),p.playAudio(N.testResults>=L.TOO_MANY_BLOCKS_FAIL?"win":"failure");var b;if(O.editCode)b=p.editor.getValue();else{var c=Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace);b=Blockly.Xml.domToText(c)}N.waitingForReport=!0;var d=function(){p.report({app:"studio",level:O.id,result:N.result===K.SUCCESS,testResult:N.testResults,program:encodeURIComponent(b),image:N.encodedFeedbackImage,onComplete:N.onReportComplete})};"undefined"==typeof document.getElementById("svgStudio").toDataURL?d():document.getElementById("svgStudio").toDataURL("image/png",{callback:function(a){N.feedbackImage=a,N.encodedFeedbackImage=encodeURIComponent(N.feedbackImage.split(",")[1]),d()}})};var Kb={};Kb[F.SOUTHEAST]=0,Kb[F.EAST]=1,Kb[F.NORTHEAST]=2,Kb[F.NORTH]=3,Kb[F.NORTHWEST]=4,Kb[F.WEST]=5,Kb[F.SOUTHWEST]=6;var Lb={};Lb[F.SOUTH]=0,Lb[F.SOUTHEAST]=1,Lb[F.EAST]=2,Lb[F.NORTHEAST]=3,Lb[F.NORTH]=4,Lb[F.NORTHWEST]=5,Lb[F.WEST]=6,Lb[F.SOUTHWEST]=7;var Mb=6,Nb=7,Ob=8,Pb=5,Qb=function(a){var b=+a.getAttribute("height"),c="true"===a.getAttribute("onTop"),d="true"===a.getAttribute("onRight");a.setAttribute("d",Vb(0,0,lb,b,eb,c,d))};N.displaySprite=function(a,b){var c=N.sprite[a];if("hidden"!==c.value){var d,e,f,g,i,j=document.getElementById("sprite"+a),k=document.getElementById("spriteWalk"+a);void 0!==c.value&&P[c.value]&&P[c.value].walk&&b?(j.setAttribute("visibility","hidden"),k.setAttribute("visibility","visible"),g=c.width*h(a,{walkDirection:!0}),i=c.height*h(a,{walkFrame:!0}),d=k,e=document.getElementById("spriteWalkClipRect"+a),f=document.getElementById("spriteClipRect"+a)):(j.setAttribute("visibility","visible"),k.setAttribute("visibility","hidden"),g=c.width*h(a),i=0,d=j,e=document.getElementById("spriteClipRect"+a),f=document.getElementById("spriteWalkClipRect"+a));var l=e.getAttribute("x"),m=e.getAttribute("y"),n=c.dir;n===F.NONE?c.dir=F.SOUTH:(c.x!=l||c.y!=m)&&(c.dir=F.NONE,c.x<l?c.dir|=F.WEST:c.x>l&&(c.dir|=F.EAST),c.y<m?c.dir|=F.NORTH:c.y>m&&(c.dir|=F.SOUTH)),c.dir!==c.displayDir&&N.tickCount&&0===N.tickCount%2&&(c.displayDir=G[c.displayDir][c.dir]),d.setAttribute("x",c.x-g),d.setAttribute("y",c.y-i),e.setAttribute("x",c.x),e.setAttribute("y",c.y),f.setAttribute("x",c.x),f.setAttribute("y",c.y);var o=document.getElementById("speechBubble"+a),p=document.getElementById("speechBubblePath"+a),q=+p.getAttribute("height"),r="true"===p.getAttribute("onTop"),s="true"===p.getAttribute("onRight"),t=!0,u=!0,v=c.y-(q+gb);0>v&&(v=c.y+c.height+gb,t=!1);var w=c.x+fb;w>N.MAZE_WIDTH-lb&&(w=c.x+c.width-(lb+fb),u=!1),p.setAttribute("onTop",t),p.setAttribute("onRight",u),(r!==t||s!==u)&&Qb(p),o.setAttribute("transform","translate("+w+","+v+")")}},N.displayScore=function(){var a=document.getElementById("score");a.textContent=N.scoreText?N.scoreText:q.scoreText({playerScore:N.playerScore}),a.setAttribute("visibility","visible")},N.showCoordinates=function(){var a=N.sprite[N.protagonistSpriteIndex||0];if(a){var b=a.x+50,c=350-a.y;N.setScoreText({text:"x: "+b+" y: "+c})}},N.queueCmd=function(a,b,c){var d={id:a,name:b,opts:c};if(p.isUsingBlockly()){if(N.currentEventParams)for(var e in N.currentEventParams)d.opts[e]=N.currentEventParams[e];N.currentCmdQueue.push(d)}else N.callCmd(d)},N.executeQueue=function(a){N.eventHandlers.forEach(function(b){if(b.name===a&&b.cmdQueue.length)for(var c=b.cmdQueue[0];c&&N.callCmd(c);c=b.cmdQueue[0])b.cmdQueue.shift()})},N.callCmd=function(a){switch(a.name){case"setBackground":p.highlight(a.id),N.setBackground(a.opts);break;case"setSprite":p.highlight(a.id),N.setSprite(a.opts);break;case"saySprite":return a.opts.started||p.highlight(a.id),N.saySprite(a.opts);case"setSpriteEmotion":p.highlight(a.id),N.setSpriteEmotion(a.opts);break;case"setSpriteSpeed":p.highlight(a.id),N.setSpriteSpeed(a.opts);break;case"setSpriteSize":p.highlight(a.id),N.setSpriteSize(a.opts);break;case"setSpritePosition":p.highlight(a.id),N.setSpritePosition(a.opts);break;case"setSpriteXY":p.highlight(a.id),N.setSpriteXY(a.opts);break;case"playSound":p.highlight(a.id),p.playAudio(a.opts.soundName,{volume:1}),N.playSoundCount++;break;case"showTitleScreen":return a.opts.started||p.highlight(a.id),N.showTitleScreen(a.opts);case"move":p.highlight(a.id),N.moveSingle(a.opts);break;case"moveDistance":return a.opts.started||p.highlight(a.id),N.moveDistance(a.opts);case"stop":p.highlight(a.id),N.stop(a.opts);break;case"throwProjectile":return a.opts.started||p.highlight(a.id),N.throwProjectile(a.opts);case"makeProjectile":p.highlight(a.id),N.makeProjectile(a.opts);break;case"changeScore":p.highlight(a.id),N.changeScore(a.opts);break;case"setScoreText":p.highlight(a.id),N.setScoreText(a.opts);break;case"showCoordinates":p.highlight(a.id),N.showCoordinates();break;case"wait":return a.opts.started||p.highlight(a.id),N.wait(a.opts);case"vanish":p.highlight(a.id),N.vanishActor(a.opts);break;case"onEvent":p.highlight(a.id),N.onEvent(a.opts)}return!0},N.vanishActor=function(a){var b=document.getElementById("svgStudio"),c=document.getElementById("sprite"+a.spriteIndex);if(c&&"hidden"!==c.getAttribute("visibility")){var d=document.getElementById("explosion"+a.spriteIndex);d||(d=document.createElementNS(M,"image"),d.setAttribute("id","explosion"+a.spriteIndex),d.setAttribute("visibility","hidden"),b.appendChild(d,c));var e=document.getElementById("spriteClipRect"+a.spriteIndex);d.setAttribute("height",N.sprite[a.spriteIndex].height),d.setAttribute("width",N.sprite[a.spriteIndex].width),d.setAttribute("x",e.getAttribute("x")),d.setAttribute("y",e.getAttribute("y")),d.setAttribute("visibility","visible");var f=parseInt(e.getAttribute("x"),10),g=P.explosionFrames;g&&g>1?(d.setAttribute("clip-path","url(#spriteClipPath"+a.spriteIndex+")"),d.setAttribute("width",100*g),D.range(0,g).forEach(function(a){N.perExecutionTimeouts.push(setTimeout(function(){d.setAttribute("x",f-100*a),c.setAttribute("opacity",(g-a)/g)},100*a))}),N.perExecutionTimeouts.push(setTimeout(function(){d.setAttribute("visibility","hidden"),N.setSprite({spriteIndex:a.spriteIndex,value:"hidden"}),c.removeAttribute("opacity")},100*(g+1)))):N.setSprite({spriteIndex:a.spriteIndex,value:"hidden"}),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P.explosion+"?spriteIndex="+a.spriteIndex)}},N.setSpriteEmotion=function(a){N.sprite[a.spriteIndex].emotion=a.value},N.setSpriteSpeed=function(a){var b=Math.min(Math.max(a.value,2),12);N.sprite[a.spriteIndex].speed=b},N.setSpriteSize=function(a){N.sprite[a.spriteIndex].size=a.value;var b=N.sprite[a.spriteIndex].value;"hidden"!==b&&N.setSprite({spriteIndex:a.spriteIndex,value:b})},N.changeScore=function(a){N.playerScore+=Number(a.value),N.displayScore()},N.setScoreText=function(a){N.scoreText=a.text,N.displayScore()},N.setBackground=function(a){var b=document.getElementById("background");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P[a.value].background)},N.setSprite=function(a){var b=a.spriteIndex,c=N.sprite[b],d=a.value,e=document.getElementById("sprite"+b);if(e){var f=null;if(void 0!==d&&P[d]&&P[d].walk){if(f=document.getElementById("spriteWalk"+b),!f)return;f.setAttribute("visibility","hidden")}if(c.visible="hidden"!==d&&!a.forceHidden,e.setAttribute("visibility",c.visible?"visible":"hidden"),c.value=a.forceHidden?"hidden":a.value,"hidden"!==d&&"visible"!==d){c.frameCounts=P[d].frameCounts,c.timePerFrame=P[d].timePerFrame,c.height=c.size*P.spriteHeight,c.width=c.size*P.spriteWidth,P.projectileSpriteHeight&&(c.projectileSpriteHeight=c.size*P.projectileSpriteHeight),P.projectileSpriteWidth&&(c.projectileSpriteWidth=c.size*P.projectileSpriteWidth);
var g=document.getElementById("spriteClipRect"+b);if(g.setAttribute("width",c.width),g.setAttribute("height",c.height),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P[d].sprite),e.setAttribute("width",c.width*i(b)),e.setAttribute("height",c.height),f){var h=document.getElementById("spriteWalkClipRect"+b);h.setAttribute("width",c.width),h.setAttribute("height",c.height),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P[d].walk);var j=N.sprite[b].frameCounts;f.setAttribute("width",c.width*j.turns),f.setAttribute("height",c.height*j.walk)}N.displaySprite(b)}}};var Rb=function(a,b){return a+" "+b+" "},Sb=15,Tb=25,Ub=10,Vb=function(a,b,c,d,e,f,g){var h="M"+Rb(a+e,b);return f||(h+=g?"L"+Rb(a+e-Ub,b-Sb)+"L"+Rb(a+e+Tb,b):"L"+Rb(a+c-e-Tb,b)+"L"+Rb(a+c-Ub,b-Sb)),h+="L"+Rb(a+c-e,b),h+="Q"+Rb(a+c,b)+Rb(a+c,b+e),h+="L"+Rb(a+c,b+d-e)+"Q"+Rb(a+c,b+d)+Rb(a+c-e,b+d),f&&(h+=g?"L"+Rb(a+e+Tb,b+d)+"L"+Rb(a+e-Ub,b+d+Sb):"L"+Rb(a+c-Ub,b+d+Sb)+"L"+Rb(a+c-e-Tb,b+d)),h+="L"+Rb(a+e,b+d),h+="Q"+Rb(a,b+d)+Rb(a,b+d-e),h+="L"+Rb(a,b+e)+"Q"+Rb(a,b)+Rb(a+e,b),h+="Z"},Wb=function(a){a.complete||(a.waitCallback&&a.waitCallback(),a.complete=!0)};N.wait=function(a){return a.started||(a.started=!0,"click"===a.value?a.waitForClick=!0:a.waitTimeout=window.setTimeout(rb(this,Wb,a),a.value)),a.complete},N.hideTitleScreen=function(a){var b=document.getElementById("titleScreenTitle"),c=document.getElementById("titleScreenTextGroup");b.setAttribute("visibility","hidden"),c.setAttribute("visibility","hidden"),a.complete=!0},N.showTitleScreen=function(a){if(!a.started){a.started=!0;var b=document.getElementById("titleScreenTitle"),c=document.getElementById("titleScreenTextGroup"),d=document.getElementById("titleScreenText"),e=document.getElementById("titleScreenTextRect");b.textContent=a.title;var f={svgText:d,text:a.text,width:cb,lineHeight:$,topMargin:ab,sideMargin:Z,maxLines:_,fullHeight:db},g=wb(f);e.setAttribute("height",g),b.setAttribute("visibility","visible"),c.setAttribute("visibility","visible"),a.waitForClick=!0,a.waitCallback=rb(this,N.hideTitleScreen,a),a.waitTimeout=window.setTimeout(rb(this,Wb,a),W)}return a.complete},N.isCmdCurrentInQueue=function(a,b){var c=!1;return N.eventHandlers.forEach(function(d){if(d.name===b){var e=d.cmdQueue[0];e&&e.name===a&&(c=!0)}}),c},N.hideSpeechBubble=function(a){var b=document.getElementById("speechBubble"+a.spriteIndex);b.setAttribute("visibility","hidden"),b.removeAttribute("onTop"),b.removeAttribute("onRight"),b.removeAttribute("height"),a.complete=!0,delete N.sprite[a.spriteIndex].bubbleTimeoutFunc,N.sayComplete++},N.saySprite=function(a){if(a.started)return a.complete;var b=a.spriteIndex,c=N.sprite[b];if(c){if(a.started=!0,c.bubbleTimeoutFunc&&c.bubbleTimeoutFunc(),window.clearTimeout(c.bubbleTimeout),!c.visible)return a.complete=!0,a.complete;var d=document.getElementById("speechBubbleText"+b),e={svgText:d,text:a.text,width:lb,lineHeight:ib,topMargin:kb,sideMargin:hb,maxLines:jb,fullHeight:mb},f=wb(e),g=document.getElementById("speechBubblePath"+b),h=document.getElementById("speechBubble"+b);return g.setAttribute("height",f),Qb(g),N.displaySprite(a.spriteIndex),h.setAttribute("visibility","visible"),c.bubbleTimeoutFunc=rb(this,N.hideSpeechBubble,a),c.bubbleTimeout=window.setTimeout(c.bubbleTimeoutFunc,1e3*a.seconds),a.complete}},N.stop=function(a){if(tb(a.spriteIndex,!0),tb(a.spriteIndex,!1),!a.dontResetCollisions){var b=N.sprite[a.spriteIndex];if(!b)return;b.clearCollisions();for(var c=0;c<N.spriteCount;c++)c!==a.spriteIndex&&N.sprite[c].endCollision(a.spriteIndex)}},N.throwProjectile=function(a){if(a.started)return a.complete;a.started=!0,a.complete=!1,window.setTimeout(function(){a.complete=!0},ob);var b=N.sprite[a.spriteIndex];if(b.visible){var c,d=P.preventProjectileLoop&&P.preventProjectileLoop(a.className);c=/.gif$/.test(P[a.className])?1:P.specialProjectileFrames&&P.specialProjectileFrames[a.className]?P.specialProjectileFrames[a.className]:P.projectileFrames;var e={frames:c,className:a.className,dir:a.dir,image:P[a.className],loop:!d,spriteX:b.x,spriteY:b.y,spriteHeight:b.projectileSpriteHeight||b.height,spriteWidth:b.projectileSpriteWidth||b.width},f=new z(e);f.createElement(document.getElementById("svgStudio")),N.projectiles.push(f)}};var Xb=function(a,b){if("bounce"===b)a.bounce();else{if("disappear"!==b)throw"unknown action in doMakeProjectile";a.removeElement();var c=N.projectiles.indexOf(a);if(-1!==c)return N.projectiles.splice(c,1),!0}return!1};N.makeProjectile=function(a){if(a.projectile)Xb(a.projectile,a.action);else for(var b=0;b<N.projectiles.length;b++)N.projectiles[b].className===a.className&&Xb(N.projectiles[b],a.action)&&b--};var Yb=function(a,b){switch(b){case r.Position.OUTTOPOUTLEFT:case r.Position.TOPOUTLEFT:case r.Position.MIDDLEOUTLEFT:case r.Position.BOTTOMOUTLEFT:case r.Position.OUTBOTTOMOUTLEFT:return-a.width;case r.Position.OUTTOPLEFT:case r.Position.TOPLEFT:case r.Position.MIDDLELEFT:case r.Position.BOTTOMLEFT:case r.Position.OUTBOTTOMLEFT:return 0;case r.Position.OUTTOPCENTER:case r.Position.TOPCENTER:case r.Position.MIDDLECENTER:case r.Position.BOTTOMCENTER:case r.Position.OUTBOTTOMCENTER:return(N.MAZE_WIDTH-a.width)/2;case r.Position.OUTTOPRIGHT:case r.Position.TOPRIGHT:case r.Position.MIDDLERIGHT:case r.Position.BOTTOMRIGHT:case r.Position.OUTBOTTOMRIGHT:return N.MAZE_WIDTH-a.width;case r.Position.OUTTOPOUTRIGHT:case r.Position.TOPOUTRIGHT:case r.Position.MIDDLEOUTRIGHT:case r.Position.BOTTOMOUTRIGHT:case r.Position.OUTBOTTOMOUTRIGHT:return N.MAZE_WIDTH}},Zb=function(a,b){switch(b){case r.Position.OUTTOPOUTLEFT:case r.Position.OUTTOPLEFT:case r.Position.OUTTOPCENTER:case r.Position.OUTTOPRIGHT:case r.Position.OUTTOPOUTRIGHT:return-a.height;case r.Position.TOPOUTLEFT:case r.Position.TOPLEFT:case r.Position.TOPCENTER:case r.Position.TOPRIGHT:case r.Position.TOPOUTRIGHT:return 0;case r.Position.MIDDLEOUTLEFT:case r.Position.MIDDLELEFT:case r.Position.MIDDLECENTER:case r.Position.MIDDLERIGHT:case r.Position.MIDDLEOUTRIGHT:return(N.MAZE_HEIGHT-a.height)/2;case r.Position.BOTTOMOUTLEFT:case r.Position.BOTTOMLEFT:case r.Position.BOTTOMCENTER:case r.Position.BOTTOMRIGHT:case r.Position.BOTTOMOUTRIGHT:return N.MAZE_HEIGHT-a.height;case r.Position.OUTBOTTOMOUTLEFT:case r.Position.OUTBOTTOMLEFT:case r.Position.OUTBOTTOMCENTER:case r.Position.OUTBOTTOMRIGHT:case r.Position.OUTBOTTOMOUTRIGHT:return N.MAZE_HEIGHT}};N.collideSpriteWith=function(a,b,c){var d=N.sprite[a];d.startCollision(b)&&m(a,b,c)},N.setSpritePosition=function(a){var b=N.sprite[a.spriteIndex];a.value&&(a.x=Yb(b,a.value),a.y=Zb(b,a.value));var c=b.x===a.x&&b.y===a.y;N.stop({spriteIndex:a.spriteIndex,dontResetCollisions:c}),b.x=a.x,b.y=a.y,b.dir=F.NONE},N.setSpriteXY=function(a){var b=N.sprite[a.spriteIndex],c=a.x-b.width/2,d=a.y-b.height/2,e=b.x===c&&b.y===d;N.stop({spriteIndex:a.spriteIndex,dontResetCollisions:e}),b.x=c,b.y=d,b.dir=F.NONE},N.moveSingle=function(a){var b=N.sprite[a.spriteIndex];switch(b.lastMove=N.tickCount,a.dir){case F.NORTH:b.y-=b.speed,b.y<0&&!O.allowSpritesOutsidePlayspace&&(b.y=0);break;case F.EAST:b.x+=b.speed;var c=N.MAZE_WIDTH-b.width;b.x>c&&!O.allowSpritesOutsidePlayspace&&(b.x=c);break;case F.SOUTH:b.y+=b.speed;var d=N.MAZE_HEIGHT-b.height;b.y>d&&!O.allowSpritesOutsidePlayspace&&(b.y=d);break;case F.WEST:b.x-=b.speed,b.x<0&&!O.allowSpritesOutsidePlayspace&&(b.x=0)}},N.moveDistance=function(a){return a.started||(a.started=!0,a.queuedDistance=a.distance),0===a.queuedDistance},N.onEvent=function(a){Db(N.eventHandlers,a.eventName,a.func)},N.allWhenRunBlocksComplete=function(){for(var a=0;a<N.eventHandlers.length;a++)if("whenGameStarts"===N.eventHandlers[a].name&&0!==N.eventHandlers[a].cmdQueue.length)return!1;return!0},N.timedOut=function(){return O.timeoutAfterWhenRun&&(0===N.eventHandlers.length||1===N.eventHandlers.length&&"whenGameStarts"===N.eventHandlers[0].name&&N.allWhenRunBlocksComplete())?!0:N.tickCount>N.timeoutFailureTick},N.allGoalsVisited=function(){var a,b,c=N.sprite[N.protagonistSpriteIndex],d=0;if(0===N.spriteGoals_.length)return!1;if(N.protagonistSpriteIndex&&!c)return!1;for(a=0;a<N.spriteGoals_.length;a++){var e=N.spriteGoals_[a];if(!e.finished){if(c){var g=e.finished;if(e.finished=o(c,e),!g&&e.finished){var h=!1,i="whenSpriteCollided-"+N.protagonistSpriteIndex+"-";f(i+"anything",h)}}else{e.finished=!1;for(var j=0;j<N.sprite.length;j++)if(o(N.sprite[j],e)){e.finished=!0;break}}b=e.finished}if(e.finished){d++,b&&d!==N.spriteGoals_.length&&p.playAudio("flag");var k=P.goalSuccess;O.goalOverride&&O.goalOverride.success&&(k=P[O.goalOverride.success]);var l=document.getElementById("spriteFinish"+a);l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",k)}}return d===N.spriteGoals_.length};var $b=function(){return O.goal&&O.goal.successCondition&&O.goal.successCondition()?(N.result=K.SUCCESS,!0):O.goal&&O.goal.failureCondition&&O.goal.failureCondition()?(N.result=K.FAILURE,!0):N.allGoalsVisited()?(N.result=K.SUCCESS,!0):N.timedOut()?(N.result=K.FAILURE,!0):!1}},{"../../locale/current/common":190,"../../locale/current/studio":196,"../StudioApp":2,"../canvg/StackBlur.js":38,"../canvg/canvg.js":39,"../canvg/rgbcolor.js":40,"../canvg/svg_todataurl":41,"../codegen":42,"../constants":43,"../dom":44,"../skins":144,"../templates/page.html":165,"../utils":185,"../xml":186,"./api":146,"./bigGameLogic":147,"./blocks":148,"./collidable":149,"./constants":150,"./controls.html":151,"./extraControlRows.html":152,"./projectile":155,"./visualization.html":158}],158:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="svgStudio">\n</svg>\n<div id="capacityBubble">\n  <div id="capacity"></div>\n</div>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:206}],155:[function(a,b){var c=a("./collidable"),d=a("./constants").Direction,e=a("./constants"),f="http://www.w3.org/2000/svg",g=0,h={};h[d.EAST]=0,h[d.SOUTH]=90,h[d.WEST]=180,h[d.NORTH]=270;var i={};i[d.NORTH]={x:.5,y:0},i[d.EAST]={x:1,y:.5},i[d.SOUTH]={x:.5,y:1},i[d.WEST]={x:0,y:.5};var j={};j[d.NORTH]={x:0,y:-25},j[d.EAST]={x:25,y:0},j[d.SOUTH]={x:0,y:25},j[d.WEST]={x:-25,y:0};var k=function(a){c.apply(this,arguments),this.height=a.height||50,this.width=a.width||50,this.speed=a.speed||e.DEFAULT_SPRITE_SPEED/2,this.currentFrame_=0;var b=this;this.animator_=window.setInterval(function(){(b.loop||b.currentFrame_+1<b.frames)&&(b.currentFrame_=(b.currentFrame_+1)%b.frames)},50),this.x=a.spriteX+j[a.dir].x+a.spriteWidth*i[a.dir].x,this.y=a.spriteY+j[a.dir].y+a.spriteHeight*i[a.dir].y};k.prototype=new c,b.exports=k,k.prototype.createElement=function(a){this.clipPath=document.createElementNS(f,"clipPath");var b="projectile_clippath_"+g++;this.clipPath.setAttribute("id",b);var c=document.createElementNS(f,"rect");c.setAttribute("width",this.width),c.setAttribute("height",this.height),this.clipPath.appendChild(c),a.appendChild(this.clipPath),this.element=document.createElementNS(f,"image"),this.element.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.image),this.element.setAttribute("height",this.height),this.element.setAttribute("width",this.width*this.frames),a.appendChild(this.element),this.element.setAttribute("clip-path","url(#"+b+")")},k.prototype.removeElement=function(){this.element&&(this.element.parentNode.removeChild(this.element),this.element=null),this.clipPath&&(this.clipPath.parentNode.removeChild(this.clipPath),this.clipPath=null),this.animator_&&(window.clearInterval(this.animator_),this.animator_=null)},k.prototype.display=function(){var a={x:this.x-this.width/2,y:this.y-this.height/2};this.element.setAttribute("x",a.x-this.width*this.currentFrame_),this.element.setAttribute("y",a.y);var b=this.clipPath.childNodes[0];b.setAttribute("x",a.x),b.setAttribute("y",a.y),this.frames>1&&this.element.setAttribute("transform","rotate("+h[this.dir]+", "+this.x+", "+this.y+")")},k.prototype.getNextPosition=function(){var a=d.getUnitVector(this.dir);return{x:this.x+this.speed*a.x,y:this.y+this.speed*a.y}},k.prototype.moveToNextPosition=function(){var a=this.getNextPosition();this.x=a.x,this.y=a.y}},{"./collidable":149,"./constants":150}],156:[function(a,b,c){function d(a){a.preloadAssets=!1,a.defaultBackground="leafy",a.projectileFrames=10,a.specialProjectileFrames={projectile_cherry:13,projectile_ice:12,projectile_duck:12},a.explosion=a.assetUrl("vanish.png"),a.explosionFrames=17,a.projectileSpriteWidth=70,a.projectileSpriteHeight=70,a.avatarList=["anna","elsa","hiro","baymax","rapunzel"],a.avatarList.forEach(function(b){a[b]={sprite:a.assetUrl("avatar_"+b+".png"),walk:a.assetUrl("walk_"+b+".png"),dropdownThumbnail:a.assetUrl("avatar_"+b+"_thumb.png"),frameCounts:{normal:19,animation:0,turns:8,emotions:0,walk:12},timePerFrame:100}}),a.preventProjectileLoop=function(a){return"projectile_hiro"===a},a.projectile_hiro=a.assetUrl("projectile_hiro.png"),a.projectile_anna=a.assetUrl("projectile_anna.png"),a.projectile_elsa=a.assetUrl("projectile_elsa.png"),a.projectile_baymax=a.assetUrl("projectile_baymax.png"),a.projectile_rapunzel=a.assetUrl("projectile_rapunzel.png"),a.projectile_cherry=a.assetUrl("projectile_cherry.png"),a.projectile_ice=a.assetUrl("projectile_ice.png"),a.projectile_duck=a.assetUrl("projectile_duck.png"),a.leafy={background:a.assetUrl("background_leafy.png")},a.grassy={background:a.assetUrl("background_grassy.png")},a.flower={background:a.assetUrl("background_flower.png")},a.tile={background:a.assetUrl("background_tile.png")},a.icy={background:a.assetUrl("background_icy.png")},a.snowy={background:a.assetUrl("background_snowy.png")},a.backgroundChoices=[[g.setBackgroundRandom(),i],[g.setBackgroundLeafy(),'"leafy"'],[g.setBackgroundGrassy(),'"grassy"'],[g.setBackgroundFlower(),'"flower"'],[g.setBackgroundTile(),'"tile"'],[g.setBackgroundIcy(),'"icy"'],[g.setBackgroundSnowy(),'"snowy"']],a.backgroundChoicesK1=[[a.randomPurpleIcon,i],[g.setBackgroundLeafy(),'"leafy"'],[g.setBackgroundGrassy(),'"grassy"']],a.spriteChoices=[[g.setSpriteHidden(),j],[g.setSpriteRandom(),i],[g.setSpriteAnna(),'"anna"'],[g.setSpriteElsa(),'"elsa"'],[g.setSpriteHiro(),'"hiro"'],[g.setSpriteBaymax(),'"baymax"'],[g.setSpriteRapunzel(),'"rapunzel"']],a.projectileChoices=[[g.projectileHiro(),'"projectile_hiro"'],[g.projectileAnna(),'"projectile_anna"'],[g.projectileElsa(),'"projectile_elsa"'],[g.projectileBaymax(),'"projectile_baymax"'],[g.projectileRapunzel(),'"projectile_rapunzel"'],[g.projectileCherry(),'"projectile_cherry"'],[g.projectileIce(),'"projectile_ice"'],[g.projectileDuck(),'"projectile_duck"'],[g.projectileRandom(),i]]}function e(a){a.defaultBackground="cave",a.projectileFrames=8,a.explosion=a.assetUrl("explosion.gif"),a.explosionThumbnail=a.assetUrl("explosion_thumb.png"),a.hardcourt={background:a.assetUrl("background.png")},a.black={background:a.assetUrl("retro_background.png")},a.cave={background:a.assetUrl("background_cave.png")},a.night={background:a.assetUrl("background_santa.png")},a.cloudy={background:a.assetUrl("background_scifi.png")},a.underwater={background:a.assetUrl("background_underwater.png")},a.city={background:a.assetUrl("background_city.png")},a.desert={background:a.assetUrl("background_desert.png")},a.rainbow={background:a.assetUrl("background_rainbow.png")},a.soccer={background:a.assetUrl("background_soccer.png")},a.space={background:a.assetUrl("background_space.png")},a.tennis={background:a.assetUrl("background_tennis.png")},a.winter={background:a.assetUrl("background_winter.png")},a.grid={background:a.assetUrl("background_grid.png")},a.avatarList=["dog","cat","penguin","dinosaur","octopus","witch","bat","bird","dragon","squirrel","wizard","alien","ghost","monster","robot","unicorn","zombie","knight","ninja","pirate","caveboy","cavegirl","princess","spacebot","soccergirl","soccerboy","tennisgirl","tennisboy"],a.avatarList.forEach(function(b){a[b]={sprite:a.assetUrl(b+"_spritesheet_200px.png"),dropdownThumbnail:a.assetUrl(b+"_thumb.png"),frameCounts:{normal:1,animation:1,turns:7,emotions:3}}}),a.backgroundChoices=[[g.setBackgroundRandom(),i],[g.setBackgroundCave(),'"cave"'],[g.setBackgroundNight(),'"night"'],[g.setBackgroundCloudy(),'"cloudy"'],[g.setBackgroundUnderwater(),'"underwater"'],[g.setBackgroundHardcourt(),'"hardcourt"'],[g.setBackgroundBlack(),'"black"'],[g.setBackgroundCity(),'"city"'],[g.setBackgroundDesert(),'"desert"'],[g.setBackgroundRainbow(),'"rainbow"'],[g.setBackgroundSoccer(),'"soccer"'],[g.setBackgroundSpace(),'"space"'],[g.setBackgroundTennis(),'"tennis"'],[g.setBackgroundWinter(),'"winter"']],a.backgroundChoicesK1=[[a.cave.background,'"cave"'],[a.night.background,'"night"'],[a.cloudy.background,'"cloudy"'],[a.underwater.background,'"underwater"'],[a.hardcourt.background,'"hardcourt"'],[a.black.background,'"black"'],[a.city.background,'"city"'],[a.desert.background,'"desert"'],[a.rainbow.background,'"rainbow"'],[a.soccer.background,'"soccer"'],[a.space.background,'"space"'],[a.tennis.background,'"tennis"'],[a.winter.background,'"winter"'],[a.randomPurpleIcon,i]],a.spriteChoices=[[g.setSpriteHidden(),j],[g.setSpriteRandom(),i],[g.setSpriteWitch(),'"witch"'],[g.setSpriteCat(),'"cat"'],[g.setSpriteDinosaur(),'"dinosaur"'],[g.setSpriteDog(),'"dog"'],[g.setSpriteOctopus(),'"octopus"'],[g.setSpritePenguin(),'"penguin"'],[g.setSpriteBat(),'"bat"'],[g.setSpriteBird(),'"bird"'],[g.setSpriteDragon(),'"dragon"'],[g.setSpriteSquirrel(),'"squirrel"'],[g.setSpriteWizard(),'"wizard"'],[g.setSpriteAlien(),'"alien"'],[g.setSpriteGhost(),'"ghost"'],[g.setSpriteMonster(),'"monster"'],[g.setSpriteRobot(),'"robot"'],[g.setSpriteUnicorn(),'"unicorn"'],[g.setSpriteZombie(),'"zombie"'],[g.setSpriteKnight(),'"knight"'],[g.setSpriteNinja(),'"ninja"'],[g.setSpritePirate(),'"pirate"'],[g.setSpriteCaveBoy(),'"caveboy"'],[g.setSpriteCaveGirl(),'"cavegirl"'],[g.setSpritePrincess(),'"princess"'],[g.setSpriteSpacebot(),'"spacebot"'],[g.setSpriteSoccerGirl(),'"soccergirl"'],[g.setSpriteSoccerBoy(),'"soccerboy"'],[g.setSpriteTennisGirl(),'"tennisgirl"'],[g.setSpriteTennisBoy(),'"tennisboy"']],a.projectileChoices=[[g.projectileBlueFireball(),'"blue_fireball"'],[g.projectilePurpleFireball(),'"purple_fireball"'],[g.projectileRedFireball(),'"red_fireball"'],[g.projectileYellowHearts(),'"yellow_hearts"'],[g.projectilePurpleHearts(),'"purple_hearts"'],[g.projectileRedHearts(),'"red_hearts"'],[g.projectileRandom(),i]]}{var f=a("../skins"),g=a("../../locale/current/studio"),h=a("./constants"),i=h.RANDOM_VALUE,j=h.HIDDEN_VALUE;h.CLICK_VALUE,h.VISIBLE_VALUE}c.load=function(a,b){var c=f.load(a,b);switch(c.yellow_hearts=c.assetUrl("yellow_hearts.gif"),c.purple_hearts=c.assetUrl("purple_hearts.gif"),c.red_hearts=c.assetUrl("red_hearts.gif"),c.blue_fireball=c.assetUrl("blue_fireball.png"),c.purple_fireball=c.assetUrl("purple_fireball.png"),c.red_fireball=c.assetUrl("red_fireball.png"),c.whenUp=c.assetUrl("when-up.png"),c.whenDown=c.assetUrl("when-down.png"),c.whenLeft=c.assetUrl("when-left.png"),c.whenRight=c.assetUrl("when-right.png"),c.collide=c.assetUrl("when-sprite-collide.png"),c.emotionAngry=c.assetUrl("emotion-angry.png"),c.emotionNormal=c.assetUrl("emotion-nothing.png"),c.emotionSad=c.assetUrl("emotion-sad.png"),c.emotionHappy=c.assetUrl("emotion-happy.png"),c.speechBubble=c.assetUrl("say-sprite.png"),c.goal=c.assetUrl("goal.png"),c.goalSuccess=c.assetUrl("goal_success.png"),c.rubberSound=[c.assetUrl("wall.mp3"),c.assetUrl("wall.ogg")],c.flagSound=[c.assetUrl("win_goal.mp3"),c.assetUrl("win_goal.ogg")],c.crunchSound=[c.assetUrl("wall0.mp3"),c.assetUrl("wall0.ogg")],c.winPointSound=[c.assetUrl("1_we_win.mp3"),c.assetUrl("1_we_win.ogg")],c.winPoint2Sound=[c.assetUrl("2_we_win.mp3"),c.assetUrl("2_we_win.ogg")],c.losePointSound=[c.assetUrl("1_we_lose.mp3"),c.assetUrl("1_we_lose.ogg")],c.losePoint2Sound=[c.assetUrl("2_we_lose.mp3"),c.assetUrl("2_we_lose.ogg")],c.goal1Sound=[c.assetUrl("1_goal.mp3"),c.assetUrl("1_goal.ogg")],c.goal2Sound=[c.assetUrl("2_goal.mp3"),c.assetUrl("2_goal.ogg")],c.woodSound=[c.assetUrl("1_paddle_bounce.mp3"),c.assetUrl("1_paddle_bounce.ogg")],c.retroSound=[c.assetUrl("2_paddle_bounce.mp3"),c.assetUrl("2_paddle_bounce.ogg")],c.slapSound=[c.assetUrl("1_wall_bounce.mp3"),c.assetUrl("1_wall_bounce.ogg")],c.hitSound=[c.assetUrl("2_wall_bounce.mp3"),c.assetUrl("2_wall_bounce.ogg")],c.background=c.assetUrl("background.png"),c.spriteHeight=100,c.spriteWidth=100,c.dropdownThumbnailWidth=50,c.dropdownThumbnailHeight=50,c.preloadAssets=!0,c.id){case"infinity":d(c,a);break;case"studio":e(c,a)}return c}},{"../../locale/current/studio":196,"../skins":144,"./constants":150}],153:[function(a,b){function c(a){var b={};return a.sprite&&(b.SPRITE=a.sprite),a.requiredText&&(b.TEXT=a.requiredText),a.notDefaultText&&(b.TEXT=d.helloWorld()),[{test:function(b){return"studio_saySprite"!==b.type?!1:a.sprite&&b.getTitleValue("SPRITE")!==a.sprite?!1:(a.notDefaultText||a.requiredText)&&b.getTitleValue("TEXT")===d.defaultSayText()?!1:!0},type:"studio_saySprite",titles:b}]}var d=a("../../locale/current/studio"),e=a("../utils"),f=a("../block_utils"),g=a("./constants"),h=(g.Direction,g.Emotions),i=f.createToolbox,j=f.blockOfType,k=f.createCategory,l=j("studio_moveNorthDistance")+j("studio_moveEastDistance")+j("studio_moveSouthDistance")+j("studio_moveWestDistance"),m=(j("studio_moveNorth")+j("studio_moveEast")+j("studio_moveSouth")+j("studio_moveWest"),b.exports={});m.custom={ideal:1/0,requiredBlocks:[],scale:{snapRadius:2},startBlocks:""},m.dog_hello={ideal:2,requiredBlocks:[c({notDefaultText:!0})],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return Studio.sayComplete>0}},timeoutFailureTick:100,toolbox:i(j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.k1_1=e.extend(m.dog_hello,{isK1:!0,toolbox:i(j("studio_saySprite"))}),m.c2_1=e.extend(m.dog_hello),m.c3_story_1=e.extend(m.dog_hello),m.playlab_1=e.extend(m.dog_hello,{background:"winter",timeoutFailureTick:null,timeoutAfterWhenRun:!0,firstSpriteIndex:2,goal:{successCondition:function(){return Studio.allWhenRunBlocksComplete()&&Studio.sayComplete>0}},requiredBlocks:[c({requiredText:d.hello()})]}),m.dog_and_cat_hello={ideal:3,requiredBlocks:[c({sprite:"0",notDefaultText:!0}),c({sprite:"1",notDefaultText:!0})],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,16,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return Studio.sayComplete>1}},timeoutFailureTick:200,toolbox:i(j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.k1_2=e.extend(m.dog_and_cat_hello,{isK1:!0,toolbox:i(j("studio_saySprite"))}),m.c2_2=e.extend(m.dog_and_cat_hello,{}),m.c3_story_2=e.extend(m.dog_and_cat_hello,{}),m.playlab_2=e.extend(m.dog_and_cat_hello,{background:"desert",firstSpriteIndex:20,timeoutFailureTick:null,timeoutAfterWhenRun:!0,defaultEmotion:h.HAPPY,goal:{successCondition:function(){return Studio.allWhenRunBlocksComplete()&&Studio.sayComplete>1}},requiredBlocks:[c({sprite:"0",requiredText:d.hello()}),c({sprite:"1",requiredText:d.hello()})],map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]}),m.dog_move_cat={ideal:2,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{DIR:"2"}}]],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,16,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)}},timeoutFailureTick:100,toolbox:i('<block type="studio_moveDistance"><title name="DIR">2</title></block>'+j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.k1_3=e.extend(m.dog_move_cat,{isK1:!0,requiredBlocks:[[{test:function(a){return"studio_moveEastDistance"==a.type},type:"studio_moveEastDistance"}]],toolbox:i(l+j("studio_saySprite"))}),m.c2_3=e.extend(m.dog_move_cat,{}),m.c3_story_3=e.extend(m.dog_move_cat,{}),m.playlab_3={ideal:2,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{DIR:"2",DISTANCE:"200"}}]],timeoutFailureTick:null,timeoutAfterWhenRun:!0,scale:{snapRadius:2},background:"tennis",firstSpriteIndex:26,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)}},toolbox:i('<block type="studio_moveDistance"><title name="DIR">1</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">2</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">4</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">8</title><title name="DISTANCE">200</title></block>'),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>',map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,1,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},m.dog_move_cat_hello={ideal:4,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{DIR:"2",DISTANCE:"100"}}],c({sprite:"1",requiredText:d.hello()})],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,16,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return Studio.sayComplete>0&&Studio.sprite[0].isCollidingWith(1)}},timeoutFailureTick:200,toolbox:i('<block type="studio_moveDistance"><title name="DIR">2</title></block>'+j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>     <block type="studio_whenSpriteCollided" deletable="false" x="20" y="120"></block>'},m.k1_4=e.extend(m.dog_move_cat_hello,{isK1:!0,requiredBlocks:[[{test:function(a){return"studio_moveEastDistance"==a.type},type:"studio_moveEastDistance"}],[{test:function(a){return"studio_saySprite"==a.type&&"1"===a.getTitleValue("SPRITE")&&a.getTitleValue("TEXT")!==d.defaultSayText()},type:"studio_saySprite",titles:{TEXT:d.hello(),SPRITE:"1"}}]],toolbox:i(l+j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>      <block type="studio_whenSpriteCollided" deletable="false" x="20" y="140"></block>'}),m.c2_4=e.extend(m.dog_move_cat_hello,{}),m.c3_story_4=e.extend(m.dog_move_cat_hello,{}),m.playlab_4={ideal:4,scale:{snapRadius:2},background:"tennis",avatarList:["tennisboy","tennisgirl"],defaultEmotion:h.SAD,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{DIR:"4",DISTANCE:"200"}}],[{test:"playSound",type:"studio_playSound",titles:{SOUND:"goal1"}}]],timeoutFailureTick:100,timeoutAfterWhenRun:!0,goal:{successCondition:function(){return Studio.playSoundCount>0&&Studio.sprite[0].isCollidingWith(1)}},toolbox:i('<block type="studio_moveDistance"><title name="DIR">1</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">2</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">4</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">8</title><title name="DISTANCE">200</title></block><block type="studio_playSound"><title name="SOUND">goal1</title></block>'),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block><block type="studio_whenSpriteCollided" deletable="false" x="20" y="120"></block>',map:[[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},m.click_hello={ideal:3,requiredBlocks:[c({requiredText:d.hello()})],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:4,goal:{successCondition:function(){return this.successState.seenCmd||(this.successState.seenCmd=Studio.isCmdCurrentInQueue("saySprite","whenSpriteClicked-0")),Studio.sayComplete>0&&this.successState.seenCmd}},timeoutFailureTick:300,toolbox:i('<block type="studio_moveDistance"><title name="DIR">2</title></block>'+j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>     <block type="studio_whenSpriteClicked" deletable="false" x="20" y="120"></block>'},m.c2_5=e.extend(m.click_hello,{}),m.c3_game_1=e.extend(m.click_hello,{}),m.playlab_5=e.extend(m.click_hello,{background:"space",firstSpriteIndex:23,timeoutAfterWhenRun:!0,defaultEmotion:h.HAPPY,toolbox:i(j("studio_saySprite")),startBlocks:'<block type="studio_whenSpriteClicked" deletable="false" x="20" y="20"></block>'}),m.octopus_happy={ideal:2,requiredBlocks:[[{test:"setSpriteEmotion",type:"studio_setSpriteEmotion"}]],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:4,goal:{successCondition:function(){return Studio.sprite[0].emotion===h.HAPPY&&Studio.tickCount>=50}},timeoutFailureTick:100,toolbox:i('<block type="studio_moveDistance"><title name="DIR">2</title></block>'+j("studio_setSpriteEmotion")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.k1_5=e.extend(m.octopus_happy,{isK1:!0,toolbox:i(l+j("studio_setSpriteEmotion"))}),m.c3_story_5=e.extend(m.octopus_happy,{}),m.c3_story_6={ideal:1/0,requiredBlocks:[],scale:{snapRadius:2},minWorkspaceHeight:1400,edgeCollisions:!0,projectileCollisions:!0,allowSpritesOutsidePlayspace:!1,spritesHiddenToStart:!0,freePlay:!0,map:[[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0]],toolbox:i(j("studio_setSprite")+j("studio_setBackground")+j("studio_whenSpriteCollided")+j("studio_repeatForever")+j("studio_showTitleScreen")+j("studio_move")+j("studio_moveDistance")+j("studio_stop")+j("studio_wait")+j("studio_playSound")+j("studio_changeScore")+j("studio_saySprite")+j("studio_setSpritePosition")+j("studio_setSpriteSpeed")+j("studio_setSpriteEmotion")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.move_penguin={ideal:8,requiredBlocks:[[{test:"move",type:"studio_move"}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0],[0,0,16,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,1,0,0,0,0,1,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,toolbox:i(j("studio_move")+j("studio_saySprite")),startBlocks:'<block type="studio_whenLeft" deletable="false" x="20" y="20"></block>     <block type="studio_whenRight" deletable="false" x="180" y="20"></block>     <block type="studio_whenUp" deletable="false" x="20" y="120"></block>     <block type="studio_whenDown" deletable="false" x="180" y="120"></block>'},m.c2_6=e.extend(m.move_penguin,{}),m.c3_game_2=e.extend(m.move_penguin,{}),m.playlab_6=e.extend(m.move_penguin,{background:"cave",firstSpriteIndex:5,goalOverride:{goal:"red_fireball",success:"blue_fireball",imageWidth:800},defaultEmotion:h.ANGRY,toolbox:i(j("studio_move",{DIR:8})+j("studio_move",{DIR:2})+j("studio_move",{DIR:1})+j("studio_move",{DIR:4})),map:[[1,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0]]}),m.dino_up_and_down={ideal:11,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{SPRITE:"1",DISTANCE:"400"}}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,16,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,protagonistSpriteIndex:1,timeoutFailureTick:150,minWorkspaceHeight:800,toolbox:i('<block type="studio_moveDistance">          <title name="DISTANCE">400</title>          <title name="SPRITE">1</title></block><block type="studio_saySprite">          <title name="SPRITE">1</title></block>'),startBlocks:'<block type="studio_whenLeft" deletable="false" x="20" y="20">       <next><block type="studio_move">               <title name="DIR">8</title></block>       </next></block>     <block type="studio_whenRight" deletable="false" x="20" y="150">       <next><block type="studio_move">               <title name="DIR">2</title></block>       </next></block>     <block type="studio_whenUp" deletable="false" x="20" y="280">       <next><block type="studio_move">               <title name="DIR">1</title></block>       </next></block>     <block type="studio_whenDown" deletable="false" x="20" y="410">       <next><block type="studio_move">               <title name="DIR">4</title></block>       </next></block>     <block type="studio_repeatForever" deletable="false" x="20" y="540"></block>'},m.c2_7=e.extend(m.dino_up_and_down,{}),m.c3_game_3=e.extend(m.dino_up_and_down,{}),m.playlab_7={ideal:3,background:"rainbow",firstSpriteIndex:10,scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],defaultEmotion:h.HAPPY,map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return 252===Studio.tickCount
}},timeoutFailureTick:253,minWorkspaceHeight:800,toolbox:i('<block type="studio_moveDistance"><title name="DIR">1</title><title name="DISTANCE">400</title></block><block type="studio_moveDistance"><title name="DIR">2</title><title name="DISTANCE">400</title></block><block type="studio_moveDistance"><title name="DIR">4</title><title name="DISTANCE">400</title></block><block type="studio_moveDistance"><title name="DIR">8</title><title name="DISTANCE">400</title></block>'),startBlocks:'<block type="studio_repeatForever" deletable="false" x="20" y="20"></block>',requiredBlocks:[[{test:function(a){return"studio_moveDistance"===a.type&&"2"===a.getTitleValue("DIR")},type:"studio_moveDistance",titles:{DIR:2,DISTANCE:"400"}}],[{test:function(a){return"studio_moveDistance"===a.type&&"8"===a.getTitleValue("DIR")},type:"studio_moveDistance",titles:{DIR:8,DISTANCE:"400"}}]]},m.penguin_ouch={ideal:14,requiredBlocks:[c({sprite:"0",requiredText:d.ouchExclamation()}),[{test:"playSound",type:"studio_playSound"}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,16,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,minWorkspaceHeight:900,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)}},timeoutFailureTick:300,toolbox:i('<block type="studio_moveDistance">          <title name="DISTANCE">400</title>          <title name="SPRITE">1</title></block>'+j("studio_saySprite")+j("studio_playSound")),startBlocks:'<block type="studio_whenLeft" deletable="false" x="20" y="20">       <next><block type="studio_move">               <title name="DIR">8</title></block>       </next></block>     <block type="studio_whenRight" deletable="false" x="20" y="150">       <next><block type="studio_move">               <title name="DIR">2</title></block>       </next></block>     <block type="studio_whenUp" deletable="false" x="20" y="280">       <next><block type="studio_move">               <title name="DIR">1</title></block>       </next></block>     <block type="studio_whenDown" deletable="false" x="20" y="410">       <next><block type="studio_move">               <title name="DIR">4</title></block>       </next></block>     <block type="studio_repeatForever" deletable="false" x="20" y="540">       <statement name="DO"><block type="studio_moveDistance">               <title name="SPRITE">1</title>               <title name="DISTANCE">400</title>         <next><block type="studio_moveDistance">                 <title name="SPRITE">1</title>                 <title name="DISTANCE">400</title>                 <title name="DIR">4</title></block>         </next></block>     </statement></block>     <block type="studio_whenSpriteCollided" deletable="false" x="20" y="730"></block>'},m.c2_8=e.extend(m.penguin_ouch,{}),m.c3_game_4=e.extend(m.penguin_ouch,{}),m.penguin_touch_octopus={ideal:16,requiredBlocks:[[{test:"changeScore",type:"studio_changeScore"}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,16,0,16,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,minWorkspaceHeight:1050,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(2)}},timeoutFailureTick:600,toolbox:i('<block type="studio_moveDistance">          <title name="DISTANCE">400</title>          <title name="SPRITE">1</title></block>'+j("studio_saySprite")+j("studio_playSound")+j("studio_changeScore")),startBlocks:'<block type="studio_whenLeft" deletable="false" x="20" y="20">       <next><block type="studio_move">               <title name="DIR">8</title></block>       </next></block>     <block type="studio_whenRight" deletable="false" x="20" y="150">       <next><block type="studio_move">               <title name="DIR">2</title></block>       </next></block>     <block type="studio_whenUp" deletable="false" x="20" y="280">       <next><block type="studio_move">               <title name="DIR">1</title></block>       </next></block>     <block type="studio_whenDown" deletable="false" x="20" y="410">       <next><block type="studio_move">               <title name="DIR">4</title></block>       </next></block>     <block type="studio_repeatForever" deletable="false" x="20" y="540">       <statement name="DO"><block type="studio_moveDistance">               <title name="SPRITE">1</title>               <title name="DISTANCE">400</title>         <next><block type="studio_moveDistance">                 <title name="SPRITE">1</title>                 <title name="DISTANCE">400</title>                 <title name="DIR">4</title></block>         </next></block>     </statement></block>     <block type="studio_whenSpriteCollided" deletable="false" x="20" y="730">       <next><block type="studio_playSound">       <next><block type="studio_saySprite">               <title name="TEXT">Ouch!</title></block>       </next></block>       </next></block>     <block type="studio_whenSpriteCollided" deletable="false" x="20" y="860">      <title name="SPRITE2">2</title></block>'},m.c2_9=e.extend(m.penguin_touch_octopus,{}),m.c3_game_5=e.extend(m.penguin_touch_octopus,{}),m.playlab_8={background:"rainbow",ideal:16,requiredBlocks:[[{test:"changeScore",type:"studio_changeScore"}],[{test:"playSound",type:"studio_playSound",titles:{SOUND:"winpoint"}}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],avatarList:["unicorn","wizard"],defaultEmotion:h.HAPPY,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)&&1===Studio.playerScore},failureCondition:function(){return Studio.sprite[0].isCollidingWith(1)&&1!==Studio.playerScore}},timeoutFailureTick:600,toolbox:i(j("studio_changeScore")+'<block type="studio_playSound"><title name="SOUND">winpoint</title></block>'),startBlocks:'<block type="studio_whenSpriteCollided" deletable="false" x="20" y="20"></block><block type="studio_repeatForever" deletable="false" x="20" y="150"><statement name="DO">'+f.blockWithNext("studio_moveDistance",{SPRITE:1,DIR:2,DISTANCE:400},j("studio_moveDistance",{SPRITE:1,DIR:8,DISTANCE:400}))+'</statement></block><block type="studio_whenLeft" deletable="false" x="20" y="300"><next>'+j("studio_move",{SPRITE:0,DIR:8})+'</next></block><block type="studio_whenRight" deletable="false" x="20" y="400"><next>'+j("studio_move",{SPRITE:0,DIR:2})+'</next></block><block type="studio_whenUp" deletable="false" x="20" y="500"><next>'+j("studio_move",{SPRITE:0,DIR:1})+'</next></block><block type="studio_whenDown" deletable="false" x="20" y="600"><next>'+j("studio_move",{SPRITE:0,DIR:4})+"</next></block>"},m.change_background_and_speed={ideal:19,requiredBlocks:[[{test:"setBackground",type:"studio_setBackground",titles:{VALUE:'"night"'}}],[{test:"setSpriteSpeed",type:"studio_setSpriteSpeed",titles:{VALUE:"Studio.SpriteSpeed.FAST"}}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,16,0,16,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,minWorkspaceHeight:1250,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(2)}},timeoutFailureTick:600,toolbox:i(j("studio_setBackground",{VALUE:'"night"'})+j("studio_moveDistance",{DISTANCE:400,SPRITE:1})+j("studio_saySprite")+j("studio_playSound")+j("studio_changeScore")+j("studio_setSpriteSpeed",{VALUE:"Studio.SpriteSpeed.FAST"})),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block><block type="studio_whenLeft" deletable="false" x="20" y="200"><next>'+j("studio_move",{DIR:8})+'</next></block><block type="studio_whenRight" deletable="false" x="20" y="330"><next>'+j("studio_move",{DIR:2})+'</next></block><block type="studio_whenUp" deletable="false" x="20" y="460"><next>'+j("studio_move",{DIR:1})+'</next></block><block type="studio_whenDown" deletable="false" x="20" y="590"><next>'+j("studio_move",{DIR:4})+'</next></block><block type="studio_repeatForever" deletable="false" x="20" y="720"><statement name="DO">'+f.blockWithNext("studio_moveDistance",{SPRITE:1,DIR:1,DISTANCE:400},j("studio_moveDistance",{SPRITE:1,DIR:4,DISTANCE:400}))+'</statement></block><block type="studio_whenSpriteCollided" deletable="false" x="20" y="880"><title name="SPRITE2">1</title><next>'+f.blockWithNext("studio_playSound",{},j("studio_saySprite",{TEXT:d.ouchExclamation()}))+'</next></block><block type="studio_whenSpriteCollided" deletable="false" x="20" y="1040"><title name="SPRITE2">2</title><next>'+j("studio_changeScore")+"</next></block>"},m.c2_10=e.extend(m.change_background_and_speed,{}),m.c3_game_6=e.extend(m.change_background_and_speed,{}),m.playlab_9={background:"black",requiredBlocks:[[{test:"setBackground",type:"studio_setBackground",titles:{VALUE:'"space"'}}],[{test:"setSpriteSpeed",type:"studio_setSpriteSpeed",titles:{VALUE:"Studio.SpriteSpeed.FAST"}}]],timeoutFailureTick:400,scale:{snapRadius:2},defaultEmotion:h.ANGRY,softButtons:["leftButton","rightButton","downButton","upButton"],avatarList:["spacebot","alien"],goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)}},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,0,0,16,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],toolbox:i(j("studio_setSpriteSpeed",{VALUE:"Studio.SpriteSpeed.FAST"})+j("studio_setBackground",{VALUE:'"space"'})+j("studio_moveDistance",{DISTANCE:400,SPRITE:1})+j("studio_saySprite")+j("studio_playSound",{SOUND:"winpoint2"})+j("studio_changeScore")),minWorkspaceHeight:1250,startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block><block type="studio_repeatForever" deletable="false" x="20" y="150"><statement name="DO">'+f.blockWithNext("studio_moveDistance",{SPRITE:1,DIR:1,DISTANCE:400},j("studio_moveDistance",{SPRITE:1,DIR:4,DISTANCE:400}))+'</statement></block><block type="studio_whenSpriteCollided" deletable="false" x="20" y="290"><title name="SPRITE2">0</title><title name="SPRITE2">1</title><next>'+f.blockWithNext("studio_playSound",{SOUND:"winpoint2"},j("studio_saySprite",{TEXT:d.alienInvasion()}))+'</next></block><block type="studio_whenLeft" deletable="false" x="20" y="410"><next>'+j("studio_move",{DIR:8})+'</next></block><block type="studio_whenRight" deletable="false" x="20" y="510"><next>'+j("studio_move",{DIR:2})+'</next></block><block type="studio_whenUp" deletable="false" x="20" y="610"><next>'+j("studio_move",{DIR:1})+'</next></block><block type="studio_whenDown" deletable="false" x="20" y="710"><next>'+j("studio_move",{DIR:4})+"</next></block>"},m.sandbox={ideal:1/0,requiredBlocks:[],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],minWorkspaceHeight:1400,edgeCollisions:!0,projectileCollisions:!0,allowSpritesOutsidePlayspace:!1,spritesHiddenToStart:!0,freePlay:!0,map:[[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0]],toolbox:i(j("studio_setSprite")+j("studio_setBackground")+j("studio_whenArrow")+j("studio_whenSpriteClicked")+j("studio_whenSpriteCollided")+j("studio_repeatForever")+j("studio_showTitleScreen")+j("studio_move")+j("studio_moveDistance")+j("studio_stop")+j("studio_wait")+j("studio_playSound")+j("studio_changeScore")+j("studio_saySprite")+j("studio_setSpritePosition")+j("studio_throw")+j("studio_makeProjectile")+j("studio_setSpriteSpeed")+j("studio_setSpriteEmotion")+j("studio_vanish")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.c2_11=e.extend(m.sandbox,{}),m.c3_game_7=e.extend(m.sandbox,{}),m.playlab_10=e.extend(m.sandbox,{}),m.k1_6={ideal:1/0,requiredBlocks:[],scale:{snapRadius:2},minWorkspaceHeight:1500,spritesHiddenToStart:!0,freePlay:!0,map:[[16,0,16,0,16,0,16,0],[0,16,0,16,0,16,0,0],[16,0,16,0,16,0,16,0],[0,16,0,16,0,16,0,0],[16,0,16,0,16,0,16,0],[0,16,0,16,0,16,0,0],[16,16,16,16,16,16,16,0],[0,0,0,0,0,0,0,0]],isK1:!0,softButtons:[],toolbox:i(j("studio_setSprite")+j("studio_saySprite")+l+j("studio_whenSpriteCollided")+j("studio_setBackground")+j("studio_setSpriteSpeed")+j("studio_setSpriteEmotion")+j("studio_playSound")+j("studio_vanish")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20">      <next><block type="studio_setSprite">         <title name="SPRITE">0</title></block>       </next></block>'},m.k1_block_test=e.extend(m[99],{toolbox:i(j("studio_setSprite")+j("studio_moveNorth")+j("studio_moveSouth")+j("studio_moveEast")+j("studio_moveWest")+j("studio_moveNorth_length")+j("studio_moveSouth_length")+j("studio_moveEast_length")+j("studio_moveWest_length")),isK1:!0}),m.full_sandbox={scrollbars:!0,requiredBlocks:[],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],minWorkspaceHeight:1400,edgeCollisions:!0,projectileCollisions:!0,allowSpritesOutsidePlayspace:!0,spritesHiddenToStart:!0,freePlay:!0,map:[[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0]],toolbox:i(k(d.catActions(),j("studio_setSprite")+j("studio_setBackground")+'<block type="studio_showTitleScreenParams">                         <value name="TITLE"><block type="text"></block>                         </value>                         <value name="TEXT"><block type="text"></block>                         </value></block>'+j("studio_move")+'<block type="studio_moveDistanceParams" inline="true">                       <value name="DISTANCE"><block type="math_number">                               <title name="NUM">25</title></block>                       </value></block>'+j("studio_stop")+'<block type="studio_waitParams" inline="true">                         <value name="VALUE"><block type="math_number">                                 <title name="NUM">1</title></block>                         </value></block>'+j("studio_playSound")+'<block type="studio_setScoreText" inline="true">                         <value name="TEXT"><block type="text"></block>                         </value></block><block type="studio_saySpriteParams" inline="true">                         <value name="TEXT"><block type="text"></block>                         </value></block>'+j("studio_setSpritePosition")+j("studio_throw")+j("studio_makeProjectile")+j("studio_setSpriteSpeed")+j("studio_setSpriteEmotion")+j("studio_vanish")+j("studio_setSpriteSize")+j("studio_showCoordinates"))+k(d.catEvents(),j("studio_whenArrow")+j("studio_whenSpriteClicked")+j("studio_whenSpriteCollided"))+k(d.catControl(),j("studio_repeatForever")+'<block type="controls_repeat_ext">                           <value name="TIMES">                             <block type="math_number">                               <title name="NUM">10</title>                             </block>                           </value>                         </block>'+j("controls_whileUntil")+'<block type="controls_for">                           <value name="FROM">                             <block type="math_number">                               <title name="NUM">1</title>                             </block>                           </value>                           <value name="TO">                             <block type="math_number">                               <title name="NUM">10</title>                             </block>                           </value>                           <value name="BY">                             <block type="math_number">                               <title name="NUM">1</title>                             </block>                           </value>                         </block>'+j("controls_flow_statements"))+k(d.catLogic(),j("controls_if")+j("logic_compare")+j("logic_operation")+j("logic_negate")+j("logic_boolean"))+k(d.catMath(),j("math_number")+'<block type="math_change">                           <value name="DELTA">                             <block type="math_number">                               <title name="NUM">1</title>                             </block>                           </value>                         </block><block type="math_random_int">                           <value name="FROM">                             <block type="math_number">                               <title name="NUM">1</title>                             </block>                           </value>                           <value name="TO">                             <block type="math_number">                               <title name="NUM">100</title>                             </block>                           </value>                         </block>'+j("math_arithmetic"))+k(d.catText(),j("text")+j("text_join")+'<block type="text_append">                           <value name="TEXT">                             <block type="text"></block>                           </value>                         </block>')+k(d.catVariables(),"","VARIABLE")+k(d.catProcedures(),"","PROCEDURE")+k("Functional",j("functional_string")+j("functional_background_string_picker")+j("functional_math_number")+'<block type="functional_math_number_dropdown"><title name="NUM" config="2,3,4,5,6,7,8,9,10,11,12">???</title></block>')+k("Functional Start",j("functional_start_setBackground")+j("functional_start_setSpeeds")+j("functional_start_setBackgroundAndSpeeds")+j("functional_start_dummyOnMove"))+k("Functional Logic",j("functional_greater_than")+j("functional_less_than")+j("functional_number_equals")+j("functional_string_equals")+j("functional_logical_and")+j("functional_logical_or")+j("functional_logical_not")+j("functional_boolean"))),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.full_sandbox_infinity=e.extend(m.full_sandbox,{}),m.ec_sandbox=e.extend(m.sandbox,{editCode:!0,codeFunctions:[{func:"setSprite",params:["0","'cat'"]},{func:"setBackground",params:["'night'"]},{func:"move",params:["0","1"]},{func:"playSound",params:["'slap'"]},{func:"changeScore",params:["1"]},{func:"setSpritePosition",params:["0","7"]},{func:"setSpriteSpeed",params:["0","8"]},{func:"setSpriteEmotion",params:["0","1"]},{func:"throwProjectile",params:["0","1","'blue_fireball'"]},{func:"vanish",params:["0"]},{func:"onEvent",params:["'when-left'","function() {\n  \n}"]}],startBlocks:""})},{"../../locale/current/studio":196,"../block_utils":17,"../utils":185,"./constants":150}],152:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("");var a=require("../../locale/current/common");buf.push("\n\n"),finishButton&&buf.push('\n  <div id="share-cell" class="share-cell-none">\n    <button id="finishButton" class="share">\n      <img src="',escape(assetUrl("media/1x1.gif")),'">',escape(a.finish()),"\n    </button>\n  </div>\n"),buf.push("\n")}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{"../../locale/current/common":190,ejs:206}],151:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("");var a=require("../../locale/current/common");buf.push('\n\n<div id="soft-buttons" class="soft-buttons-none">\n  <button id="leftButton" class="arrow">\n    <img src="',escape(assetUrl("media/1x1.gif")),'" class="left-btn icon21">\n  </button>\n  <button id="rightButton" class="arrow">\n    <img src="',escape(assetUrl("media/1x1.gif")),'" class="right-btn icon21">\n  </button>\n  <button id="upButton" class="arrow">\n    <img src="',escape(assetUrl("media/1x1.gif")),'" class="up-btn icon21">\n  </button>\n  <button id="downButton" class="arrow">\n    <img src="',escape(assetUrl("media/1x1.gif")),'" class="down-btn icon21">\n  </button>\n</div>\n\n'),finishButton&&buf.push('\n  <div id="share-cell" class="share-cell-none">\n    <button id="finishButton" class="share">\n      <img src="',escape(assetUrl("media/1x1.gif")),'">',escape(a.finish()),"\n    </button>\n  </div>\n"),buf.push("\n")}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{"../../locale/current/common":190,ejs:206}],149:[function(a,b){"use strict";var c=a("../StudioApp").singleton,d=a("./constants").Direction,e=function(a){for(var b in a)this[b]=a[b];this.visible=this.visible||!0,this.flags=0,this.collidingWith_={},this.frames=this.frames||1};b.exports=e,e.prototype.clearCollisions=function(){this.collidingWith_={}},e.prototype.startCollision=function(a){return this.isCollidingWith(a)?!1:(this.collidingWith_[a]=!0,!0)},e.prototype.endCollision=function(a){this.collidingWith_[a]=!1},e.prototype.isCollidingWith=function(a){return this.collidingWith_[a]===!0},e.prototype.bounce=function(){switch(this.dir){case d.NORTH:this.dir=d.SOUTH;break;case d.WEST:this.dir=d.EAST;break;case d.SOUTH:this.dir=d.NORTH;break;case d.EAST:this.dir=d.WEST}},e.prototype.outOfBounds=function(){return this.x<-(this.width/2)||this.x>c.MAZE_WIDTH+this.width/2||this.y<-(this.height/2)||this.y>c.MAZE_HEIGHT+this.height/2}},{"../StudioApp":2,"./constants":150}],148:[function(a,b,c){"use strict";function d(a){var b=o.range(0,x);return o.map(b,function(b){return[a({spriteIndex:b+1}),b.toString()]})}function e(a,b,c,d,e){a.Blocks.studio_vanish={helpUrl:"",init:function(){this.setHSV(184,1,.74),e.isK1?this.appendDummyInput().appendTitle(g.vanish()).appendTitle(new a.FieldImage(e.skin.explosionThumbnail)).appendTitle(d(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.vanishActorN),"SPRITE"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.vanishTooltip())}},b.studio_vanish=function(){var a=this.getTitleValue("SPRITE");return"Studio.vanish('block_id_"+this.id+"', "+a+");\n"}}var f=a("../StudioApp").singleton,g=a("../../locale/current/studio"),h=a("../sharedFunctionalBlocks"),i=a("../../locale/current/common"),j=(a("../codegen"),a("../functionalBlockUtils")),k=j.installFunctionalApiCallBlock,l=j.initTitledFunctionalBlock,m=a("./constants"),n=a("../utils"),o=n.getLodash(),p=m.Direction,q=m.Position,r=m.Emotions,s=m.RANDOM_VALUE,t=m.HIDDEN_VALUE,u=m.CLICK_VALUE,v=m.VISIBLE_VALUE,w=function(a){var b=a.value||a.ctx.getTitleValue("VALUE");if(b===s){var c=o(a.ctx.VALUES).map(function(a){return a[1]}).without(s,t,u);b="Studio.random(["+c+"])"}return"Studio."+a.name+"('block_id_"+a.ctx.id+"', "+(a.extraParams?a.extraParams+", ":"")+b+");\n"},x=6,y=!1,z=!1,A=!1,B=[];c.setSpriteCount=function(a,b){x=b},c.enableProjectileCollisions=function(){y=!0},c.enableEdgeCollisions=function(){z=!0},c.enableSpritesOutsidePlayspace=function(){A=!0},c.setStartAvatars=function(a){B=a.slice(0)},c.install=function(a,b){function c(b){return new a.FieldDropdown(d(b))}function m(){var b=o.range(0,x),c=o.map(b,function(a){var b=B[a];return[D[b].dropdownThumbnail,a.toString()]});return new a.FieldImageDropdown(c,D.dropdownThumbnailWidth,D.dropdownThumbnailHeight)}function u(a){var b=Blockly.JavaScript.valueToCode(a,"SPRITE",Blockly.JavaScript.ORDER_NONE)||"1";return b+"-1"}function C(a){a!==s&&f.playAudio(n.stripQuotes(a),{volume:1})}var D=b.skin,E=b.isK1,F=a.Generator.get("JavaScript");a.JavaScript=F,B=D.avatarList.slice(0),F.studio_eventHandlerPrologue=function(){return"\n"},e(a,F,c,m,b),F.studio_eventHandlerPrologue=function(){return"\n"},a.Blocks.studio_whenLeft={helpUrl:"",init:function(){this.setHSV(140,1,.74),E?this.appendDummyInput().appendTitle(i.when()).appendTitle(new Blockly.FieldImage(D.whenLeft)):this.appendDummyInput().appendTitle(g.whenLeft()),this.setPreviousStatement(!1),this.setNextStatement(!0),this.setTooltip(g.whenLeftTooltip())}},F.studio_whenLeft=F.studio_eventHandlerPrologue,a.Blocks.studio_whenRight={helpUrl:"",init:function(){this.setHSV(140,1,.74),E?this.appendDummyInput().appendTitle(i.when()).appendTitle(new Blockly.FieldImage(D.whenRight)):this.appendDummyInput().appendTitle(g.whenRight()),this.setPreviousStatement(!1),this.setNextStatement(!0),this.setTooltip(g.whenRightTooltip())}},F.studio_whenRight=F.studio_eventHandlerPrologue,a.Blocks.studio_whenUp={helpUrl:"",init:function(){this.setHSV(140,1,.74),E?this.appendDummyInput().appendTitle(i.when()).appendTitle(new Blockly.FieldImage(D.whenUp)):this.appendDummyInput().appendTitle(g.whenUp()),this.setPreviousStatement(!1),this.setNextStatement(!0),this.setTooltip(g.whenUpTooltip())}},F.studio_whenUp=F.studio_eventHandlerPrologue,a.Blocks.studio_whenDown={helpUrl:"",init:function(){this.setHSV(140,1,.74),E?this.appendDummyInput().appendTitle(i.when()).appendTitle(new Blockly.FieldImage(D.whenDown)):this.appendDummyInput().appendTitle(g.whenDown()),this.setPreviousStatement(!1),this.setNextStatement(!0),this.setTooltip(g.whenDownTooltip())}},F.studio_whenDown=F.studio_eventHandlerPrologue,a.Blocks.studio_whenArrow={helpUrl:"",init:function(){this.setHSV(140,1,.74),this.appendDummyInput().appendTitle(i.when()),E?this.appendDummyInput().appendTitle(new a.FieldImageDropdown(this.K1_VALUES),"VALUE"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.VALUES),"VALUE"),this.setPreviousStatement(!1),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.whenArrowTooltip())}},a.Blocks.studio_whenArrow.K1_VALUES=[[D.whenUp,"up"],[D.whenRight,"right"],[D.whenDown,"down"],[D.whenLeft,"left"]],a.Blocks.studio_whenArrow.VALUES=[[g.whenArrowUp(),"up"],[g.whenArrowDown(),"down"],[g.whenArrowLeft(),"left"],[g.whenArrowRight(),"right"]],F.studio_whenArrow=F.studio_eventHandlerPrologue,a.Blocks.studio_repeatForever={helpUrl:"",init:function(){this.setHSV(322,.9,.95),E?(this.appendDummyInput().appendTitle(i.repeat()),this.appendStatementInput("DO").appendTitle(new a.FieldImage(D.repeatImage))):(this.appendDummyInput().appendTitle(g.repeatForever()),this.appendStatementInput("DO").appendTitle(g.repeatDo())),this.setPreviousStatement(!1),this.setNextStatement(!1),this.setTooltip(g.repeatForeverTooltip())}},F.studio_repeatForever=function(){var a=Blockly.JavaScript.statementToCode(this,"DO");return F.studio_eventHandlerPrologue()+a},a.Blocks.studio_whenSpriteClicked={helpUrl:"",init:function(){this.setHSV(140,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.whenSpriteClickedN),"SPRITE"):this.appendDummyInput().appendTitle(g.whenSpriteClicked()),this.setPreviousStatement(!1),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.whenSpriteClickedTooltip())}},F.studio_whenSpriteClicked=F.studio_eventHandlerPrologue,a.Blocks.studio_whenSpriteCollided={helpUrl:"",init:function(){var b,e;if(this.setHSV(140,1,.74),E)b=m(),e=m(),this.appendDummyInput().appendTitle(i.when()).appendTitle(new a.FieldImage(D.collide)).appendTitle(b,"SPRITE1"),this.appendDummyInput().appendTitle(i.and()).appendTitle(e,"SPRITE2");else{b=c(g.whenSpriteCollidedN);var f=[this.GROUPINGS[0]];f=f.concat(d(g.whenSpriteCollidedWithN)),f.unshift(this.GROUPINGS[1]),y&&(f=f.concat([this.GROUPINGS[2]]),f=f.concat(this.PROJECTILES)),z&&(f=f.concat([this.GROUPINGS[3]]),f=f.concat(this.EDGES)),e=new a.FieldDropdown(f),this.appendDummyInput().appendTitle(b,"SPRITE1"),this.appendDummyInput().appendTitle(e,"SPRITE2")}x>1&&e.setValue("1"),this.setPreviousStatement(!1),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.whenSpriteCollidedTooltip())}},a.Blocks.studio_whenSpriteCollided.GROUPINGS=[[g.whenSpriteCollidedWithAnything(),"anything"],[g.whenSpriteCollidedWithAnyActor(),"any_actor"],[g.whenSpriteCollidedWithAnyProjectile(),"any_projectile"],[g.whenSpriteCollidedWithAnyEdge(),"any_edge"]],a.Blocks.studio_whenSpriteCollided.PROJECTILES=[[g.whenSpriteCollidedWithBlueFireball(),"blue_fireball"],[g.whenSpriteCollidedWithPurpleFireball(),"purple_fireball"],[g.whenSpriteCollidedWithRedFireball(),"red_fireball"],[g.whenSpriteCollidedWithYellowHearts(),"yellow_hearts"],[g.whenSpriteCollidedWithPurpleHearts(),"purple_hearts"],[g.whenSpriteCollidedWithRedHearts(),"red_hearts"]],a.Blocks.studio_whenSpriteCollided.EDGES=[[g.whenSpriteCollidedWithTopEdge(),"top"],[g.whenSpriteCollidedWithLeftEdge(),"left"],[g.whenSpriteCollidedWithBottomEdge(),"bottom"],[g.whenSpriteCollidedWithRightEdge(),"right"]],F.studio_whenSpriteCollided=F.studio_eventHandlerPrologue,a.Blocks.studio_stop={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.stopSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.stopSprite()),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.stopTooltip())}},a.Blocks.studio_stopSprite={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.stopSpriteN({spriteIndex:""})),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.stopTooltip())}},F.studio_stop=function(){return"Studio.stop('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+");\n"},F.studio_stopSprite=function(){var a=u(this);return"Studio.stop('block_id_"+this.id+"', "+a+");\n"},a.Blocks.studio_throw={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.throwSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.throwSprite()),this.appendDummyInput().appendTitle(new a.FieldDropdown(D.projectileChoices),"VALUE"),this.appendDummyInput().appendTitle("	"),this.appendDummyInput().appendTitle(new a.FieldDropdown(this.DIR),"DIR"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.throwTooltip())}},a.Blocks.studio_throw.DIR=[[g.moveDirectionUp(),p.NORTH.toString()],[g.moveDirectionDown(),p.SOUTH.toString()],[g.moveDirectionLeft(),p.WEST.toString()],[g.moveDirectionRight(),p.EAST.toString()],[g.moveDirectionRandom(),"random"]],F.studio_throw=function(){var a=this.DIR.slice(0,-1).map(function(a){return a[1]}),b=this.getTitleValue("DIR");"random"===b&&(b="Studio.random(["+a+"])");var c=D.projectileChoices.slice(0,-1).map(function(a){return a[1]}),d=this.getTitleValue("VALUE");return"random"===d&&(d="Studio.random(["+c+"])"),"Studio.throwProjectile('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+b+", "+d+");\n"},a.Blocks.studio_makeProjectile={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendDummyInput().appendTitle(new a.FieldDropdown(this.VALUES),"VALUE"),this.appendDummyInput().appendTitle("	"),this.appendDummyInput().appendTitle(new a.FieldDropdown(this.ACTIONS),"ACTION"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.makeProjectileTooltip())}},a.Blocks.studio_makeProjectile.VALUES=[[g.makeProjectileBlueFireball(),'"blue_fireball"'],[g.makeProjectilePurpleFireball(),'"purple_fireball"'],[g.makeProjectileRedFireball(),'"red_fireball"'],[g.makeProjectileYellowHearts(),'"yellow_hearts"'],[g.makeProjectilePurpleHearts(),'"purple_hearts"'],[g.makeProjectileRedHearts(),'"red_hearts"']],a.Blocks.studio_makeProjectile.ACTIONS=[[g.makeProjectileBounce(),'"bounce"'],[g.makeProjectileDisappear(),'"disappear"']],F.studio_makeProjectile=function(){return"Studio.makeProjectile('block_id_"+this.id+"', "+this.getTitleValue("VALUE")+", "+this.getTitleValue("ACTION")+");\n"},a.Blocks.studio_setSpritePosition={helpUrl:"",init:function(){var b;A?(b=new a.FieldDropdown(this.VALUES_EXTENDED),b.setValue(this.VALUES_EXTENDED[4][1])):(b=new a.FieldDropdown(this.VALUES),b.setValue(this.VALUES[1][1])),this.setHSV(184,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),this.appendDummyInput().appendTitle(b,"VALUE"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.setSpritePositionTooltip())
}},a.Blocks.studio_setSpritePosition.VALUES=[[g.positionRandom(),s],[g.positionTopLeft(),q.TOPLEFT.toString()],[g.positionTopCenter(),q.TOPCENTER.toString()],[g.positionTopRight(),q.TOPRIGHT.toString()],[g.positionMiddleLeft(),q.MIDDLELEFT.toString()],[g.positionMiddleCenter(),q.MIDDLECENTER.toString()],[g.positionMiddleRight(),q.MIDDLERIGHT.toString()],[g.positionBottomLeft(),q.BOTTOMLEFT.toString()],[g.positionBottomCenter(),q.BOTTOMCENTER.toString()],[g.positionBottomRight(),q.BOTTOMRIGHT.toString()]],a.Blocks.studio_setSpritePosition.VALUES_EXTENDED=[[g.positionRandom(),s],[g.positionOutTopLeft(),q.OUTTOPLEFT.toString()],[g.positionOutTopRight(),q.OUTTOPRIGHT.toString()],[g.positionTopOutLeft(),q.TOPOUTLEFT.toString()],[g.positionTopLeft(),q.TOPLEFT.toString()],[g.positionTopCenter(),q.TOPCENTER.toString()],[g.positionTopRight(),q.TOPRIGHT.toString()],[g.positionTopOutRight(),q.TOPOUTRIGHT.toString()],[g.positionMiddleLeft(),q.MIDDLELEFT.toString()],[g.positionMiddleCenter(),q.MIDDLECENTER.toString()],[g.positionMiddleRight(),q.MIDDLERIGHT.toString()],[g.positionBottomOutLeft(),q.BOTTOMOUTLEFT.toString()],[g.positionBottomLeft(),q.BOTTOMLEFT.toString()],[g.positionBottomCenter(),q.BOTTOMCENTER.toString()],[g.positionBottomRight(),q.BOTTOMRIGHT.toString()],[g.positionBottomOutRight(),q.BOTTOMOUTRIGHT.toString()],[g.positionOutBottomLeft(),q.OUTBOTTOMLEFT.toString()],[g.positionOutBottomRight(),q.OUTBOTTOMRIGHT.toString()]],F.studio_setSpritePosition=function(){return w({ctx:this,extraParams:this.getTitleValue("SPRITE")||"0",name:"setSpritePosition"})},a.Blocks.studio_setSpriteXY={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.moveSpriteN({spriteIndex:""})):this.appendDummyInput().appendTitle(g.setSprite()),this.appendDummyInput().appendTitle(g.toXY()),this.appendValueInput("XPOS").setCheck("Number"),this.appendValueInput("YPOS").setCheck("Number"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0)}},F.studio_setSpriteXY=function(){var a=u(this),b=Blockly.JavaScript.valueToCode(this,"XPOS",Blockly.JavaScript.ORDER_NONE)||"0",c=Blockly.JavaScript.valueToCode(this,"YPOS",Blockly.JavaScript.ORDER_NONE)||"0";return"Studio.setSpriteXY('block_id_"+this.id+"', "+a+", "+b+", "+c+");\n"};var G={DIRECTION_CONFIGS:{West:{letter:i.directionWestLetter(),image:D.leftArrow,studioValue:p.WEST.toString(),tooltip:g.moveLeftTooltip()},East:{letter:i.directionEastLetter(),image:D.rightArrow,studioValue:p.EAST.toString(),tooltip:g.moveRightTooltip()},North:{letter:i.directionNorthLetter(),image:D.upArrow,studioValue:p.NORTH.toString(),tooltip:g.moveUpTooltip()},South:{letter:i.directionSouthLetter(),image:D.downArrow,studioValue:p.SOUTH.toString(),tooltip:g.moveDownTooltip()}},DISTANCES:[[D.shortLine,"25"],[D.longLine,"400"]],DEFAULT_MOVE_DISTANCE:"100",generateBlocksForAllDirections:function(){G.generateBlocksForDirection("North"),G.generateBlocksForDirection("South"),G.generateBlocksForDirection("West"),G.generateBlocksForDirection("East")},generateBlocksForDirection:function(b){F["studio_move"+b]=G.generateCodeGenerator(b,!0),a.Blocks["studio_move"+b]=G.generateMoveBlock(b,!1),F["studio_move"+b+"Distance"]=G.generateCodeGenerator(b,!1),a.Blocks["studio_move"+b+"Distance"]=G.generateMoveBlock(b,!1),F["studio_move"+b+"_length"]=G.generateCodeGenerator(b,!1),a.Blocks["studio_move"+b+"_length"]=G.generateMoveBlock(b,!0)},generateMoveBlock:function(b,c){var d=G.DIRECTION_CONFIGS[b];return{helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendDummyInput().appendTitle(g.moveSprite()).appendTitle(new a.FieldImage(d.image)).appendTitle(d.letter),x>1&&this.appendDummyInput().appendTitle(m(),"SPRITE"),c&&this.appendDummyInput().appendTitle(new a.FieldImageDropdown(G.DISTANCES),"DISTANCE"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(d.tooltip)}}},generateCodeGenerator:function(a,b){var c=G.DIRECTION_CONFIGS[a];return function(){var a=this.getTitleValue("SPRITE")||"0",d=c.studioValue,e=b?"move":"moveDistance",f=this.getTitleValue("DISTANCE")||G.DEFAULT_MOVE_DISTANCE;return"Studio."+e+"('block_id_"+this.id+"', "+a+", "+d+(b?"":", "+f)+");\n"}}};G.generateBlocksForAllDirections(),a.Blocks.studio_move={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?(E?this.appendDummyInput().appendTitle(g.moveSprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.moveSpriteN),"SPRITE"),this.appendDummyInput().appendTitle("	")):this.appendDummyInput().appendTitle(g.moveSprite()),E?this.appendDummyInput().appendTitle(new a.FieldImageDropdown(this.K1_DIR),"DIR"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.DIR),"DIR"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.moveTooltip())}},a.Blocks.studio_move.K1_DIR=[[D.upArrow,p.NORTH.toString()],[D.rightArrow,p.EAST.toString()],[D.downArrow,p.SOUTH.toString()],[D.leftArrow,p.WEST.toString()]],a.Blocks.studio_move.DIR=[[g.moveDirectionUp(),p.NORTH.toString()],[g.moveDirectionDown(),p.SOUTH.toString()],[g.moveDirectionLeft(),p.WEST.toString()],[g.moveDirectionRight(),p.EAST.toString()]],F.studio_move=function(){return"Studio.move('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+this.getTitleValue("DIR")+");\n"};var H=function(b){var d={};return d.helpUrl="",d.init=function(){this.setHSV(184,1,.74),b.sprite?this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.moveSpriteN({spriteIndex:""})):x>1?(E?this.appendDummyInput().appendTitle(g.moveSprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.moveSpriteN),"SPRITE"),this.appendDummyInput().appendTitle("	")):this.appendDummyInput().appendTitle(g.moveSprite()),E?this.appendDummyInput().appendTitle(new a.FieldImageDropdown(this.K1_DIR),"DIR"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.DIR),"DIR"),this.appendDummyInput().appendTitle("	"),b.params?(this.appendValueInput("DISTANCE").setCheck("Number"),this.appendDummyInput().appendTitle(g.moveDistancePixels())):E?this.appendDummyInput().appendTitle(new a.FieldImageDropdown(this.K1_DISTANCE),"DISTANCE"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.DISTANCE),"DISTANCE"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.moveDistanceTooltip())},d.K1_DIR=[[D.upArrow,p.NORTH.toString()],[D.rightArrow,p.EAST.toString()],[D.downArrow,p.SOUTH.toString()],[D.leftArrow,p.WEST.toString()]],d.DIR=[[g.moveDirectionUp(),p.NORTH.toString()],[g.moveDirectionDown(),p.SOUTH.toString()],[g.moveDirectionLeft(),p.WEST.toString()],[g.moveDirectionRight(),p.EAST.toString()],[g.moveDirectionRandom(),"random"]],b.params||(d.DISTANCE=[[g.moveDistance25(),"25"],[g.moveDistance50(),"50"],[g.moveDistance100(),"100"],[g.moveDistance200(),"200"],[g.moveDistance400(),"400"],[g.moveDistanceRandom(),"random"]],d.K1_DISTANCE=[[D.shortLine,"25"],[D.longLine,"400"]]),d};a.Blocks.studio_moveDistance=H({}),a.Blocks.studio_moveDistanceParams=H({params:!0}),a.Blocks.studio_moveDistanceParamsSprite=H({params:!0,sprite:!0}),F.studio_moveDistance=function(){var a=this.DISTANCE.slice(0,-1).map(function(a){return a[1]}),b=this.getTitleValue("DISTANCE");"random"===b&&(b="Studio.random(["+a+"])");var c=this.DIR.slice(0,-1).map(function(a){return a[1]}),d=this.getTitleValue("DIR");return"random"===d&&(d="Studio.random(["+c+"])"),"Studio.moveDistance('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+d+", "+b+");\n"},F.studio_moveDistanceParams=function(){var a=this.DIR.slice(0,-1).map(function(a){return a[1]}),b=this.getTitleValue("DIR");"random"===b&&(b="Studio.random(["+a+"])");var c=Blockly.JavaScript.valueToCode(this,"DISTANCE",Blockly.JavaScript.ORDER_NONE)||"0";return"Studio.moveDistance('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+b+", "+c+");\n"},F.studio_moveDistanceParamsSprite=function(){var a=u(this),b=this.DIR.slice(0,-1).map(function(a){return a[1]}),c=this.getTitleValue("DIR");"random"===c&&(c="Studio.random(["+b+"])");var d=Blockly.JavaScript.valueToCode(this,"DISTANCE",Blockly.JavaScript.ORDER_NONE)||"0";return"Studio.moveDistance('block_id_"+this.id+"', "+a+", "+c+", "+d+");\n"},a.Blocks.studio_playSound={helpUrl:"",init:function(){this.setHSV(184,1,.74),E?this.appendDummyInput().appendTitle(i.play()).appendTitle(new a.FieldImage(D.soundIcon)).appendTitle(new a.FieldDropdown(this.K1_SOUNDS,C),"SOUND"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.SOUNDS,C),"SOUND"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.playSoundTooltip())}},a.Blocks.studio_playSound.K1_SOUNDS=[[g.soundHit(),"hit"],[g.soundWood(),"wood"],[g.soundRetro(),"retro"],[g.soundSlap(),"slap"],[g.soundRubber(),"rubber"],[g.soundCrunch(),"crunch"],[g.soundWinPoint(),"winpoint"],[g.soundWinPoint2(),"winpoint2"],[g.soundLosePoint(),"losepoint"],[g.soundLosePoint2(),"losepoint2"],[g.soundGoal1(),"goal1"],[g.soundGoal2(),"goal2"]],a.Blocks.studio_playSound.SOUNDS=[[g.playSoundHit(),"hit"],[g.playSoundWood(),"wood"],[g.playSoundRetro(),"retro"],[g.playSoundSlap(),"slap"],[g.playSoundRubber(),"rubber"],[g.playSoundCrunch(),"crunch"],[g.playSoundWinPoint(),"winpoint"],[g.playSoundWinPoint2(),"winpoint2"],[g.playSoundLosePoint(),"losepoint"],[g.playSoundLosePoint2(),"losepoint2"],[g.playSoundGoal1(),"goal1"],[g.playSoundGoal2(),"goal2"]],F.studio_playSound=function(){return"Studio.playSound('block_id_"+this.id+"', '"+this.getTitleValue("SOUND")+"');\n"},a.Blocks.studio_changeScore={helpUrl:"",init:function(){this.setHSV(184,1,.74),E?this.appendDummyInput().appendTitle(i.score()).appendTitle(new a.FieldImage(D.scoreCard)):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.VALUES),"VALUE"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(E?g.changeScoreTooltipK1():g.changeScoreTooltip())}},a.Blocks.studio_changeScore.VALUES=[[g.incrementPlayerScore(),"1"],[g.decrementPlayerScore(),"-1"]],F.studio_changeScore=function(){return"Studio.changeScore('block_id_"+this.id+"', '"+(this.getTitleValue("VALUE")||"1")+"');\n"},a.Blocks.studio_setScoreText={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("TEXT").appendTitle(g.setScoreText()),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setScoreTextTooltip())}},F.studio_setScoreText=function(){var a=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"";return"Studio.setScoreText('block_id_"+this.id+"', "+a+");\n"},a.Blocks.studio_showCoordinates={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendDummyInput().appendTitle(g.showCoordinates()),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.showCoordinatesTooltip())}},F.studio_showCoordinates=function(){return"Studio.showCoordinates('block_id_"+this.id+"');\n"},a.Blocks.studio_setSpriteSpeed={helpUrl:"",init:function(){if(this.setHSV(184,1,.74),x>1?E?this.appendDummyInput().appendTitle(g.setSprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),E){var b=new a.FieldImageDropdown(this.K1_VALUES);b.setValue(this.K1_VALUES[1][1]),this.appendDummyInput().appendTitle(g.speed()).appendTitle(b,"VALUE")}else{var d=new a.FieldDropdown(this.VALUES);d.setValue(this.VALUES[3][1]),this.appendDummyInput().appendTitle(d,"VALUE")}this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteSpeedTooltip())}},a.Blocks.studio_setSpriteSpeedParams={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.setSpriteN({spriteIndex:""})),this.appendValueInput("VALUE").setCheck("Number").appendTitle(g.speed()),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteSpeedTooltip())}},a.Blocks.studio_setSpriteSpeed.K1_VALUES=[[D.speedSlow,"Studio.SpriteSpeed.SLOW"],[D.speedMedium,"Studio.SpriteSpeed.NORMAL"],[D.speedFast,"Studio.SpriteSpeed.FAST"]],a.Blocks.studio_setSpriteSpeed.VALUES=[[g.setSpriteSpeedRandom(),s],[g.setSpriteSpeedVerySlow(),"Studio.SpriteSpeed.VERY_SLOW"],[g.setSpriteSpeedSlow(),"Studio.SpriteSpeed.SLOW"],[g.setSpriteSpeedNormal(),"Studio.SpriteSpeed.NORMAL"],[g.setSpriteSpeedFast(),"Studio.SpriteSpeed.FAST"],[g.setSpriteSpeedVeryFast(),"Studio.SpriteSpeed.VERY_FAST"]],F.studio_setSpriteSpeed=function(){return w({ctx:this,extraParams:this.getTitleValue("SPRITE")||"0",name:"setSpriteSpeed"})},F.studio_setSpriteSpeedParams=function(){var a=u(this),b=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE)||"5";return"Studio.setSpriteSpeed('block_id_"+this.id+"', "+a+","+b+");\n"},a.Blocks.studio_setSpriteSize={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite());var b=new a.FieldDropdown(this.VALUES);b.setValue(this.VALUES[3][1]),this.appendDummyInput().appendTitle(b,"VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteSizeTooltip())}},a.Blocks.studio_setSpriteSizeParams={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.setSpriteN({spriteIndex:""})),this.appendValueInput("VALUE").setCheck("Number").appendTitle(g.size()),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteSizeTooltip())}},a.Blocks.studio_setSpriteSize.VALUES=[[g.setSpriteSizeRandom(),s],[g.setSpriteSizeVerySmall(),"Studio.SpriteSize.VERY_SMALL"],[g.setSpriteSizeSmall(),"Studio.SpriteSize.SMALL"],[g.setSpriteSizeNormal(),"Studio.SpriteSize.NORMAL"],[g.setSpriteSizeLarge(),"Studio.SpriteSize.LARGE"],[g.setSpriteSizeVeryLarge(),"Studio.SpriteSize.VERY_LARGE"]],F.studio_setSpriteSize=function(){return w({ctx:this,extraParams:this.getTitleValue("SPRITE")||"0",name:"setSpriteSize"})},F.studio_setSpriteSizeParams=function(){var a=u(this),b=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE)||"5";return"Studio.setSpriteSize('block_id_"+this.id+"', "+a+","+b+");\n"},a.Blocks.studio_setBackground={helpUrl:"",init:function(){this.setHSV(312,.32,.62),this.VALUES=[];var b;E?(this.VALUES=D.backgroundChoicesK1,b=new a.FieldImageDropdown(D.backgroundChoicesK1,D.dropdownThumbnailWidth,D.dropdownThumbnailHeight),this.appendDummyInput().appendTitle(g.setBackground()).appendTitle(b,"VALUE")):(this.VALUES=D.backgroundChoices,b=new a.FieldDropdown(D.backgroundChoices),this.appendDummyInput().appendTitle(b,"VALUE")),b.setValue('"'+D.defaultBackground+'"'),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setBackgroundTooltip())}},a.Blocks.studio_setBackgroundParam={helpUrl:"",init:function(){this.setHSV(312,.32,.62),this.VALUES=D.backgroundChoices,this.appendDummyInput().appendTitle(g.setBackground()),this.appendValueInput("VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setBackgroundTooltip())}},F.studio_setBackground=function(){return w({ctx:this,name:"setBackground"})},F.studio_setBackgroundParam=function(){var b=a.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE);return w({value:b,ctx:this,name:"setBackground"})};var I=function(a){var b={};return b.helpUrl="",b.init=function(){this.setHSV(184,1,.74),this.appendDummyInput().appendTitle(g.showTitleScreen()),a.params?(this.appendValueInput("TITLE").setCheck("String").setAlign(Blockly.ALIGN_RIGHT).appendTitle(g.showTitleScreenTitle()),this.appendValueInput("TEXT").setCheck("String").setAlign(Blockly.ALIGN_RIGHT).appendTitle(g.showTitleScreenText())):(this.appendDummyInput().appendTitle(g.showTitleScreenTitle()).appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote0.png"),12,12)).appendTitle(new Blockly.FieldTextInput(g.showTSDefTitle()),"TITLE").appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote1.png"),12,12)),this.appendDummyInput().appendTitle(g.showTitleScreenText()).appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote0.png"),12,12)).appendTitle(new Blockly.FieldTextInput(g.showTSDefText()),"TEXT").appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote1.png"),12,12))),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.showTitleScreenTooltip())},b};a.Blocks.studio_showTitleScreen=I({}),a.Blocks.studio_showTitleScreenParams=I({params:!0}),F.studio_showTitleScreen=function(){return"Studio.showTitleScreen('block_id_"+this.id+"', "+a.JavaScript.quote_(this.getTitleValue("TITLE"))+", "+a.JavaScript.quote_(this.getTitleValue("TEXT"))+");\n"},F.studio_showTitleScreenParams=function(){var a=Blockly.JavaScript.valueToCode(this,"TITLE",Blockly.JavaScript.ORDER_NONE)||"",b=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"";return"Studio.showTitleScreen('block_id_"+this.id+"', "+a+", "+b+");\n"},E?(a.Blocks.studio_setSprite={helpUrl:"",init:function(){this.setHSV(312,.32,.62);var b=new a.FieldDropdown(this.VALUES);b.setValue(v),this.appendDummyInput().appendTitle(b,"VALUE"),x>1&&this.appendDummyInput().appendTitle(m(),"SPRITE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteK1Tooltip())}},a.Blocks.studio_setSprite.VALUES=[[g.setSpriteHideK1(),t],[g.setSpriteShowK1(),v]]):(a.Blocks.studio_setSprite={helpUrl:"",init:function(){this.VALUES=D.spriteChoices;var b=new a.FieldDropdown(D.spriteChoices);b.setValue(D.spriteChoices[2][1]),this.setHSV(312,.32,.62),x>1?this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),this.appendDummyInput().appendTitle(b,"VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteTooltip())}},a.Blocks.studio_setSpriteParams={helpUrl:"",init:function(){var b=new a.FieldDropdown(D.spriteChoices);b.setValue(D.spriteChoices[2][1]),this.setHSV(312,.32,.62),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.setSpriteN({spriteIndex:""})),this.appendDummyInput().appendTitle(b,"VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteTooltip())}},a.Blocks.studio_setSpriteParamValue={helpUrl:"",init:function(){this.setHSV(312,.32,.62),x>1?this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),this.appendValueInput("VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteTooltip())}}),F.studio_setSprite=function(){var a=this.getTitleValue("SPRITE")||"0";return w({ctx:this,extraParams:a,name:"setSprite"})},F.studio_setSpriteParams=function(){var a=u(this);return w({ctx:this,extraParams:a,name:"setSprite"})},F.studio_setSpriteParamValue=function(){var b=this.getTitleValue("SPRITE")||"0",c=a.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE);return w({value:c,ctx:this,extraParams:b,name:"setSprite"})},a.Blocks.studio_setSpriteEmotion={helpUrl:"",init:function(){if(this.setHSV(184,1,.74),x>1?E?this.appendDummyInput().appendTitle(g.setSprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),E){var b=new a.FieldImageDropdown(this.K1_VALUES,34,34);b.setValue(this.K1_VALUES[0][1]),this.appendDummyInput().appendTitle(g.emotion()).appendTitle(b,"VALUE")}else{var d=new a.FieldDropdown(this.VALUES);d.setValue(this.VALUES[1][1]),this.appendDummyInput().appendTitle(d,"VALUE")}this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteEmotionTooltip())}},a.Blocks.studio_setSpriteEmotionParams={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.setSpriteN({spriteIndex:""}));var b=new a.FieldDropdown(this.VALUES);b.setValue(this.VALUES[1][1]),this.appendDummyInput().appendTitle(b,"VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteEmotionTooltip())}},a.Blocks.studio_setSpriteEmotion.VALUES=a.Blocks.studio_setSpriteEmotionParams.VALUES=[[g.setSpriteEmotionRandom(),s],[g.setSpriteEmotionNormal(),r.NORMAL.toString()],[g.setSpriteEmotionHappy(),r.HAPPY.toString()],[g.setSpriteEmotionAngry(),r.ANGRY.toString()],[g.setSpriteEmotionSad(),r.SAD.toString()]],a.Blocks.studio_setSpriteEmotion.K1_VALUES=[[D.emotionNormal,r.NORMAL.toString()],[D.emotionHappy,r.HAPPY.toString()],[D.emotionAngry,r.ANGRY.toString()],[D.emotionSad,r.SAD.toString()],[D.randomPurpleIcon,s]],F.studio_setSpriteEmotion=function(){return w({ctx:this,extraParams:this.getTitleValue("SPRITE")||"0",name:"setSpriteEmotion"})},F.studio_setSpriteEmotionParams=function(){var a=u(this);return w({ctx:this,extraParams:a,name:"setSpriteEmotion"})};var J=function(b){var d={};return d.helpUrl="",d.init=function(){if(this.setHSV(184,1,.74),b.time?(this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.actor()),this.appendDummyInput().appendTitle(g.saySprite())):x>1?E?this.appendDummyInput().appendTitle(g.saySprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.saySpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.saySprite()),b.restrictedDialog){var d=new a.FieldDropdown([[g.saySpriteChoices_1(),g.saySpriteChoices_1()],[g.saySpriteChoices_2(),g.saySpriteChoices_2()],[g.saySpriteChoices_3(),g.saySpriteChoices_3()]]);this.appendDummyInput().appendTitle(d,"VALUE")}else if(b.params)this.appendValueInput("TEXT");else{var e=this.appendDummyInput();E&&e.appendTitle(new Blockly.FieldImage(D.speechBubble)),e.appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote0.png"),12,12)).appendTitle(new Blockly.FieldTextInput(g.defaultSayText()),"TEXT").appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote1.png"),12,12))}b.time&&(this.appendValueInput("TIME").setCheck("Number").appendTitle(g["for"]()),this.appendDummyInput().appendTitle(g.waitSeconds())),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.saySpriteTooltip())},d};a.Blocks.studio_saySprite=J({}),a.Blocks.studio_saySpriteChoices=J({restrictedDialog:!0}),a.Blocks.studio_saySpriteParams=J({params:!0}),a.Blocks.studio_saySpriteParamsTime=J({params:!0,time:!0}),F.studio_saySprite=function(){return"Studio.saySprite('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+a.JavaScript.quote_(this.getTitleValue("TEXT"))+");\n"},F.studio_saySpriteChoices=function(){return"Studio.saySprite('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", '"+this.getTitles()[1].getValue()+"');\n"},F.studio_saySpriteParams=function(){var a=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"";return"Studio.saySprite('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+a+");\n"},F.studio_saySpriteParamsTime=function(){var a=u(this),b=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"",c=Blockly.JavaScript.valueToCode(this,"TIME",Blockly.JavaScript.ORDER_NONE)||1;return"Studio.saySprite('block_id_"+this.id+"', "+a+", "+b+","+c+");\n"};var K=function(b){var c={};return c.helpUrl="",c.init=function(){if(this.setHSV(184,1,.74),b.params)this.appendDummyInput().appendTitle(g.waitFor()),this.appendValueInput("VALUE").setCheck("Number"),this.appendDummyInput().appendTitle(g.waitSeconds());else{var c=new a.FieldDropdown(this.VALUES);c.setValue(this.VALUES[2][1]),this.appendDummyInput().appendTitle(c,"VALUE")}this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(b.params?g.waitParamsTooltip():g.waitTooltip())},b.params||(c.VALUES=[[g.waitForClick(),'"click"'],[g.waitForRandom(),"random"],[g.waitForHalfSecond(),"500"],[g.waitFor1Second(),"1000"],[g.waitFor2Seconds(),"2000"],[g.waitFor5Seconds(),"5000"],[g.waitFor10Seconds(),"10000"]]),c};a.Blocks.studio_wait=K({}),a.Blocks.studio_waitParams=K({params:!0}),F.studio_wait=function(){return w({ctx:this,name:"wait"})},F.studio_waitParams=function(){var a=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE)||"0";return"Studio.wait('block_id_"+this.id+"', ("+a+" * 1000));\n"},a.Blocks.functional_start_setValue={init:function(){var a=g.startSetValue(),b="none",c=[{name:"VALUE",type:"function"}];l(this,a,b,c)}},F.functional_start_setValue=function(){},a.Blocks.functional_start_setVars={init:function(){var a=g.startSetVars(),b="none",c=[{name:"title",type:"string"},{name:"subtitle",type:"string"},{name:"background",type:"image"},{name:"player",type:"image"},{name:"target",type:"image"},{name:"danger",type:"image"}];l(this,a,b,c)}},F.functional_start_setVars=function(){},a.Blocks.functional_start_setFuncs={init:function(){var a=g.startSetFuncs(),b="none",c=[{name:"update-target",type:"function"},{name:"update-danger",type:"function"},{name:"update-player",type:"function"},{name:"collide?",type:"function"},{name:"on-screen?",type:"function"}];l(this,a,b,c)}},F.functional_start_setFuncs=function(){this.inputList.forEach(function(a){if(a.type===Blockly.FUNCTIONAL_INPUT){var b=this.getInputTargetBlock(a.name);if(b){var c=b.getTitleValue("NAME"),d=Blockly.JavaScript.variableDB_.getName(c,Blockly.Procedures.NAME_TYPE);Studio.customLogic.functionNames[a.name]=d}}},this)},k(a,F,{blockName:"functional_start_dummyOnMove",blockTitle:"on-move (on-screen)",args:[{name:"VAL",type:"function"}]}),k(a,F,{blockName:"functional_start_setBackground",blockTitle:"start (background)",apiName:"Studio.setBackground",args:[{name:"BACKGROUND",type:"string","default":"space"}]}),a.Blocks.functional_start_setSpeeds={init:function(){var a="start (player-speed, enemy-speed)",b="none",c=[{name:"PLAYER_SPEED",type:"Number"},{name:"ENEMY_SPEED",type:"Number"}];l(this,a,b,c)}},F.functional_start_setSpeeds=function(){var a=7,b=Blockly.JavaScript.statementToCode(this,"PLAYER_SPEED",!1)||a,c=Blockly.JavaScript.statementToCode(this,"ENEMY_SPEED",!1)||a,d="0",e="1",f="Studio.setSpriteSpeed('block_id_"+this.id+"',"+d+","+b+");\n";return f+="Studio.setSpriteSpeed('block_id_"+this.id+"',"+e+","+c+");\n"},a.Blocks.functional_start_setBackgroundAndSpeeds={init:function(){var a="start (background, player-speed, enemy-speed)",b="none",c=[{name:"BACKGROUND",type:"string"},{name:"PLAYER_SPEED",type:"Number"},{name:"ENEMY_SPEED",type:"Number"}];l(this,a,b,c)}},F.functional_start_setBackgroundAndSpeeds=function(){var a=Blockly.JavaScript.statementToCode(this,"BACKGROUND",!1)||"cave",b=7,c=Blockly.JavaScript.statementToCode(this,"PLAYER_SPEED",!1)||b,d=Blockly.JavaScript.statementToCode(this,"ENEMY_SPEED",!1)||b,e="Studio.setBackground('block_id_"+this.id+"',"+a+");\n";return e+="Studio.setSpriteSpeed('block_id_"+this.id+"',0,"+c+");\n",e+="Studio.setSpriteSpeed('block_id_"+this.id+"',1,"+d+");\n"},h.install(a,F);var L=D.backgroundChoices.slice(1);j.installStringPicker(a,F,{blockName:"functional_background_string_picker",values:L}),a.Blocks.studio_vanishSprite={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.vanishActorN({spriteIndex:""})),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.vanishTooltip())}},F.studio_vanishSprite=function(){var a=u(this);return"Studio.vanish('block_id_"+this.id+"', "+a+");\n"},a.Blocks.functional_sprite_dropdown={helpUrl:"",init:function(){this.setHSV.apply(this,j.colors.image),this.VALUES=D.spriteChoices;var b=o.map(B,function(a){return[D[a].dropdownThumbnail,a]}),c=new a.FieldImageDropdown(b,D.dropdownThumbnailWidth,D.dropdownThumbnailHeight);this.appendDummyInput().appendTitle(c,"SPRITE_INDEX"),this.setFunctionalOutput(!0)}},F.functional_sprite_dropdown=function(){return a.JavaScript.quote_(this.getTitleValue("SPRITE_INDEX"))},a.Blocks.functional_background_dropdown={helpUrl:"",init:function(){this.setHSV.apply(this,j.colors.image),this.VALUES=D.backgroundChoicesK1;var b=new a.FieldImageDropdown(D.backgroundChoicesK1,D.dropdownThumbnailWidth,D.dropdownThumbnailHeight);this.appendDummyInput().appendTitle(b,"BACKGROUND"),this.setFunctionalOutput(!0)}},F.functional_background_dropdown=function(){return this.getTitleValue("BACKGROUND")},a.Blocks.functional_sqrt={helpUrl:"",init:function(){l(this,"sqrt","Number",[{name:"ARG1",type:"Number"}])}},F.functional_sqrt=function(){var a=Blockly.JavaScript.statementToCode(this,"ARG1",!1)||0;return"Math.sqrt("+a+");"},a.Blocks.functional_keydown={helpUrl:"",init:function(){l(this,"keydown?","boolean",[{name:"ARG1",type:"Number"}])}},F.functional_keydown=function(){var a=Blockly.JavaScript.statementToCode(this,"ARG1",!1)||-1;return"Studio.isKeyDown("+a+");"}}},{"../../locale/current/common":190,"../../locale/current/studio":196,"../StudioApp":2,"../codegen":42,"../functionalBlockUtils":74,"../sharedFunctionalBlocks":143,"../utils":185,"./constants":150}],196:[function(a,b){b.exports=window.blockly.appLocale},{}],147:[function(a,b){var c=a("./constants").Direction,d=function(a){this.studio_=a,this.functionNames={},this.playerSpriteIndex=0,this.targetSpriteIndex=1,this.dangerSpriteIndex=2};d.prototype.onTick=function(){var a=document.getElementById("titleScreenTitle");if(!(this.studio_.tickCount<=1||"visible"===a.getAttribute("visibility"))){this.updateSpriteX_(this.targetSpriteIndex,this.update_target.bind(this)),this.updateSpriteX_(this.dangerSpriteIndex,this.update_danger.bind(this));for(var b in this.studio_.keyState)"keydown"===this.studio_.keyState[b]&&this.updatePlayer_(b);for(var c in this.studio_.btnState)this.studio_.btnState[c]&&("leftButton"===c?this.updatePlayer_(37):"upButton"===c?this.updatePlayer_(38):"rightButton"===c?this.updatePlayer_(39):"downButton"===c&&this.updatePlayer_(40))}},d.prototype.updateSpriteX_=function(a,b){var d=this.studio_.sprite[a],e=d.x+d.width/2,f=b(e);d.x=f-d.width/2,this.onscreen(f)||(d.x=d.dir===c.EAST?0-d.width:this.studio_.MAZE_WIDTH,d.y=Math.floor(Math.random()*(this.studio_.MAZE_HEIGHT-d.height)))},d.prototype.updatePlayer_=function(a){var b=this.studio_.sprite[this.playerSpriteIndex],c=this.studio_.MAZE_HEIGHT-b.y,d=this.update_player(a,c);b.y=this.studio_.MAZE_HEIGHT-d},d.prototype.update_target=function(a){return this.getPassedFunction_("update-target")(a)},d.prototype.update_danger=function(a){return this.getPassedFunction_("update-danger")(a)},d.prototype.update_player=function(a,b){return this.getPassedFunction_("update-player")(a,b)},d.prototype.onscreen=function(a){return this.getPassedFunction_("on-screen?")(a)},d.prototype.collide=function(a,b,c,d){return this.getPassedFunction_("collide?")(a,b,c,d)},d.prototype.getPassedFunction_=function(a){var b=this.functionNames[a];if(!b)return function(){};var c=this.studio_.Globals[b];if(!c)throw new Error("Unexepcted");return c},b.exports=d},{"./constants":150}],146:[function(a,b,c){a("./constants");c.SpriteSpeed={VERY_SLOW:2,SLOW:3,NORMAL:5,FAST:8,VERY_FAST:12},c.SpriteSize={VERY_SMALL:.5,SMALL:.75,NORMAL:1,LARGE:1.5,VERY_LARGE:2};var d=3;c.random=function(a){var b=Math.floor(Math.random()*a.length);return a[b]},c.setBackground=function(a,b){Studio.queueCmd(a,"setBackground",{value:b})},c.setSprite=function(a,b,c){Studio.queueCmd(a,"setSprite",{spriteIndex:b,value:c})},c.saySprite=function(a,b,c,e){void 0===e&&(e=d),Studio.queueCmd(a,"saySprite",{spriteIndex:b,text:c,seconds:e})},c.showTitleScreen=function(a,b,c){Studio.queueCmd(a,"showTitleScreen",{title:b,text:c})},c.setSpriteEmotion=function(a,b,c){Studio.queueCmd(a,"setSpriteEmotion",{spriteIndex:b,value:c})
},c.setSpriteSpeed=function(a,b,c){Studio.queueCmd(a,"setSpriteSpeed",{spriteIndex:b,value:c})},c.setSpriteSize=function(a,b,c){Studio.queueCmd(a,"setSpriteSize",{spriteIndex:b,value:c})},c.setSpritePosition=function(a,b,c){Studio.queueCmd(a,"setSpritePosition",{spriteIndex:b,value:Number(c)})},c.setSpriteXY=function(a,b,c,d){Studio.queueCmd(a,"setSpriteXY",{spriteIndex:b,x:Number(c),y:Number(d)})},c.playSound=function(a,b){Studio.queueCmd(a,"playSound",{soundName:b})},c.stop=function(a,b){Studio.queueCmd(a,"stop",{spriteIndex:b})},c.throwProjectile=function(a,b,c,d){Studio.queueCmd(a,"throwProjectile",{spriteIndex:b,dir:Number(c),className:String(d)})},c.makeProjectile=function(a,b,c){Studio.queueCmd(a,"makeProjectile",{className:b,action:c})},c.move=function(a,b,c){Studio.queueCmd(a,"move",{spriteIndex:b,dir:Number(c)})},c.moveDistance=function(a,b,c,d){Studio.queueCmd(a,"moveDistance",{spriteIndex:b,dir:c,distance:d})},c.changeScore=function(a,b){Studio.queueCmd(a,"changeScore",{value:b})},c.setScoreText=function(a,b){Studio.queueCmd(a,"setScoreText",{text:b})},c.showCoordinates=function(a){Studio.queueCmd(a,"showCoordinates",{})},c.wait=function(a,b){Studio.queueCmd(a,"wait",{value:b})},c.vanish=function(a,b){Studio.queueCmd(a,"vanish",{spriteIndex:b})},c.onEvent=function(a,b,c){Studio.queueCmd(a,"onEvent",{eventName:String(b),func:c})},c.isKeyDown=function(a){return"keydown"===Studio.keyState[a]}},{"./constants":150}],150:[function(a,b,c){"use strict";c.Direction={NONE:0,NORTH:1,EAST:2,SOUTH:4,WEST:8,NORTHEAST:3,SOUTHEAST:6,SOUTHWEST:12,NORTHWEST:9};var d=c.Direction,e={};e[d.NORTH]={x:0,y:-1},e[d.EAST]={x:1,y:0},e[d.SOUTH]={x:0,y:1},e[d.WEST]={x:-1,y:0},c.Direction.getUnitVector=function(a){return e[a]},c.Position={OUTTOPOUTLEFT:1,OUTTOPLEFT:2,OUTTOPCENTER:3,OUTTOPRIGHT:4,OUTTOPOUTRIGHT:5,TOPOUTLEFT:6,TOPLEFT:7,TOPCENTER:8,TOPRIGHT:9,TOPOUTRIGHT:10,MIDDLEOUTLEFT:11,MIDDLELEFT:12,MIDDLECENTER:13,MIDDLERIGHT:14,MIDDLEOUTRIGHT:15,BOTTOMOUTLEFT:16,BOTTOMLEFT:17,BOTTOMCENTER:18,BOTTOMRIGHT:19,BOTTOMOUTRIGHT:20,OUTBOTTOMOUTLEFT:21,OUTBOTTOMLEFT:22,OUTBOTTOMCENTER:23,OUTBOTTOMRIGHT:24,OUTBOTTOMOUTRIGHT:25},c.NextTurn={},c.NextTurn[d.NORTH]={},c.NextTurn[d.NORTH][d.NORTH]=d.NORTH,c.NextTurn[d.NORTH][d.EAST]=d.NORTHEAST,c.NextTurn[d.NORTH][d.SOUTH]=d.NORTHEAST,c.NextTurn[d.NORTH][d.WEST]=d.NORTHWEST,c.NextTurn[d.NORTH][d.NORTHEAST]=d.NORTHEAST,c.NextTurn[d.NORTH][d.SOUTHEAST]=d.NORTHEAST,c.NextTurn[d.NORTH][d.SOUTHWEST]=d.NORTHWEST,c.NextTurn[d.NORTH][d.NORTHWEST]=d.NORTHWEST,c.NextTurn[d.EAST]={},c.NextTurn[d.EAST][d.NORTH]=d.NORTHEAST,c.NextTurn[d.EAST][d.EAST]=d.EAST,c.NextTurn[d.EAST][d.SOUTH]=d.SOUTHEAST,c.NextTurn[d.EAST][d.WEST]=d.SOUTHEAST,c.NextTurn[d.EAST][d.NORTHEAST]=d.NORTHEAST,c.NextTurn[d.EAST][d.SOUTHEAST]=d.SOUTHEAST,c.NextTurn[d.EAST][d.SOUTHWEST]=d.SOUTHEAST,c.NextTurn[d.EAST][d.NORTHWEST]=d.NORTHEAST,c.NextTurn[d.SOUTH]={},c.NextTurn[d.SOUTH][d.NORTH]=d.SOUTHEAST,c.NextTurn[d.SOUTH][d.EAST]=d.SOUTHEAST,c.NextTurn[d.SOUTH][d.SOUTH]=d.SOUTH,c.NextTurn[d.SOUTH][d.WEST]=d.SOUTHWEST,c.NextTurn[d.SOUTH][d.NORTHEAST]=d.SOUTHEAST,c.NextTurn[d.SOUTH][d.SOUTHEAST]=d.SOUTHEAST,c.NextTurn[d.SOUTH][d.SOUTHWEST]=d.SOUTHWEST,c.NextTurn[d.SOUTH][d.NORTHWEST]=d.SOUTHWEST,c.NextTurn[d.WEST]={},c.NextTurn[d.WEST][d.NORTH]=d.NORTHWEST,c.NextTurn[d.WEST][d.EAST]=d.SOUTHWEST,c.NextTurn[d.WEST][d.SOUTH]=d.SOUTHWEST,c.NextTurn[d.WEST][d.WEST]=d.WEST,c.NextTurn[d.WEST][d.NORTHEAST]=d.NORTHWEST,c.NextTurn[d.WEST][d.SOUTHEAST]=d.SOUTHWEST,c.NextTurn[d.WEST][d.SOUTHWEST]=d.SOUTHWEST,c.NextTurn[d.WEST][d.NORTHWEST]=d.NORTHWEST,c.NextTurn[d.NORTHEAST]={},c.NextTurn[d.NORTHEAST][d.NORTH]=d.NORTH,c.NextTurn[d.NORTHEAST][d.EAST]=d.EAST,c.NextTurn[d.NORTHEAST][d.SOUTH]=d.EAST,c.NextTurn[d.NORTHEAST][d.WEST]=d.NORTH,c.NextTurn[d.NORTHEAST][d.NORTHEAST]=d.NORTHEAST,c.NextTurn[d.NORTHEAST][d.SOUTHEAST]=d.EAST,c.NextTurn[d.NORTHEAST][d.SOUTHWEST]=d.EAST,c.NextTurn[d.NORTHEAST][d.NORTHWEST]=d.NORTH,c.NextTurn[d.SOUTHEAST]={},c.NextTurn[d.SOUTHEAST][d.NORTH]=d.EAST,c.NextTurn[d.SOUTHEAST][d.EAST]=d.EAST,c.NextTurn[d.SOUTHEAST][d.SOUTH]=d.SOUTH,c.NextTurn[d.SOUTHEAST][d.WEST]=d.SOUTH,c.NextTurn[d.SOUTHEAST][d.NORTHEAST]=d.EAST,c.NextTurn[d.SOUTHEAST][d.SOUTHEAST]=d.SOUTHEAST,c.NextTurn[d.SOUTHEAST][d.SOUTHWEST]=d.SOUTH,c.NextTurn[d.SOUTHEAST][d.NORTHWEST]=d.SOUTH,c.NextTurn[d.SOUTHWEST]={},c.NextTurn[d.SOUTHWEST][d.NORTH]=d.WEST,c.NextTurn[d.SOUTHWEST][d.EAST]=d.SOUTH,c.NextTurn[d.SOUTHWEST][d.SOUTH]=d.SOUTH,c.NextTurn[d.SOUTHWEST][d.WEST]=d.WEST,c.NextTurn[d.SOUTHWEST][d.NORTHEAST]=d.SOUTH,c.NextTurn[d.SOUTHWEST][d.SOUTHEAST]=d.SOUTH,c.NextTurn[d.SOUTHWEST][d.SOUTHWEST]=d.SOUTHWEST,c.NextTurn[d.SOUTHWEST][d.NORTHWEST]=d.WEST,c.NextTurn[d.NORTHWEST]={},c.NextTurn[d.NORTHWEST][d.NORTH]=d.NORTH,c.NextTurn[d.NORTHWEST][d.EAST]=d.NORTH,c.NextTurn[d.NORTHWEST][d.SOUTH]=d.WEST,c.NextTurn[d.NORTHWEST][d.WEST]=d.WEST,c.NextTurn[d.NORTHWEST][d.NORTHEAST]=d.NORTH,c.NextTurn[d.NORTHWEST][d.SOUTHEAST]=d.WEST,c.NextTurn[d.NORTHWEST][d.SOUTHWEST]=d.WEST,c.NextTurn[d.NORTHWEST][d.NORTHWEST]=d.NORTHWEST,c.Emotions={NORMAL:0,HAPPY:1,ANGRY:2,SAD:3},c.FINISH_COLLIDE_DISTANCE_SCALING=.75,c.SPRITE_COLLIDE_DISTANCE_SCALING=.9,c.DEFAULT_SPRITE_SPEED=5,c.DEFAULT_SPRITE_SIZE=1,c.SquareType={OPEN:0,SPRITEFINISH:1,SPRITESTART:16},c.RANDOM_VALUE="random",c.HIDDEN_VALUE='"hidden"',c.CLICK_VALUE='"click"',c.VISIBLE_VALUE='"visible"'},{}],41:[function(){SVGElement.prototype.toDataURL=function(a,b){function c(){}function d(){var d=e(i),g=f(d);return c(a+" length: "+g.length),b.callback&&b.callback(g),g}function e(a){function b(a){var c="";c+="<"+a.nodeName;for(var d=0;d<a.attributes.length;d++)c+=" "+a.attributes[d].name+"='"+a.attributes[d].value+"'";if(a.hasChildNodes()){c+=">\n";for(var d=0;d<a.childNodes.length;d++)c+=b(a.childNodes[d]);c+="</"+a.nodeName+">\n"}else c+=" />\n";return c}return window.XMLSerializer?(c("using standard XMLSerializer.serializeToString"),(new XMLSerializer).serializeToString(a)):(c("using custom XMLSerializerForIE"),b(a))}function f(a){var b="data:image/svg+xml;base64,";return window.btoa?(c("using window.btoa for base64 encoding"),b+=btoa(a)):(c("using custom base64 encoder"),b+=Base64.encode(a)),b}function g(a){var d=document.createElement("canvas"),g=d.getContext("2d"),h=new Image,j=e(i);h.src=f(j),h.onload=function(){c("exported image size: "+[h.width,h.height]),d.width=h.width,d.height=h.height,g.drawImage(h,0,0);var e=d.toDataURL(a);c(a+" length: "+e.length),b.callback?b.callback(e):c("WARNING: no callback set, so nothing happens.")},h.onerror=function(){console.log("Can't export! Maybe your browser doesn't support SVG in img element or SVG input for Canvas drawImage?\nhttp://en.wikipedia.org/wiki/SVG#Native_support")}}function h(a){var d=document.createElement("canvas"),f=(d.getContext("2d"),e(i)),g=b.keepOutsideViewport;if(g)var h=i.getBBox();return canvg(d,f,{ignoreMouse:!0,ignoreAnimation:!0,offsetX:g?-h.x:void 0,offsetY:g?-h.y:void 0,scaleWidth:g?h.width+h.x:void 0,scaleHeight:g?h.height+h.y:void 0,renderCallback:function(){c("exported image dimensions "+[d.width,d.height]);var e=d.toDataURL(a);c(a+" length: "+e.length),b.callback&&b.callback(e)}}),d.toDataURL(a)}var i=this;switch(a||(a="image/svg+xml"),b||(b={}),b.keepNonSafe&&c("NOTE: keepNonSafe is NOT supported and will be ignored!"),b.keepOutsideViewport&&c("NOTE: keepOutsideViewport is only supported with canvg exporter."),a){case"image/svg+xml":return d();case"image/png":case"image/jpeg":switch(b.renderer||(b.renderer=window.canvg?"canvg":"native"),b.renderer){case"canvg":return c("using canvg renderer for png export"),h(a);case"native":return c("using native renderer for png export. THIS MIGHT FAIL."),g(a);default:c("unknown png renderer given, doing noting ("+b.renderer+")")}break;default:c("Sorry! Exporting as '"+a+"' is not supported!")}}},{}],40:[function(){},{}],38:[function(){},{}]},{},[154]);
=======
require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({153:[function(a){(function(b){var c=a("../appMain");window.Studio=a("./studio"),"undefined"!=typeof b&&(b.Studio=window.Studio);var d=a("./blocks"),e=a("./levels"),f=a("./skins");window.studioMain=function(a){a.skinsModule=f,a.blocksModule=d,c(window.Studio,e,a)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../appMain":3,"./blocks":147,"./levels":152,"./skins":155,"./studio":156}],156:[function(a,b){"use strict";function c(){switch(N.map=O.map,N.timeoutFailureTick=O.timeoutFailureTick||1/0,N.minWorkspaceHeight=O.minWorkspaceHeight,N.softButtons_=O.softButtons||{},N.protagonistSpriteIndex=O.protagonistSpriteIndex||O.protaganistSpriteIndex,O.customGameType){case"Big Game":N.customLogic=new A(N);break;case"SamTheButterfly":}N.startAvatars=O.avatarList?O.avatarList.slice():d(P.avatarList,O.firstSpriteIndex);for(var a in O.scale)N.scale[a]=O.scale[a];N.ROWS=N.map.length,N.COLS=N.map[0].length,N.SQUARE_SIZE=50,N.MARKER_HEIGHT=100,N.MARKER_WIDTH=100,N.MAZE_WIDTH=N.SQUARE_SIZE*N.COLS,N.MAZE_HEIGHT=N.SQUARE_SIZE*N.ROWS,p.MAZE_WIDTH=N.MAZE_WIDTH,p.MAZE_HEIGHT=N.MAZE_HEIGHT}function d(a,b){return b=b||0,D.flatten([a.slice(b),a.slice(0,b)])}function e(a,b,c,d,e,f){return Math.abs(a-b)<=c&&Math.abs(d-e)<=f}function f(a,b){N.eventHandlers.forEach(function(c){if(p.isUsingBlockly()){if(c.name===a&&(b||0===c.cmdQueue.length)){N.currentCmdQueue=c.cmdQueue;try{c.func(p,u,N.Globals)}catch(d){}N.currentCmdQueue=null}}else c.name===a&&N.eventQueue.push({fn:c.func})})}function g(){for(var a=function(a,b,c){var d=c?N.sprite[a].height:N.sprite[a].width,e=c?N.sprite[b].height:N.sprite[b].width;return r.SPRITE_COLLIDE_DISTANCE_SCALING*(d+e)/2},b=function(a,b,c){var d=c?N.sprite[a].height:N.sprite[a].width,e=c?N.projectiles[b].height:N.projectiles[b].width;return r.SPRITE_COLLIDE_DISTANCE_SCALING*(d+e)/2},c=function(a,b,c){var d,e=c?N.sprite[a].height:N.sprite[a].width;return d="left"===b||"right"===b?c?N.MAZE_HEIGHT:0:c?0:N.MAZE_WIDTH,(e+d)/2},d=0;d<N.spriteCount;d++){var f=N.sprite[d];if(f.visible){for(var g=f.width/2,h=f.height/2,i=ub(d,!1,!1)+g,j=ub(d,!0,!1)+h,k=0;k<N.spriteCount;k++)if(d!=k&&N.sprite[k].visible){var l=ub(k,!1,!1)+N.sprite[k].width/2,o=ub(k,!0,!1)+N.sprite[k].height/2;e(i,l,a(d,k,!1),j,o,a(d,k,!0))?N.collideSpriteWith(d,k):f.endCollision(k),n(d,k)}for(k=0;k<N.projectiles.length;k++){var p=N.projectiles[k],q=p.getNextPosition();e(i,q.x,b(d,k,!1),j,q.y,b(d,k,!0))?p.startCollision(d)&&(N.currentEventParams={projectile:p},m(d,p.className,!0),N.currentEventParams=null):p.endCollision(d)}for(k=0;k<U.length&&O.edgeCollisions;k++){var s,t,u=U[k];switch(u){case"top":s=N.MAZE_WIDTH/2,t=0;break;case"left":s=0,t=N.MAZE_HEIGHT/2;break;case"bottom":s=N.MAZE_WIDTH/2,t=N.MAZE_HEIGHT;break;case"right":s=N.MAZE_WIDTH,t=N.MAZE_HEIGHT/2}e(i,s,c(d,u,!1),j,t,c(d,u,!0))?N.collideSpriteWith(d,u):f.endCollision(u)}for(k=0;k<U.length;k++)n(d,U[k]);for(k=0;k<T.length;k++)n(d,T[k])}}}function h(a,b){var c=N.sprite[a],d=0,e=new Date,f=e-N.startTime;return b&&b.walkDirection?Lb[c.displayDir]:b&&b.walkFrame&&c.timePerFrame?Math.floor(f/c.timePerFrame)%c.frameCounts.walk:8===c.frameCounts.turns&&c.displayDir!==F.SOUTH?c.frameCounts.normal+c.frameCounts.animation+1+Kb[c.displayDir]:7===c.frameCounts.turns&&c.displayDir!==F.SOUTH?c.frameCounts.normal+c.frameCounts.animation+Kb[c.displayDir]:(1===c.frameCounts.animation&&N.tickCount&&1===Math.round((N.tickCount+a*Nb)/Mb)%Ob&&(d=c.frameCounts.normal),c.frameCounts.normal>1&&c.timePerFrame&&(d=Math.floor(f/c.timePerFrame)%c.frameCounts.normal),!d&&c.emotion!==I.NORMAL&&c.frameCounts.emotions>0&&(d=c.frameCounts.normal+c.frameCounts.animation+c.frameCounts.turns+(c.emotion-1)),d)}function i(a){var b=N.sprite[a];return b.frameCounts.normal+b.frameCounts.animation+b.frameCounts.turns+b.frameCounts.emotions}function j(a){return/^\d*$/.test(a)}function k(a){return-1!==U.indexOf(a)}function l(a){return-1!==T.indexOf(a)}function m(a,b,c){var d="whenSpriteCollided-"+a+"-";f(d+b,c),f(d+"anything",c),j(b)?f(d+"any_actor",c):k(b)?f(d+"any_edge",c):l(b)&&f(d+"any_projectile",c)}function n(a,b){var c="whenSpriteCollided-"+a+"-";N.executeQueue(c+b),N.executeQueue(c+"any_actor"),N.executeQueue(c+"anything"),k(b)?N.executeQueue(c+"any_edge"):l(b)&&N.executeQueue(c+"any_projectile")}function o(a,b){var c=function(b){var c=b?a.height:a.width,d=b?N.MARKER_HEIGHT:N.MARKER_WIDTH;return r.FINISH_COLLIDE_DISTANCE_SCALING*(c+d)/2},d=a.x+a.width/2,f=a.y+a.height/2,g=b.x+N.MARKER_WIDTH/2,h=b.y+N.MARKER_HEIGHT/2;return e(d,g,c(!1),f,h,c(!0))}var p=a("../StudioApp").singleton,q=(a("../../locale/current/common"),a("../../locale/current/studio")),r=(a("../skins"),a("./constants")),s=a("../constants"),t=a("../codegen"),u=a("./api"),v=a("./blocks"),w=a("../templates/page.html"),x=a("../dom"),y=a("./collidable"),z=a("./projectile"),A=a("./bigGameLogic"),B=a("../xml").parseElement,C=a("../utils"),D=C.getLodash(),E=C.getHammer();if("undefined"!=typeof SVGElement){a("../canvg/rgbcolor.js"),a("../canvg/StackBlur.js"),a("../canvg/canvg.js"),a("../canvg/svg_todataurl")}var F=r.Direction,G=r.NextTurn,H=r.SquareType,I=r.Emotions,J=s.KeyCodes,K=p.ResultType,L=p.TestResults,M="http://www.w3.org/2000/svg",N=b.exports;N.keyState={},N.gesturesObserved={},N.btnState={};var O,P,Q={UP:0,DOWN:1},R={LEFT:"leftButton",UP:"upButton",RIGHT:"rightButton",DOWN:"downButton"},S=25,T=["blue_fireball","purple_fireball","red_fireball","purple_hearts","red_hearts","yellow_hearts"],U=["top","left","bottom","right"];p.setCheckForEmptyBlocks(!0),N.BLOCK_X_COORDINATE=20,N.BLOCK_Y_COORDINATE=20;var V=200;N.scale={snapRadius:1,stepSpeed:33};var W=5e3,X=60,Y=100,Z=20,$=24,_=7,ab=5,bb=15,cb=360,db=ab+bb+_*$,eb=20,fb=50,gb=5,hb=10,ib=20,jb=4,kb=5,lb=180,mb=20+jb*ib,nb=60,ob=500,pb={text:q.shareStudioTwitter(),hashtag:"StudioCode"},qb=function(){var a,b=document.getElementById("svgStudio");b.setAttribute("width",N.MAZE_WIDTH),b.setAttribute("height",N.MAZE_HEIGHT);var c=new E(b);c.on("tap",N.onSvgClicked),c.on("drag",N.onSvgDrag);var d=document.getElementById("visualizationColumn");if(d.style.width=N.MAZE_WIDTH+"px",P.background){var e=document.createElementNS(M,"image");e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P.background),e.setAttribute("id","background"),e.setAttribute("height",N.MAZE_HEIGHT),e.setAttribute("width",N.MAZE_WIDTH),e.setAttribute("x",0),e.setAttribute("y",0),b.appendChild(e)}if(N.spriteStart_){for(a=0;a<N.spriteCount;a++){var f=document.createElementNS(M,"clipPath");f.setAttribute("id","spriteClipPath"+a);var g=document.createElementNS(M,"rect");g.setAttribute("id","spriteClipRect"+a),f.appendChild(g),b.appendChild(f);var h=document.createElementNS(M,"image");h.setAttribute("id","sprite"+a),h.setAttribute("clip-path","url(#spriteClipPath"+a+")"),b.appendChild(h);var i=document.createElementNS(M,"image");i.setAttribute("id","spriteWalk"+a),i.setAttribute("clip-path","url(#spriteWalkClipPath"+a+")"),b.appendChild(i);var j=document.createElementNS(M,"clipPath");j.setAttribute("id","spriteWalkClipPath"+a);var k=document.createElementNS(M,"rect");k.setAttribute("id","spriteWalkClipRect"+a),j.appendChild(k),b.appendChild(j),x.addMouseDownTouchEvent(h,rb(this,N.onSpriteClicked,a))}for(a=0;a<N.spriteCount;a++){var l=document.createElementNS(M,"g");l.setAttribute("id","speechBubble"+a),l.setAttribute("visibility","hidden");var m=document.createElementNS(M,"path");m.setAttribute("id","speechBubblePath"+a),m.setAttribute("class","studio-speech-bubble-path");var n=document.createElementNS(M,"text");n.setAttribute("id","speechBubbleText"+a),n.setAttribute("class","studio-speech-bubble"),l.appendChild(m),l.appendChild(n),b.appendChild(l)}}if(N.spriteGoals_)for(a=0;a<N.spriteGoals_.length;a++){var o=document.createElementNS(M,"clipPath");o.setAttribute("id","finishClipPath"+a);var p=document.createElementNS(M,"rect");p.setAttribute("id","finishClipRect"+a),p.setAttribute("width",N.MARKER_WIDTH),p.setAttribute("height",N.MARKER_HEIGHT),o.appendChild(p),b.appendChild(o);var q=document.createElementNS(M,"image");q.setAttribute("id","spriteFinish"+a),q.setAttribute("height",N.MARKER_HEIGHT),q.setAttribute("width",O.goalOverride&&O.goalOverride.imageWidth||N.MARKER_WIDTH),q.setAttribute("clip-path","url(#finishClipPath"+a+")"),b.appendChild(q)}var r=document.createElementNS(M,"text");r.setAttribute("id","score"),r.setAttribute("class","studio-score"),r.setAttribute("x",N.MAZE_WIDTH/2),r.setAttribute("y",nb),r.appendChild(document.createTextNode("")),r.setAttribute("visibility","hidden"),b.appendChild(r);var s=document.createElementNS(M,"text");s.setAttribute("id","titleScreenTitle"),s.setAttribute("class","studio-ts-title"),s.setAttribute("x",N.MAZE_WIDTH/2),s.setAttribute("y",X),s.appendChild(document.createTextNode("")),s.setAttribute("visibility","hidden"),b.appendChild(s);var t=document.createElementNS(M,"g"),u=(N.MAZE_WIDTH-cb)/2;t.setAttribute("id","titleScreenTextGroup"),t.setAttribute("x",u),t.setAttribute("y",Y),t.setAttribute("transform","translate("+u+","+Y+")"),t.setAttribute("visibility","hidden");var v=document.createElementNS(M,"rect");v.setAttribute("id","titleScreenTextRect"),v.setAttribute("x",0),v.setAttribute("y",0),v.setAttribute("width",cb),v.setAttribute("class","studio-ts-text-rect");var w=document.createElementNS(M,"text");w.setAttribute("id","titleScreenText"),w.setAttribute("class","studio-ts-text"),w.setAttribute("x",cb/2),w.setAttribute("y",0),w.appendChild(document.createTextNode("")),t.appendChild(v),t.appendChild(w),b.appendChild(t)},rb=function(a,b,c){return function(){var d=Array.prototype.slice.apply(arguments).concat(c);b.apply(a,d)}},sb=function(a,b,c){var d=0;return N.eventHandlers.forEach(function(e){var f=e.cmdQueue[0];if(f&&"moveDistance"===f.name&&f.opts.spriteIndex===a){var g,h=Math.min(f.opts.queuedDistance,N.sprite[f.opts.spriteIndex].speed);switch(f.opts.dir){case F.NORTH:g=b?-1:0;break;case F.WEST:g=b?0:-1;break;case F.SOUTH:g=b?1:0;break;case F.EAST:g=b?0:1}c&&0!==g&&(f.opts.queuedDistance-=h,"0.00"===Math.abs(f.opts.queuedDistance).toFixed(2)&&(f.opts.queuedDistance=0)),d+=h*g}}),d},tb=function(a,b){N.eventHandlers.forEach(function(c){var d=c.cmdQueue[0];if(d&&"moveDistance"===d.name&&d.opts.spriteIndex===a){var e=d.opts.dir;!b||e!==F.NORTH&&e!==F.SOUTH?b||e!==F.EAST&&e!==F.WEST||(d.opts.queuedDistance=0):d.opts.queuedDistance=0}})},ub=function(a,b,c){var d=b?N.sprite[a].y:N.sprite[a].x;return d+sb(a,b,c)},vb=function(a){var b=N.sprite[a],c=b.x,d=b.y,e=ub(a,!1,!0),f=ub(a,!0,!0);if(O.allowSpritesOutsidePlayspace)b.x=e,b.y=f;else{var g=Math.min(N.MAZE_WIDTH-b.width,Math.max(0,e));e!=g&&tb(a,!1),b.x=g;var h=Math.min(N.MAZE_HEIGHT-b.height,Math.max(0,f));f!=h&&tb(a,!0),b.y=h}(c!==b.x||d!==b.y)&&(b.lastMove=N.tickCount)},wb=function(a){for(;a.svgText.firstChild;)a.svgText.removeChild(a.svgText.firstChild);var b=a.text.toString().split(" "),c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttribute("x",a.width/2),c.setAttribute("dy",a.lineHeight+a.topMargin);var d=document.createTextNode(b[0]);c.appendChild(d),a.svgText.appendChild(c);for(var e=1,f=1;f<b.length;f++){var g=c.firstChild.data.length;if(c.firstChild.data+=" "+b[f],c.getComputedTextLength&&c.getComputedTextLength()>a.width-2*a.sideMargin){if(c.firstChild.data=c.firstChild.data.slice(0,g),a.maxLines===e)return a.fullHeight;c=document.createElementNS("http://www.w3.org/2000/svg","tspan"),c.setAttribute("x",a.width/2),c.setAttribute("dy",a.lineHeight),d=document.createTextNode(b[f]),c.appendChild(d),a.svgText.appendChild(c),e++}}var h=a.maxLines-Math.max(1,e);return a.fullHeight-h*a.lineHeight};N.callApiCode=function(a,b){Db(N.eventHandlers,a,b),f(a),N.executeQueue(a)},N.onTick=function(){if(N.tickCount++,N.customLogic&&N.customLogic.onTick(),N.interpreter)for(var a=!1,b=0;V>b&&!a;b++){var c=t.selectCurrentCode(N.interpreter,N.cumulativeLength,N.userCodeStartOffset,N.userCodeLength,p.editor);try{N.interpreter.step(),a=-1!==c&&N.interpreter.stateStack[0]&&N.interpreter.stateStack[0].done}catch(d){return N.executionError=d,void N.onPuzzleComplete()}}else 1===N.tickCount&&f("whenGameStarts"),N.executeQueue("whenGameStarts");f("repeatForever"),N.executeQueue("repeatForever");for(var e=0;e<N.spriteCount;e++)N.executeQueue("whenSpriteClicked-"+e);for(var h in J)if(N.keyState[J[h]]&&"keydown"===N.keyState[J[h]])switch(J[h]){case J.LEFT:f("when-left");break;case J.UP:f("when-up");break;case J.RIGHT:f("when-right");break;case J.DOWN:f("when-down")}for(var i in R)if(N.btnState[R[i]]&&N.btnState[R[i]]===Q.DOWN)switch(R[i]){case R.LEFT:f("when-left");break;case R.UP:f("when-up");break;case R.RIGHT:f("when-right");break;case R.DOWN:f("when-down")}for(var j in N.gesturesObserved){switch(j){case"left":f("when-left");break;case"up":f("when-up");break;case"right":f("when-right");break;case"down":f("when-down")}0===N.gesturesObserved[j]--&&delete N.gesturesObserved[j]}for(N.executeQueue("when-left"),N.executeQueue("when-up"),N.executeQueue("when-right"),N.executeQueue("when-down"),g(),e=0;e<N.spriteCount;e++){vb(e);var k=!0;N.tickCount-N.sprite[e].lastMove>Pb&&(N.sprite[e].dir=F.SOUTH,k=!1),N.displaySprite(e,k)}for(e=0;e<N.projectiles.length;e++)N.projectiles[e].moveToNextPosition(),N.projectiles[e].outOfBounds()?(N.projectiles[e].removeElement(),N.projectiles.splice(e,1),e--):N.projectiles[e].display();$b()&&N.onPuzzleComplete()},N.onSvgDrag=function(a){N.tickCount>0&&(N.gesturesObserved[a.gesture.direction]=Math.round(a.gesture.distance/S),a.gesture.preventDefault())},N.onKey=function(a){N.keyState[a.keyCode]=a.type,N.tickCount>0&&a.keyCode>=J.LEFT&&a.keyCode<=J.DOWN&&a.preventDefault()},N.onArrowButtonDown=function(a,b){N.btnState[b]=Q.DOWN,a.preventDefault()},N.onSpriteClicked=function(a,b){N.tickCount>0&&f("whenSpriteClicked-"+b),a.preventDefault()},N.onSvgClicked=function(a){N.tickCount>0&&N.eventHandlers.forEach(function(a){var b=a.cmdQueue[0];b&&b.opts.waitForClick&&!b.opts.complete&&(b.opts.waitCallback&&b.opts.waitCallback(),b.opts.complete=!0)}),a.preventDefault()},N.onArrowButtonUp=function(a,b){N.btnState[b]=Q.UP},N.onMouseUp=function(){N.btnState={}},N.initSprites=function(){N.spriteCount=0,N.sprite=[],N.projectiles=[],N.startTime=null,N.spriteGoals_=[];for(var a=0;a<N.ROWS;a++)for(var b=0;b<N.COLS;b++)N.map[a][b]&H.SPRITEFINISH?N.spriteGoals_.push({x:b*N.SQUARE_SIZE,y:a*N.SQUARE_SIZE,finished:!1}):N.map[a][b]&H.SPRITESTART&&(0===N.spriteCount&&(N.spriteStart_=[]),N.spriteStart_[N.spriteCount]={x:b*N.SQUARE_SIZE,y:a*N.SQUARE_SIZE},N.spriteCount++);p.isUsingBlockly()&&(v.setSpriteCount(Blockly,N.spriteCount),v.setStartAvatars(N.startAvatars),O.projectileCollisions&&v.enableProjectileCollisions(Blockly),O.edgeCollisions&&v.enableEdgeCollisions(Blockly),O.allowSpritesOutsidePlayspace&&v.enableSpritesOutsidePlayspace(Blockly))},N.initReadonly=function(a){P=a.skin,O=a.level,c(),N.initSprites(),p.initReadonly(a)};var xb=function(a){for(var b,c=B(a.level.startBlocks),d=0,e=p.sortBlocksByVisibility(c.childNodes),f=0;e&&f<e.length;f++)b=e[f],1!==b.nodeType||b.getAttribute("y")||d++;if(d){var g=0,h=(a.level.minWorkspaceHeight||800)-N.BLOCK_Y_COORDINATE,i=h/d;for(f=0,b;e&&f<e.length;f++)b=e[f],1!==b.nodeType||b.getAttribute("y")||(b.setAttribute("x",b.getAttribute("x")||N.BLOCK_X_COORDINATE),b.setAttribute("y",N.BLOCK_Y_COORDINATE+i*g),g+=1);a.level.startBlocks=Blockly.Xml.domToText(c)}};N.init=function(b){N.clearEventHandlersKillTickLoop(),P=b.skin,O=b.level,c(),window.addEventListener("keydown",N.onKey,!1),window.addEventListener("keyup",N.onKey,!1);var d=D.isEmpty(O.softButtons),e=a("./controls.html")({assetUrl:p.assetUrl,finishButton:d}),f=a("./extraControlRows.html")({assetUrl:p.assetUrl,finishButton:!d});b.html=w({assetUrl:p.assetUrl,data:{localeDirection:p.localeDirection(),visualization:a("./visualization.html")(),controls:e,extraControlRows:f,blockUsed:void 0,idealBlockNumber:void 0,editCode:O.editCode,blockCounterClass:"block-counter-default"}}),b.loadAudio=function(){p.loadAudio(P.winSound,"win"),p.loadAudio(P.startSound,"start"),p.loadAudio(P.failureSound,"failure"),p.loadAudio(P.rubberSound,"rubber"),p.loadAudio(P.crunchSound,"crunch"),p.loadAudio(P.flagSound,"flag"),p.loadAudio(P.winPointSound,"winpoint"),p.loadAudio(P.winPoint2Sound,"winpoint2"),p.loadAudio(P.losePointSound,"losepoint"),p.loadAudio(P.losePoint2Sound,"losepoint2"),p.loadAudio(P.goal1Sound,"goal1"),p.loadAudio(P.goal2Sound,"goal2"),p.loadAudio(P.woodSound,"wood"),p.loadAudio(P.retroSound,"retro"),p.loadAudio(P.slapSound,"slap"),p.loadAudio(P.hitSound,"hit")},b.afterInject=function(){for(var a in R)x.addClickTouchEvent(document.getElementById(R[a]),rb(this,N.onArrowButtonUp,R[a])),x.addMouseDownTouchEvent(document.getElementById(R[a]),rb(this,N.onArrowButtonDown,R[a]));document.addEventListener("mouseup",N.onMouseUp,!1),p.isUsingBlockly()&&(Blockly.HSV_SATURATION=.6,Blockly.SNAP_RADIUS*=N.scale.snapRadius),qb()},p.isUsingBlockly()&&"toolbox_blocks"!=b.level.edit_blocks&&xb(b),b.twitter=pb,b.makeYourOwn=b.share,b.makeString=q.makeYourOwn(),b.makeUrl="http://code.org/studio",b.makeImage=p.assetUrl("media/promo.png"),b.enableShowCode=!1,b.varsInGlobals=!0,b.generateFunctionPassBlocks=!!b.level.generateFunctionPassBlocks,N.initSprites(),p.init(b);var g=document.getElementById("finishButton");x.addClickTouchEvent(g,N.onPuzzleComplete),b.skin.preloadAssets&&(Bb(),Ab(),zb())};var yb=function(a){var b=new Image;b.src=a},zb=function(){if(p.isUsingBlockly())for(var a=P.backgroundChoicesK1,b=0;b<a.length;b++)yb(a[b][0])},Ab=function(){for(var a=0;a<T.length;a++)yb(P[T[a]])},Bb=function(){for(var a=0;a<P.avatarList.length;a++)yb(P[P.avatarList[a]].sprite)};N.clearEventHandlersKillTickLoop=function(){N.eventHandlers&&N.eventHandlers.forEach(function(a){var b=a.cmdQueue[0];b&&b.opts.waitTimeout&&!b.opts.complete&&window.clearTimeout(b.opts.waitTimeout)}),N.eventHandlers=[],N.perExecutionTimeouts&&N.perExecutionTimeouts.forEach(function(a){clearInterval(a)}),N.perExecutionTimeouts=[],N.tickCount=0;for(var a=0;a<N.spriteCount;a++)N.sprite[a]&&N.sprite[a].bubbleTimeout&&window.clearTimeout(N.sprite[a].bubbleTimeout);if(N.projectiles){for(a=0;a<N.projectiles.length;a++)N.projectiles[a].removeElement();N.projectiles=[]}},p.reset=function(){var a;N.clearEventHandlersKillTickLoop();var b=0;for(a=0;a<N.softButtons_.length;a++)document.getElementById(N.softButtons_[a]).style.display="inline",b++;if(b){var c=document.getElementById("soft-buttons");c.className="soft-buttons-"+b}for(;N.projectiles.length;){var d=N.projectiles.pop();d.removeElement()}for(N.playerScore=0,N.scoreText=null,document.getElementById("score").setAttribute("visibility","hidden"),document.getElementById("titleScreenTitle").setAttribute("visibility","hidden"),document.getElementById("titleScreenTextGroup").setAttribute("visibility","hidden"),N.setBackground(O.coordinateGridBackground?{value:"grid"}:{value:O.background||P.defaultBackground}),N.gesturesObserved={},N.currentCmdQueue=null,N.sayComplete=0,N.playSoundCount=0,O.goal&&(O.goal.successState={}),N.Globals={},p.editCode&&(N.eventQueue=[],N.executionError=null,N.interpreter=null),a=0;a<N.spriteCount;a++){N.sprite[a]=new y({x:N.spriteStart_[a].x,y:N.spriteStart_[a].y,speed:r.DEFAULT_SPRITE_SPEED,size:r.DEFAULT_SPRITE_SIZE,dir:F.NONE,displayDir:F.SOUTH,emotion:O.defaultEmotion||I.NORMAL,lastMove:1/0,visible:!O.spritesHiddenToStart});var e={spriteIndex:a,value:N.startAvatars[a%N.startAvatars.length],forceHidden:O.spritesHiddenToStart};N.setSprite(e),N.displaySprite(a),document.getElementById("speechBubble"+a).setAttribute("visibility","hidden"),document.getElementById("sprite"+a).removeAttribute("opacity");var f=document.getElementById("explosion"+a);f&&f.setAttribute("visibility","hidden")}var g=(document.getElementById("svgStudio"),P.goal);for(O.goalOverride&&O.goalOverride.goal&&(g=P[O.goalOverride.goal]),a=0;a<N.spriteGoals_.length;a++){N.spriteGoals_[a].finished=!1;var h=document.getElementById("spriteFinish"+a);h.setAttribute("x",N.spriteGoals_[a].x),h.setAttribute("y",N.spriteGoals_[a].y),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);var i=document.getElementById("finishClipRect"+a);i.setAttribute("x",N.spriteGoals_[a].x),i.setAttribute("y",N.spriteGoals_[a].y)}N.levelRestarted=!0},p.runButtonClick=function(){var a=document.getElementById("runButton"),b=document.getElementById("resetButton");if(b.style.minWidth||(b.style.minWidth=a.offsetWidth+"px"),p.toggleRunReset("reset"),p.isUsingBlockly()&&Blockly.mainBlockSpace.traceOn(!0),p.reset(!1),p.attempts++,N.startTime=new Date,N.execute(),O.freePlay&&(!p.hideSource||O.showFinish)){var c=document.getElementById("share-cell");c.className="share-cell-enabled"}O.showZeroScore&&N.displayScore()};var Cb=function(){N.waitingForReport||p.displayFeedback({app:"studio",skin:P.id,feedbackType:N.testResults,response:N.response,level:O,showingSharing:!O.disableSharing&&O.freePlay,feedbackImage:N.feedbackImage,twitter:pb,saveToGalleryUrl:O.freePlay&&N.response&&N.response.save_to_gallery_url,appStrings:{reinfFeedbackMsg:q.reinfFeedbackMsg(),sharingText:q.shareGame()}})};N.onReportComplete=function(a){N.response=a,N.waitingForReport=!1,Cb()};var Db=function(a,b,c){a.push({name:b,func:c,cmdQueue:[]})},Eb=function(a,b,c,d,e,f,g){for(var h=Blockly.mainBlockSpace.getTopBlocks(),i=0;h[i];i++){var j=h[i],k=j.getTitleValue(d)||"0",l=j.getTitleValue(f)||"0";if(!(j.type!==b||d&&e!==k||f&&g!==l)){var m=Blockly.Generator.blocksToCode("JavaScript",[j]);if(m){var n=t.functionFromCode(m,{StudioApp:p,Studio:u,Globals:N.Globals}),o=c;d&&(o+="-"+e),f&&(o+="-"+g),Db(a,o,n)}}}},Fb=function(a,b,c,d){for(var e=0;e<N.spriteCount;e++)Eb(a,b,c,d,String(e))},Gb=function(a,b,c,d,e){for(var f=0;f<e.length;f++)Eb(a,b,c,d,e[f])},Hb=function(a,b,c,d,e){var f,g=function(g){Eb(a,b,c,d,String(f),e,g)};for(f=0;f<N.spriteCount;f++){for(var h=0;h<N.spriteCount;h++)f!==h&&Eb(a,b,c,d,String(f),e,String(h));T.forEach(g),U.forEach(g),Eb(a,b,c,d,String(f),e,"any_actor"),Eb(a,b,c,d,String(f),e,"any_edge"),Eb(a,b,c,d,String(f),e,"any_projectile"),Eb(a,b,c,d,String(f),e,"anything")}},Ib=function(a){var b=Blockly.Generator.blockSpaceToCode("JavaScript",a);try{t.evalWith(b,{StudioApp:p,Studio:u,Globals:N.Globals})}catch(c){}},Jb=function(){return N.eventQueue.shift()};N.execute=function(){var a;N.result=p.UNSET,N.testResults=L.NO_TESTS_RUN,N.waitingForReport=!1,N.response=null;O.editCode&&(a=C.generateCodeAliases(O.codeFunctions,null,"Studio"),a+=p.editor.getValue());var b=[];if(p.isUsingBlockly()&&(Eb(b,"when_run","whenGameStarts"),Eb(b,"functional_start_setBackground","whenGameStarts"),Eb(b,"functional_start_setSpeeds","whenGameStarts"),Eb(b,"functional_start_setBackgroundAndSpeeds","whenGameStarts"),Eb(b,"functional_start_setFuncs","whenGameStarts"),Eb(b,"studio_whenLeft","when-left"),Eb(b,"studio_whenRight","when-right"),Eb(b,"studio_whenUp","when-up"),Eb(b,"studio_whenDown","when-down"),Gb(b,"studio_whenArrow","when","VALUE",["left","right","up","down"]),Eb(b,"studio_repeatForever","repeatForever"),Fb(b,"studio_whenSpriteClicked","whenSpriteClicked","SPRITE"),Hb(b,"studio_whenSpriteCollided","whenSpriteCollided","SPRITE1","SPRITE2")),p.playAudio("start"),p.reset(!1),O.editCode){var c=C.generateCodeAliases(O.codeFunctions,null,"Studio");N.userCodeStartOffset=c.length,c+=p.editor.getValue(),N.userCodeLength=c.length-N.userCodeStartOffset,c+="\nwhile (true) { var obj = getCallback(); if (obj) { obj.fn.apply(null, obj.arguments ? obj.arguments : null); }}";var d=p.editor.aceEditor.getSession();N.cumulativeLength=t.aceCalculateCumulativeLength(d);var e=function(a,b){t.initJSInterpreter(a,b,{StudioApp:p,Studio:u,Globals:N.Globals});var c=(a.createObject(a.FUNCTION),t.makeNativeMemberFunction(a,Jb,null));a.setProperty(b,"getCallback",a.createNativeFunction(c))};N.interpreter=new window.Interpreter(c,e)}else Ib("procedures_defreturn"),Ib("procedures_defnoreturn"),Ib("functional_definition"),N.eventHandlers=b;N.perExecutionTimeouts=[],N.perExecutionTimeouts.push(window.setInterval(N.onTick,N.scale.stepSpeed))},N.feedbackImage="",N.encodedFeedbackImage="",N.onPuzzleComplete=function(){N.executionError?N.result=K.ERROR:O.freePlay&&(N.result=K.SUCCESS),N.clearEventHandlersKillTickLoop();var a=N.result===K.SUCCESS;N.testResults=O.freePlay?L.FREE_PLAY:p.getTestResults(a),p.playAudio(N.testResults>=L.TOO_MANY_BLOCKS_FAIL?"win":"failure");var b;if(O.editCode)b=p.editor.getValue();else{var c=Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace);b=Blockly.Xml.domToText(c)}N.waitingForReport=!0;var d=function(){p.report({app:"studio",level:O.id,result:N.result===K.SUCCESS,testResult:N.testResults,program:encodeURIComponent(b),image:N.encodedFeedbackImage,onComplete:N.onReportComplete})};"undefined"==typeof document.getElementById("svgStudio").toDataURL?d():document.getElementById("svgStudio").toDataURL("image/png",{callback:function(a){N.feedbackImage=a,N.encodedFeedbackImage=encodeURIComponent(N.feedbackImage.split(",")[1]),d()}})};var Kb={};Kb[F.SOUTHEAST]=0,Kb[F.EAST]=1,Kb[F.NORTHEAST]=2,Kb[F.NORTH]=3,Kb[F.NORTHWEST]=4,Kb[F.WEST]=5,Kb[F.SOUTHWEST]=6;var Lb={};Lb[F.SOUTH]=0,Lb[F.SOUTHEAST]=1,Lb[F.EAST]=2,Lb[F.NORTHEAST]=3,Lb[F.NORTH]=4,Lb[F.NORTHWEST]=5,Lb[F.WEST]=6,Lb[F.SOUTHWEST]=7;var Mb=6,Nb=7,Ob=8,Pb=5,Qb=function(a){var b=+a.getAttribute("height"),c="true"===a.getAttribute("onTop"),d="true"===a.getAttribute("onRight");a.setAttribute("d",Vb(0,0,lb,b,eb,c,d))};N.displaySprite=function(a,b){var c=N.sprite[a];if("hidden"!==c.value){var d,e,f,g,i,j=document.getElementById("sprite"+a),k=document.getElementById("spriteWalk"+a);void 0!==c.value&&P[c.value]&&P[c.value].walk&&b?(j.setAttribute("visibility","hidden"),k.setAttribute("visibility","visible"),g=c.width*h(a,{walkDirection:!0}),i=c.height*h(a,{walkFrame:!0}),d=k,e=document.getElementById("spriteWalkClipRect"+a),f=document.getElementById("spriteClipRect"+a)):(j.setAttribute("visibility","visible"),k.setAttribute("visibility","hidden"),g=c.width*h(a),i=0,d=j,e=document.getElementById("spriteClipRect"+a),f=document.getElementById("spriteWalkClipRect"+a));var l=e.getAttribute("x"),m=e.getAttribute("y"),n=c.dir;n===F.NONE?c.dir=F.SOUTH:(c.x!=l||c.y!=m)&&(c.dir=F.NONE,c.x<l?c.dir|=F.WEST:c.x>l&&(c.dir|=F.EAST),c.y<m?c.dir|=F.NORTH:c.y>m&&(c.dir|=F.SOUTH)),c.dir!==c.displayDir&&N.tickCount&&0===N.tickCount%2&&(c.displayDir=G[c.displayDir][c.dir]),d.setAttribute("x",c.x-g),d.setAttribute("y",c.y-i),e.setAttribute("x",c.x),e.setAttribute("y",c.y),f.setAttribute("x",c.x),f.setAttribute("y",c.y);var o=document.getElementById("speechBubble"+a),p=document.getElementById("speechBubblePath"+a),q=+p.getAttribute("height"),r="true"===p.getAttribute("onTop"),s="true"===p.getAttribute("onRight"),t=!0,u=!0,v=c.y-(q+gb);0>v&&(v=c.y+c.height+gb,t=!1);var w=c.x+fb;w>N.MAZE_WIDTH-lb&&(w=c.x+c.width-(lb+fb),u=!1),p.setAttribute("onTop",t),p.setAttribute("onRight",u),(r!==t||s!==u)&&Qb(p),o.setAttribute("transform","translate("+w+","+v+")")}},N.displayScore=function(){var a=document.getElementById("score");a.textContent=N.scoreText?N.scoreText:q.scoreText({playerScore:N.playerScore}),a.setAttribute("visibility","visible")},N.showCoordinates=function(){var a=N.sprite[N.protagonistSpriteIndex||0];if(a){var b=a.x+50,c=350-a.y;N.setScoreText({text:"x: "+b+" y: "+c})}},N.queueCmd=function(a,b,c){var d={id:a,name:b,opts:c};if(p.isUsingBlockly()){if(N.currentEventParams)for(var e in N.currentEventParams)d.opts[e]=N.currentEventParams[e];N.currentCmdQueue.push(d)}else N.callCmd(d)},N.executeQueue=function(a){N.eventHandlers.forEach(function(b){if(b.name===a&&b.cmdQueue.length)for(var c=b.cmdQueue[0];c&&N.callCmd(c);c=b.cmdQueue[0])b.cmdQueue.shift()})},N.callCmd=function(a){switch(a.name){case"setBackground":p.highlight(a.id),N.setBackground(a.opts);break;case"setSprite":p.highlight(a.id),N.setSprite(a.opts);break;case"saySprite":return a.opts.started||p.highlight(a.id),N.saySprite(a.opts);case"setSpriteEmotion":p.highlight(a.id),N.setSpriteEmotion(a.opts);break;case"setSpriteSpeed":p.highlight(a.id),N.setSpriteSpeed(a.opts);break;case"setSpriteSize":p.highlight(a.id),N.setSpriteSize(a.opts);break;case"setSpritePosition":p.highlight(a.id),N.setSpritePosition(a.opts);break;case"setSpriteXY":p.highlight(a.id),N.setSpriteXY(a.opts);break;case"playSound":p.highlight(a.id),p.playAudio(a.opts.soundName,{volume:1}),N.playSoundCount++;break;case"showTitleScreen":return a.opts.started||p.highlight(a.id),N.showTitleScreen(a.opts);case"move":p.highlight(a.id),N.moveSingle(a.opts);break;case"moveDistance":return a.opts.started||p.highlight(a.id),N.moveDistance(a.opts);case"stop":p.highlight(a.id),N.stop(a.opts);break;case"throwProjectile":return a.opts.started||p.highlight(a.id),N.throwProjectile(a.opts);case"makeProjectile":p.highlight(a.id),N.makeProjectile(a.opts);break;case"changeScore":p.highlight(a.id),N.changeScore(a.opts);break;case"setScoreText":p.highlight(a.id),N.setScoreText(a.opts);break;case"showCoordinates":p.highlight(a.id),N.showCoordinates();break;case"wait":return a.opts.started||p.highlight(a.id),N.wait(a.opts);case"vanish":p.highlight(a.id),N.vanishActor(a.opts);break;case"onEvent":p.highlight(a.id),N.onEvent(a.opts)}return!0},N.vanishActor=function(a){var b=document.getElementById("svgStudio"),c=document.getElementById("sprite"+a.spriteIndex);if(c&&"hidden"!==c.getAttribute("visibility")){var d=document.getElementById("explosion"+a.spriteIndex);d||(d=document.createElementNS(M,"image"),d.setAttribute("id","explosion"+a.spriteIndex),d.setAttribute("visibility","hidden"),b.appendChild(d,c));var e=document.getElementById("spriteClipRect"+a.spriteIndex);d.setAttribute("height",N.sprite[a.spriteIndex].height),d.setAttribute("width",N.sprite[a.spriteIndex].width),d.setAttribute("x",e.getAttribute("x")),d.setAttribute("y",e.getAttribute("y")),d.setAttribute("visibility","visible");var f=parseInt(e.getAttribute("x"),10),g=P.explosionFrames;g&&g>1?(d.setAttribute("clip-path","url(#spriteClipPath"+a.spriteIndex+")"),d.setAttribute("width",100*g),D.range(0,g).forEach(function(a){N.perExecutionTimeouts.push(setTimeout(function(){d.setAttribute("x",f-100*a),c.setAttribute("opacity",(g-a)/g)},100*a))}),N.perExecutionTimeouts.push(setTimeout(function(){d.setAttribute("visibility","hidden"),N.setSprite({spriteIndex:a.spriteIndex,value:"hidden"}),c.removeAttribute("opacity")},100*(g+1)))):N.setSprite({spriteIndex:a.spriteIndex,value:"hidden"}),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P.explosion+"?spriteIndex="+a.spriteIndex)}},N.setSpriteEmotion=function(a){N.sprite[a.spriteIndex].emotion=a.value},N.setSpriteSpeed=function(a){var b=Math.min(Math.max(a.value,2),12);N.sprite[a.spriteIndex].speed=b},N.setSpriteSize=function(a){N.sprite[a.spriteIndex].size=a.value;var b=N.sprite[a.spriteIndex].value;"hidden"!==b&&N.setSprite({spriteIndex:a.spriteIndex,value:b})},N.changeScore=function(a){N.playerScore+=Number(a.value),N.displayScore()},N.setScoreText=function(a){N.scoreText=a.text,N.displayScore()},N.setBackground=function(a){var b=document.getElementById("background");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P[a.value].background)},N.setSprite=function(a){var b=a.spriteIndex,c=N.sprite[b],d=a.value,e=document.getElementById("sprite"+b);if(e){var f=null;if(void 0!==d&&P[d]&&P[d].walk){if(f=document.getElementById("spriteWalk"+b),!f)return;f.setAttribute("visibility","hidden")}if(c.visible="hidden"!==d&&!a.forceHidden,e.setAttribute("visibility",c.visible?"visible":"hidden"),c.value=a.forceHidden?"hidden":a.value,"hidden"!==d&&"visible"!==d){c.frameCounts=P[d].frameCounts,c.timePerFrame=P[d].timePerFrame,c.height=c.size*P.spriteHeight,c.width=c.size*P.spriteWidth,P.projectileSpriteHeight&&(c.projectileSpriteHeight=c.size*P.projectileSpriteHeight),P.projectileSpriteWidth&&(c.projectileSpriteWidth=c.size*P.projectileSpriteWidth);
var g=document.getElementById("spriteClipRect"+b);if(g.setAttribute("width",c.width),g.setAttribute("height",c.height),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P[d].sprite),e.setAttribute("width",c.width*i(b)),e.setAttribute("height",c.height),f){var h=document.getElementById("spriteWalkClipRect"+b);h.setAttribute("width",c.width),h.setAttribute("height",c.height),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",P[d].walk);var j=N.sprite[b].frameCounts;f.setAttribute("width",c.width*j.turns),f.setAttribute("height",c.height*j.walk)}N.displaySprite(b)}}};var Rb=function(a,b){return a+" "+b+" "},Sb=15,Tb=25,Ub=10,Vb=function(a,b,c,d,e,f,g){var h="M"+Rb(a+e,b);return f||(h+=g?"L"+Rb(a+e-Ub,b-Sb)+"L"+Rb(a+e+Tb,b):"L"+Rb(a+c-e-Tb,b)+"L"+Rb(a+c-Ub,b-Sb)),h+="L"+Rb(a+c-e,b),h+="Q"+Rb(a+c,b)+Rb(a+c,b+e),h+="L"+Rb(a+c,b+d-e)+"Q"+Rb(a+c,b+d)+Rb(a+c-e,b+d),f&&(h+=g?"L"+Rb(a+e+Tb,b+d)+"L"+Rb(a+e-Ub,b+d+Sb):"L"+Rb(a+c-Ub,b+d+Sb)+"L"+Rb(a+c-e-Tb,b+d)),h+="L"+Rb(a+e,b+d),h+="Q"+Rb(a,b+d)+Rb(a,b+d-e),h+="L"+Rb(a,b+e)+"Q"+Rb(a,b)+Rb(a+e,b),h+="Z"},Wb=function(a){a.complete||(a.waitCallback&&a.waitCallback(),a.complete=!0)};N.wait=function(a){return a.started||(a.started=!0,"click"===a.value?a.waitForClick=!0:a.waitTimeout=window.setTimeout(rb(this,Wb,a),a.value)),a.complete},N.hideTitleScreen=function(a){var b=document.getElementById("titleScreenTitle"),c=document.getElementById("titleScreenTextGroup");b.setAttribute("visibility","hidden"),c.setAttribute("visibility","hidden"),a.complete=!0},N.showTitleScreen=function(a){if(!a.started){a.started=!0;var b=document.getElementById("titleScreenTitle"),c=document.getElementById("titleScreenTextGroup"),d=document.getElementById("titleScreenText"),e=document.getElementById("titleScreenTextRect");b.textContent=a.title;var f={svgText:d,text:a.text,width:cb,lineHeight:$,topMargin:ab,sideMargin:Z,maxLines:_,fullHeight:db},g=wb(f);e.setAttribute("height",g),b.setAttribute("visibility","visible"),c.setAttribute("visibility","visible"),a.waitForClick=!0,a.waitCallback=rb(this,N.hideTitleScreen,a),a.waitTimeout=window.setTimeout(rb(this,Wb,a),W)}return a.complete},N.isCmdCurrentInQueue=function(a,b){var c=!1;return N.eventHandlers.forEach(function(d){if(d.name===b){var e=d.cmdQueue[0];e&&e.name===a&&(c=!0)}}),c},N.hideSpeechBubble=function(a){var b=document.getElementById("speechBubble"+a.spriteIndex);b.setAttribute("visibility","hidden"),b.removeAttribute("onTop"),b.removeAttribute("onRight"),b.removeAttribute("height"),a.complete=!0,delete N.sprite[a.spriteIndex].bubbleTimeoutFunc,N.sayComplete++},N.saySprite=function(a){if(a.started)return a.complete;var b=a.spriteIndex,c=N.sprite[b];if(c){if(a.started=!0,c.bubbleTimeoutFunc&&c.bubbleTimeoutFunc(),window.clearTimeout(c.bubbleTimeout),!c.visible)return a.complete=!0,a.complete;var d=document.getElementById("speechBubbleText"+b),e={svgText:d,text:a.text,width:lb,lineHeight:ib,topMargin:kb,sideMargin:hb,maxLines:jb,fullHeight:mb},f=wb(e),g=document.getElementById("speechBubblePath"+b),h=document.getElementById("speechBubble"+b);return g.setAttribute("height",f),Qb(g),N.displaySprite(a.spriteIndex),h.setAttribute("visibility","visible"),c.bubbleTimeoutFunc=rb(this,N.hideSpeechBubble,a),c.bubbleTimeout=window.setTimeout(c.bubbleTimeoutFunc,1e3*a.seconds),a.complete}},N.stop=function(a){if(tb(a.spriteIndex,!0),tb(a.spriteIndex,!1),!a.dontResetCollisions){var b=N.sprite[a.spriteIndex];if(!b)return;b.clearCollisions();for(var c=0;c<N.spriteCount;c++)c!==a.spriteIndex&&N.sprite[c].endCollision(a.spriteIndex)}},N.throwProjectile=function(a){if(a.started)return a.complete;a.started=!0,a.complete=!1,window.setTimeout(function(){a.complete=!0},ob);var b=N.sprite[a.spriteIndex];if(b.visible){var c,d=P.preventProjectileLoop&&P.preventProjectileLoop(a.className);c=/.gif$/.test(P[a.className])?1:P.specialProjectileFrames&&P.specialProjectileFrames[a.className]?P.specialProjectileFrames[a.className]:P.projectileFrames;var e={frames:c,className:a.className,dir:a.dir,image:P[a.className],loop:!d,spriteX:b.x,spriteY:b.y,spriteHeight:b.projectileSpriteHeight||b.height,spriteWidth:b.projectileSpriteWidth||b.width},f=new z(e);f.createElement(document.getElementById("svgStudio")),N.projectiles.push(f)}};var Xb=function(a,b){if("bounce"===b)a.bounce();else{if("disappear"!==b)throw"unknown action in doMakeProjectile";a.removeElement();var c=N.projectiles.indexOf(a);if(-1!==c)return N.projectiles.splice(c,1),!0}return!1};N.makeProjectile=function(a){if(a.projectile)Xb(a.projectile,a.action);else for(var b=0;b<N.projectiles.length;b++)N.projectiles[b].className===a.className&&Xb(N.projectiles[b],a.action)&&b--};var Yb=function(a,b){switch(b){case r.Position.OUTTOPOUTLEFT:case r.Position.TOPOUTLEFT:case r.Position.MIDDLEOUTLEFT:case r.Position.BOTTOMOUTLEFT:case r.Position.OUTBOTTOMOUTLEFT:return-a.width;case r.Position.OUTTOPLEFT:case r.Position.TOPLEFT:case r.Position.MIDDLELEFT:case r.Position.BOTTOMLEFT:case r.Position.OUTBOTTOMLEFT:return 0;case r.Position.OUTTOPCENTER:case r.Position.TOPCENTER:case r.Position.MIDDLECENTER:case r.Position.BOTTOMCENTER:case r.Position.OUTBOTTOMCENTER:return(N.MAZE_WIDTH-a.width)/2;case r.Position.OUTTOPRIGHT:case r.Position.TOPRIGHT:case r.Position.MIDDLERIGHT:case r.Position.BOTTOMRIGHT:case r.Position.OUTBOTTOMRIGHT:return N.MAZE_WIDTH-a.width;case r.Position.OUTTOPOUTRIGHT:case r.Position.TOPOUTRIGHT:case r.Position.MIDDLEOUTRIGHT:case r.Position.BOTTOMOUTRIGHT:case r.Position.OUTBOTTOMOUTRIGHT:return N.MAZE_WIDTH}},Zb=function(a,b){switch(b){case r.Position.OUTTOPOUTLEFT:case r.Position.OUTTOPLEFT:case r.Position.OUTTOPCENTER:case r.Position.OUTTOPRIGHT:case r.Position.OUTTOPOUTRIGHT:return-a.height;case r.Position.TOPOUTLEFT:case r.Position.TOPLEFT:case r.Position.TOPCENTER:case r.Position.TOPRIGHT:case r.Position.TOPOUTRIGHT:return 0;case r.Position.MIDDLEOUTLEFT:case r.Position.MIDDLELEFT:case r.Position.MIDDLECENTER:case r.Position.MIDDLERIGHT:case r.Position.MIDDLEOUTRIGHT:return(N.MAZE_HEIGHT-a.height)/2;case r.Position.BOTTOMOUTLEFT:case r.Position.BOTTOMLEFT:case r.Position.BOTTOMCENTER:case r.Position.BOTTOMRIGHT:case r.Position.BOTTOMOUTRIGHT:return N.MAZE_HEIGHT-a.height;case r.Position.OUTBOTTOMOUTLEFT:case r.Position.OUTBOTTOMLEFT:case r.Position.OUTBOTTOMCENTER:case r.Position.OUTBOTTOMRIGHT:case r.Position.OUTBOTTOMOUTRIGHT:return N.MAZE_HEIGHT}};N.collideSpriteWith=function(a,b,c){var d=N.sprite[a];d.startCollision(b)&&m(a,b,c)},N.setSpritePosition=function(a){var b=N.sprite[a.spriteIndex];a.value&&(a.x=Yb(b,a.value),a.y=Zb(b,a.value));var c=b.x===a.x&&b.y===a.y;N.stop({spriteIndex:a.spriteIndex,dontResetCollisions:c}),b.x=a.x,b.y=a.y,b.dir=F.NONE},N.setSpriteXY=function(a){var b=N.sprite[a.spriteIndex],c=a.x-b.width/2,d=a.y-b.height/2,e=b.x===c&&b.y===d;N.stop({spriteIndex:a.spriteIndex,dontResetCollisions:e}),b.x=c,b.y=d,b.dir=F.NONE},N.moveSingle=function(a){var b=N.sprite[a.spriteIndex];switch(b.lastMove=N.tickCount,a.dir){case F.NORTH:b.y-=b.speed,b.y<0&&!O.allowSpritesOutsidePlayspace&&(b.y=0);break;case F.EAST:b.x+=b.speed;var c=N.MAZE_WIDTH-b.width;b.x>c&&!O.allowSpritesOutsidePlayspace&&(b.x=c);break;case F.SOUTH:b.y+=b.speed;var d=N.MAZE_HEIGHT-b.height;b.y>d&&!O.allowSpritesOutsidePlayspace&&(b.y=d);break;case F.WEST:b.x-=b.speed,b.x<0&&!O.allowSpritesOutsidePlayspace&&(b.x=0)}},N.moveDistance=function(a){return a.started||(a.started=!0,a.queuedDistance=a.distance),0===a.queuedDistance},N.onEvent=function(a){Db(N.eventHandlers,a.eventName,a.func)},N.allWhenRunBlocksComplete=function(){for(var a=0;a<N.eventHandlers.length;a++)if("whenGameStarts"===N.eventHandlers[a].name&&0!==N.eventHandlers[a].cmdQueue.length)return!1;return!0},N.timedOut=function(){return O.timeoutAfterWhenRun&&(0===N.eventHandlers.length||1===N.eventHandlers.length&&"whenGameStarts"===N.eventHandlers[0].name&&N.allWhenRunBlocksComplete())?!0:N.tickCount>N.timeoutFailureTick},N.allGoalsVisited=function(){var a,b,c=N.sprite[N.protagonistSpriteIndex],d=0;if(0===N.spriteGoals_.length)return!1;if(N.protagonistSpriteIndex&&!c)return!1;for(a=0;a<N.spriteGoals_.length;a++){var e=N.spriteGoals_[a];if(!e.finished){if(c){var g=e.finished;if(e.finished=o(c,e),!g&&e.finished){var h=!1,i="whenSpriteCollided-"+N.protagonistSpriteIndex+"-";f(i+"anything",h)}}else{e.finished=!1;for(var j=0;j<N.sprite.length;j++)if(o(N.sprite[j],e)){e.finished=!0;break}}b=e.finished}if(e.finished){d++,b&&d!==N.spriteGoals_.length&&p.playAudio("flag");var k=P.goalSuccess;O.goalOverride&&O.goalOverride.success&&(k=P[O.goalOverride.success]);var l=document.getElementById("spriteFinish"+a);l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",k)}}return d===N.spriteGoals_.length};var $b=function(){return O.goal&&O.goal.successCondition&&O.goal.successCondition()?(N.result=K.SUCCESS,!0):O.goal&&O.goal.failureCondition&&O.goal.failureCondition()?(N.result=K.FAILURE,!0):N.allGoalsVisited()?(N.result=K.SUCCESS,!0):N.timedOut()?(N.result=K.FAILURE,!0):!1}},{"../../locale/current/common":189,"../../locale/current/studio":195,"../StudioApp":2,"../canvg/StackBlur.js":38,"../canvg/canvg.js":39,"../canvg/rgbcolor.js":40,"../canvg/svg_todataurl":41,"../codegen":42,"../constants":43,"../dom":44,"../skins":143,"../templates/page.html":164,"../utils":184,"../xml":185,"./api":145,"./bigGameLogic":146,"./blocks":147,"./collidable":148,"./constants":149,"./controls.html":150,"./extraControlRows.html":151,"./projectile":154,"./visualization.html":157}],157:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="svgStudio">\n</svg>\n<div id="capacityBubble">\n  <div id="capacity"></div>\n</div>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:205}],154:[function(a,b){var c=a("./collidable"),d=a("./constants").Direction,e=a("./constants"),f="http://www.w3.org/2000/svg",g=0,h={};h[d.EAST]=0,h[d.SOUTH]=90,h[d.WEST]=180,h[d.NORTH]=270;var i={};i[d.NORTH]={x:.5,y:0},i[d.EAST]={x:1,y:.5},i[d.SOUTH]={x:.5,y:1},i[d.WEST]={x:0,y:.5};var j={};j[d.NORTH]={x:0,y:-25},j[d.EAST]={x:25,y:0},j[d.SOUTH]={x:0,y:25},j[d.WEST]={x:-25,y:0};var k=function(a){c.apply(this,arguments),this.height=a.height||50,this.width=a.width||50,this.speed=a.speed||e.DEFAULT_SPRITE_SPEED/2,this.currentFrame_=0;var b=this;this.animator_=window.setInterval(function(){(b.loop||b.currentFrame_+1<b.frames)&&(b.currentFrame_=(b.currentFrame_+1)%b.frames)},50),this.x=a.spriteX+j[a.dir].x+a.spriteWidth*i[a.dir].x,this.y=a.spriteY+j[a.dir].y+a.spriteHeight*i[a.dir].y};k.prototype=new c,b.exports=k,k.prototype.createElement=function(a){this.clipPath=document.createElementNS(f,"clipPath");var b="projectile_clippath_"+g++;this.clipPath.setAttribute("id",b);var c=document.createElementNS(f,"rect");c.setAttribute("width",this.width),c.setAttribute("height",this.height),this.clipPath.appendChild(c),a.appendChild(this.clipPath),this.element=document.createElementNS(f,"image"),this.element.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.image),this.element.setAttribute("height",this.height),this.element.setAttribute("width",this.width*this.frames),a.appendChild(this.element),this.element.setAttribute("clip-path","url(#"+b+")")},k.prototype.removeElement=function(){this.element&&(this.element.parentNode.removeChild(this.element),this.element=null),this.clipPath&&(this.clipPath.parentNode.removeChild(this.clipPath),this.clipPath=null),this.animator_&&(window.clearInterval(this.animator_),this.animator_=null)},k.prototype.display=function(){var a={x:this.x-this.width/2,y:this.y-this.height/2};this.element.setAttribute("x",a.x-this.width*this.currentFrame_),this.element.setAttribute("y",a.y);var b=this.clipPath.childNodes[0];b.setAttribute("x",a.x),b.setAttribute("y",a.y),this.frames>1&&this.element.setAttribute("transform","rotate("+h[this.dir]+", "+this.x+", "+this.y+")")},k.prototype.getNextPosition=function(){var a=d.getUnitVector(this.dir);return{x:this.x+this.speed*a.x,y:this.y+this.speed*a.y}},k.prototype.moveToNextPosition=function(){var a=this.getNextPosition();this.x=a.x,this.y=a.y}},{"./collidable":148,"./constants":149}],155:[function(a,b,c){function d(a){a.preloadAssets=!1,a.defaultBackground="leafy",a.projectileFrames=10,a.specialProjectileFrames={projectile_cherry:13,projectile_ice:12,projectile_duck:12},a.explosion=a.assetUrl("vanish.png"),a.explosionFrames=17,a.projectileSpriteWidth=70,a.projectileSpriteHeight=70,a.avatarList=["anna","elsa","hiro","baymax","rapunzel"],a.avatarList.forEach(function(b){a[b]={sprite:a.assetUrl("avatar_"+b+".png"),walk:a.assetUrl("walk_"+b+".png"),dropdownThumbnail:a.assetUrl("avatar_"+b+"_thumb.png"),frameCounts:{normal:19,animation:0,turns:8,emotions:0,walk:12},timePerFrame:100}}),a.preventProjectileLoop=function(a){return"projectile_hiro"===a},a.projectile_hiro=a.assetUrl("projectile_hiro.png"),a.projectile_anna=a.assetUrl("projectile_anna.png"),a.projectile_elsa=a.assetUrl("projectile_elsa.png"),a.projectile_baymax=a.assetUrl("projectile_baymax.png"),a.projectile_rapunzel=a.assetUrl("projectile_rapunzel.png"),a.projectile_cherry=a.assetUrl("projectile_cherry.png"),a.projectile_ice=a.assetUrl("projectile_ice.png"),a.projectile_duck=a.assetUrl("projectile_duck.png"),a.leafy={background:a.assetUrl("background_leafy.png")},a.grassy={background:a.assetUrl("background_grassy.png")},a.flower={background:a.assetUrl("background_flower.png")},a.tile={background:a.assetUrl("background_tile.png")},a.icy={background:a.assetUrl("background_icy.png")},a.snowy={background:a.assetUrl("background_snowy.png")},a.backgroundChoices=[[g.setBackgroundRandom(),i],[g.setBackgroundLeafy(),'"leafy"'],[g.setBackgroundGrassy(),'"grassy"'],[g.setBackgroundFlower(),'"flower"'],[g.setBackgroundTile(),'"tile"'],[g.setBackgroundIcy(),'"icy"'],[g.setBackgroundSnowy(),'"snowy"']],a.backgroundChoicesK1=[[a.randomPurpleIcon,i],[g.setBackgroundLeafy(),'"leafy"'],[g.setBackgroundGrassy(),'"grassy"']],a.spriteChoices=[[g.setSpriteHidden(),j],[g.setSpriteRandom(),i],[g.setSpriteAnna(),'"anna"'],[g.setSpriteElsa(),'"elsa"'],[g.setSpriteHiro(),'"hiro"'],[g.setSpriteBaymax(),'"baymax"'],[g.setSpriteRapunzel(),'"rapunzel"']],a.projectileChoices=[[g.projectileHiro(),'"projectile_hiro"'],[g.projectileAnna(),'"projectile_anna"'],[g.projectileElsa(),'"projectile_elsa"'],[g.projectileBaymax(),'"projectile_baymax"'],[g.projectileRapunzel(),'"projectile_rapunzel"'],[g.projectileCherry(),'"projectile_cherry"'],[g.projectileIce(),'"projectile_ice"'],[g.projectileDuck(),'"projectile_duck"'],[g.projectileRandom(),i]]}function e(a){a.defaultBackground="cave",a.projectileFrames=8,a.explosion=a.assetUrl("explosion.gif"),a.explosionThumbnail=a.assetUrl("explosion_thumb.png"),a.hardcourt={background:a.assetUrl("background.png")},a.black={background:a.assetUrl("retro_background.png")},a.cave={background:a.assetUrl("background_cave.png")},a.night={background:a.assetUrl("background_santa.png")},a.cloudy={background:a.assetUrl("background_scifi.png")},a.underwater={background:a.assetUrl("background_underwater.png")},a.city={background:a.assetUrl("background_city.png")},a.desert={background:a.assetUrl("background_desert.png")},a.rainbow={background:a.assetUrl("background_rainbow.png")},a.soccer={background:a.assetUrl("background_soccer.png")},a.space={background:a.assetUrl("background_space.png")},a.tennis={background:a.assetUrl("background_tennis.png")},a.winter={background:a.assetUrl("background_winter.png")},a.grid={background:a.assetUrl("background_grid.png")},a.avatarList=["dog","cat","penguin","dinosaur","octopus","witch","bat","bird","dragon","squirrel","wizard","alien","ghost","monster","robot","unicorn","zombie","knight","ninja","pirate","caveboy","cavegirl","princess","spacebot","soccergirl","soccerboy","tennisgirl","tennisboy"],a.avatarList.forEach(function(b){a[b]={sprite:a.assetUrl(b+"_spritesheet_200px.png"),dropdownThumbnail:a.assetUrl(b+"_thumb.png"),frameCounts:{normal:1,animation:1,turns:7,emotions:3}}}),a.backgroundChoices=[[g.setBackgroundRandom(),i],[g.setBackgroundCave(),'"cave"'],[g.setBackgroundNight(),'"night"'],[g.setBackgroundCloudy(),'"cloudy"'],[g.setBackgroundUnderwater(),'"underwater"'],[g.setBackgroundHardcourt(),'"hardcourt"'],[g.setBackgroundBlack(),'"black"'],[g.setBackgroundCity(),'"city"'],[g.setBackgroundDesert(),'"desert"'],[g.setBackgroundRainbow(),'"rainbow"'],[g.setBackgroundSoccer(),'"soccer"'],[g.setBackgroundSpace(),'"space"'],[g.setBackgroundTennis(),'"tennis"'],[g.setBackgroundWinter(),'"winter"']],a.backgroundChoicesK1=[[a.cave.background,'"cave"'],[a.night.background,'"night"'],[a.cloudy.background,'"cloudy"'],[a.underwater.background,'"underwater"'],[a.hardcourt.background,'"hardcourt"'],[a.black.background,'"black"'],[a.city.background,'"city"'],[a.desert.background,'"desert"'],[a.rainbow.background,'"rainbow"'],[a.soccer.background,'"soccer"'],[a.space.background,'"space"'],[a.tennis.background,'"tennis"'],[a.winter.background,'"winter"'],[a.randomPurpleIcon,i]],a.spriteChoices=[[g.setSpriteHidden(),j],[g.setSpriteRandom(),i],[g.setSpriteWitch(),'"witch"'],[g.setSpriteCat(),'"cat"'],[g.setSpriteDinosaur(),'"dinosaur"'],[g.setSpriteDog(),'"dog"'],[g.setSpriteOctopus(),'"octopus"'],[g.setSpritePenguin(),'"penguin"'],[g.setSpriteBat(),'"bat"'],[g.setSpriteBird(),'"bird"'],[g.setSpriteDragon(),'"dragon"'],[g.setSpriteSquirrel(),'"squirrel"'],[g.setSpriteWizard(),'"wizard"'],[g.setSpriteAlien(),'"alien"'],[g.setSpriteGhost(),'"ghost"'],[g.setSpriteMonster(),'"monster"'],[g.setSpriteRobot(),'"robot"'],[g.setSpriteUnicorn(),'"unicorn"'],[g.setSpriteZombie(),'"zombie"'],[g.setSpriteKnight(),'"knight"'],[g.setSpriteNinja(),'"ninja"'],[g.setSpritePirate(),'"pirate"'],[g.setSpriteCaveBoy(),'"caveboy"'],[g.setSpriteCaveGirl(),'"cavegirl"'],[g.setSpritePrincess(),'"princess"'],[g.setSpriteSpacebot(),'"spacebot"'],[g.setSpriteSoccerGirl(),'"soccergirl"'],[g.setSpriteSoccerBoy(),'"soccerboy"'],[g.setSpriteTennisGirl(),'"tennisgirl"'],[g.setSpriteTennisBoy(),'"tennisboy"']],a.projectileChoices=[[g.projectileBlueFireball(),'"blue_fireball"'],[g.projectilePurpleFireball(),'"purple_fireball"'],[g.projectileRedFireball(),'"red_fireball"'],[g.projectileYellowHearts(),'"yellow_hearts"'],[g.projectilePurpleHearts(),'"purple_hearts"'],[g.projectileRedHearts(),'"red_hearts"'],[g.projectileRandom(),i]]}{var f=a("../skins"),g=a("../../locale/current/studio"),h=a("./constants"),i=h.RANDOM_VALUE,j=h.HIDDEN_VALUE;h.CLICK_VALUE,h.VISIBLE_VALUE}c.load=function(a,b){var c=f.load(a,b);switch(c.yellow_hearts=c.assetUrl("yellow_hearts.gif"),c.purple_hearts=c.assetUrl("purple_hearts.gif"),c.red_hearts=c.assetUrl("red_hearts.gif"),c.blue_fireball=c.assetUrl("blue_fireball.png"),c.purple_fireball=c.assetUrl("purple_fireball.png"),c.red_fireball=c.assetUrl("red_fireball.png"),c.whenUp=c.assetUrl("when-up.png"),c.whenDown=c.assetUrl("when-down.png"),c.whenLeft=c.assetUrl("when-left.png"),c.whenRight=c.assetUrl("when-right.png"),c.collide=c.assetUrl("when-sprite-collide.png"),c.emotionAngry=c.assetUrl("emotion-angry.png"),c.emotionNormal=c.assetUrl("emotion-nothing.png"),c.emotionSad=c.assetUrl("emotion-sad.png"),c.emotionHappy=c.assetUrl("emotion-happy.png"),c.speechBubble=c.assetUrl("say-sprite.png"),c.goal=c.assetUrl("goal.png"),c.goalSuccess=c.assetUrl("goal_success.png"),c.rubberSound=[c.assetUrl("wall.mp3"),c.assetUrl("wall.ogg")],c.flagSound=[c.assetUrl("win_goal.mp3"),c.assetUrl("win_goal.ogg")],c.crunchSound=[c.assetUrl("wall0.mp3"),c.assetUrl("wall0.ogg")],c.winPointSound=[c.assetUrl("1_we_win.mp3"),c.assetUrl("1_we_win.ogg")],c.winPoint2Sound=[c.assetUrl("2_we_win.mp3"),c.assetUrl("2_we_win.ogg")],c.losePointSound=[c.assetUrl("1_we_lose.mp3"),c.assetUrl("1_we_lose.ogg")],c.losePoint2Sound=[c.assetUrl("2_we_lose.mp3"),c.assetUrl("2_we_lose.ogg")],c.goal1Sound=[c.assetUrl("1_goal.mp3"),c.assetUrl("1_goal.ogg")],c.goal2Sound=[c.assetUrl("2_goal.mp3"),c.assetUrl("2_goal.ogg")],c.woodSound=[c.assetUrl("1_paddle_bounce.mp3"),c.assetUrl("1_paddle_bounce.ogg")],c.retroSound=[c.assetUrl("2_paddle_bounce.mp3"),c.assetUrl("2_paddle_bounce.ogg")],c.slapSound=[c.assetUrl("1_wall_bounce.mp3"),c.assetUrl("1_wall_bounce.ogg")],c.hitSound=[c.assetUrl("2_wall_bounce.mp3"),c.assetUrl("2_wall_bounce.ogg")],c.background=c.assetUrl("background.png"),c.spriteHeight=100,c.spriteWidth=100,c.dropdownThumbnailWidth=50,c.dropdownThumbnailHeight=50,c.preloadAssets=!0,c.id){case"infinity":d(c,a);break;case"studio":e(c,a)}return c}},{"../../locale/current/studio":195,"../skins":143,"./constants":149}],152:[function(a,b){function c(a){var b={};return a.sprite&&(b.SPRITE=a.sprite),a.requiredText&&(b.TEXT=a.requiredText),a.notDefaultText&&(b.TEXT=d.helloWorld()),[{test:function(b){return"studio_saySprite"!==b.type?!1:a.sprite&&b.getTitleValue("SPRITE")!==a.sprite?!1:(a.notDefaultText||a.requiredText)&&b.getTitleValue("TEXT")===d.defaultSayText()?!1:!0},type:"studio_saySprite",titles:b}]}var d=a("../../locale/current/studio"),e=a("../utils"),f=a("../block_utils"),g=a("./constants"),h=(g.Direction,g.Emotions),i=f.createToolbox,j=f.blockOfType,k=f.createCategory,l=j("studio_moveNorthDistance")+j("studio_moveEastDistance")+j("studio_moveSouthDistance")+j("studio_moveWestDistance"),m=(j("studio_moveNorth")+j("studio_moveEast")+j("studio_moveSouth")+j("studio_moveWest"),b.exports={});m.custom={ideal:1/0,requiredBlocks:[],scale:{snapRadius:2},startBlocks:""},m.dog_hello={ideal:2,requiredBlocks:[c({notDefaultText:!0})],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return Studio.sayComplete>0}},timeoutFailureTick:100,toolbox:i(j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.k1_1=e.extend(m.dog_hello,{isK1:!0,toolbox:i(j("studio_saySprite"))}),m.c2_1=e.extend(m.dog_hello),m.c3_story_1=e.extend(m.dog_hello),m.playlab_1=e.extend(m.dog_hello,{background:"winter",timeoutFailureTick:null,timeoutAfterWhenRun:!0,firstSpriteIndex:2,goal:{successCondition:function(){return Studio.allWhenRunBlocksComplete()&&Studio.sayComplete>0}},requiredBlocks:[c({requiredText:d.hello()})]}),m.dog_and_cat_hello={ideal:3,requiredBlocks:[c({sprite:"0",notDefaultText:!0}),c({sprite:"1",notDefaultText:!0})],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,16,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return Studio.sayComplete>1}},timeoutFailureTick:200,toolbox:i(j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.k1_2=e.extend(m.dog_and_cat_hello,{isK1:!0,toolbox:i(j("studio_saySprite"))}),m.c2_2=e.extend(m.dog_and_cat_hello,{}),m.c3_story_2=e.extend(m.dog_and_cat_hello,{}),m.playlab_2=e.extend(m.dog_and_cat_hello,{background:"desert",firstSpriteIndex:20,timeoutFailureTick:null,timeoutAfterWhenRun:!0,defaultEmotion:h.HAPPY,goal:{successCondition:function(){return Studio.allWhenRunBlocksComplete()&&Studio.sayComplete>1}},requiredBlocks:[c({sprite:"0",requiredText:d.hello()}),c({sprite:"1",requiredText:d.hello()})],map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]}),m.dog_move_cat={ideal:2,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{DIR:"2"}}]],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,16,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)}},timeoutFailureTick:100,toolbox:i('<block type="studio_moveDistance"><title name="DIR">2</title></block>'+j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.k1_3=e.extend(m.dog_move_cat,{isK1:!0,requiredBlocks:[[{test:function(a){return"studio_moveEastDistance"==a.type},type:"studio_moveEastDistance"}]],toolbox:i(l+j("studio_saySprite"))}),m.c2_3=e.extend(m.dog_move_cat,{}),m.c3_story_3=e.extend(m.dog_move_cat,{}),m.playlab_3={ideal:2,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{DIR:"2",DISTANCE:"200"}}]],timeoutFailureTick:null,timeoutAfterWhenRun:!0,scale:{snapRadius:2},background:"tennis",firstSpriteIndex:26,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)}},toolbox:i('<block type="studio_moveDistance"><title name="DIR">1</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">2</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">4</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">8</title><title name="DISTANCE">200</title></block>'),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>',map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,1,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},m.dog_move_cat_hello={ideal:4,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{DIR:"2",DISTANCE:"100"}}],c({sprite:"1",requiredText:d.hello()})],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,16,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return Studio.sayComplete>0&&Studio.sprite[0].isCollidingWith(1)}},timeoutFailureTick:200,toolbox:i('<block type="studio_moveDistance"><title name="DIR">2</title></block>'+j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>     <block type="studio_whenSpriteCollided" deletable="false" x="20" y="120"></block>'},m.k1_4=e.extend(m.dog_move_cat_hello,{isK1:!0,requiredBlocks:[[{test:function(a){return"studio_moveEastDistance"==a.type},type:"studio_moveEastDistance"}],[{test:function(a){return"studio_saySprite"==a.type&&"1"===a.getTitleValue("SPRITE")&&a.getTitleValue("TEXT")!==d.defaultSayText()},type:"studio_saySprite",titles:{TEXT:d.hello(),SPRITE:"1"}}]],toolbox:i(l+j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>      <block type="studio_whenSpriteCollided" deletable="false" x="20" y="140"></block>'}),m.c2_4=e.extend(m.dog_move_cat_hello,{}),m.c3_story_4=e.extend(m.dog_move_cat_hello,{}),m.playlab_4={ideal:4,scale:{snapRadius:2},background:"tennis",avatarList:["tennisboy","tennisgirl"],defaultEmotion:h.SAD,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{DIR:"4",DISTANCE:"200"}}],[{test:"playSound",type:"studio_playSound",titles:{SOUND:"goal1"}}]],timeoutFailureTick:100,timeoutAfterWhenRun:!0,goal:{successCondition:function(){return Studio.playSoundCount>0&&Studio.sprite[0].isCollidingWith(1)}},toolbox:i('<block type="studio_moveDistance"><title name="DIR">1</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">2</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">4</title><title name="DISTANCE">200</title></block><block type="studio_moveDistance"><title name="DIR">8</title><title name="DISTANCE">200</title></block><block type="studio_playSound"><title name="SOUND">goal1</title></block>'),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block><block type="studio_whenSpriteCollided" deletable="false" x="20" y="120"></block>',map:[[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},m.click_hello={ideal:3,requiredBlocks:[c({requiredText:d.hello()})],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:4,goal:{successCondition:function(){return this.successState.seenCmd||(this.successState.seenCmd=Studio.isCmdCurrentInQueue("saySprite","whenSpriteClicked-0")),Studio.sayComplete>0&&this.successState.seenCmd}},timeoutFailureTick:300,toolbox:i('<block type="studio_moveDistance"><title name="DIR">2</title></block>'+j("studio_saySprite")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>     <block type="studio_whenSpriteClicked" deletable="false" x="20" y="120"></block>'},m.c2_5=e.extend(m.click_hello,{}),m.c3_game_1=e.extend(m.click_hello,{}),m.playlab_5=e.extend(m.click_hello,{background:"space",firstSpriteIndex:23,timeoutAfterWhenRun:!0,defaultEmotion:h.HAPPY,toolbox:i(j("studio_saySprite")),startBlocks:'<block type="studio_whenSpriteClicked" deletable="false" x="20" y="20"></block>'}),m.octopus_happy={ideal:2,requiredBlocks:[[{test:"setSpriteEmotion",type:"studio_setSpriteEmotion"}]],scale:{snapRadius:2},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:4,goal:{successCondition:function(){return Studio.sprite[0].emotion===h.HAPPY&&Studio.tickCount>=50}},timeoutFailureTick:100,toolbox:i('<block type="studio_moveDistance"><title name="DIR">2</title></block>'+j("studio_setSpriteEmotion")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.k1_5=e.extend(m.octopus_happy,{isK1:!0,toolbox:i(l+j("studio_setSpriteEmotion"))}),m.c3_story_5=e.extend(m.octopus_happy,{}),m.c3_story_6={ideal:1/0,requiredBlocks:[],scale:{snapRadius:2},minWorkspaceHeight:1400,edgeCollisions:!0,projectileCollisions:!0,allowSpritesOutsidePlayspace:!1,spritesHiddenToStart:!0,freePlay:!0,map:[[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0]],toolbox:i(j("studio_setSprite")+j("studio_setBackground")+j("studio_whenSpriteCollided")+j("studio_repeatForever")+j("studio_showTitleScreen")+j("studio_move")+j("studio_moveDistance")+j("studio_stop")+j("studio_wait")+j("studio_playSound")+j("studio_changeScore")+j("studio_saySprite")+j("studio_setSpritePosition")+j("studio_setSpriteSpeed")+j("studio_setSpriteEmotion")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.move_penguin={ideal:8,requiredBlocks:[[{test:"move",type:"studio_move"}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0],[0,0,16,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,1,0,0,0,0,1,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,toolbox:i(j("studio_move")+j("studio_saySprite")),startBlocks:'<block type="studio_whenLeft" deletable="false" x="20" y="20"></block>     <block type="studio_whenRight" deletable="false" x="180" y="20"></block>     <block type="studio_whenUp" deletable="false" x="20" y="120"></block>     <block type="studio_whenDown" deletable="false" x="180" y="120"></block>'},m.c2_6=e.extend(m.move_penguin,{}),m.c3_game_2=e.extend(m.move_penguin,{}),m.playlab_6=e.extend(m.move_penguin,{background:"cave",firstSpriteIndex:5,goalOverride:{goal:"red_fireball",success:"blue_fireball",imageWidth:800},defaultEmotion:h.ANGRY,toolbox:i(j("studio_move",{DIR:8})+j("studio_move",{DIR:2})+j("studio_move",{DIR:1})+j("studio_move",{DIR:4})),map:[[1,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0]]}),m.dino_up_and_down={ideal:11,requiredBlocks:[[{test:"moveDistance",type:"studio_moveDistance",titles:{SPRITE:"1",DISTANCE:"400"}}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,16,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,protagonistSpriteIndex:1,timeoutFailureTick:150,minWorkspaceHeight:800,toolbox:i('<block type="studio_moveDistance">          <title name="DISTANCE">400</title>          <title name="SPRITE">1</title></block><block type="studio_saySprite">          <title name="SPRITE">1</title></block>'),startBlocks:'<block type="studio_whenLeft" deletable="false" x="20" y="20">       <next><block type="studio_move">               <title name="DIR">8</title></block>       </next></block>     <block type="studio_whenRight" deletable="false" x="20" y="150">       <next><block type="studio_move">               <title name="DIR">2</title></block>       </next></block>     <block type="studio_whenUp" deletable="false" x="20" y="280">       <next><block type="studio_move">               <title name="DIR">1</title></block>       </next></block>     <block type="studio_whenDown" deletable="false" x="20" y="410">       <next><block type="studio_move">               <title name="DIR">4</title></block>       </next></block>     <block type="studio_repeatForever" deletable="false" x="20" y="540"></block>'},m.c2_7=e.extend(m.dino_up_and_down,{}),m.c3_game_3=e.extend(m.dino_up_and_down,{}),m.playlab_7={ideal:3,background:"rainbow",firstSpriteIndex:10,scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],defaultEmotion:h.HAPPY,map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],goal:{successCondition:function(){return 252===Studio.tickCount
}},timeoutFailureTick:253,minWorkspaceHeight:800,toolbox:i('<block type="studio_moveDistance"><title name="DIR">1</title><title name="DISTANCE">400</title></block><block type="studio_moveDistance"><title name="DIR">2</title><title name="DISTANCE">400</title></block><block type="studio_moveDistance"><title name="DIR">4</title><title name="DISTANCE">400</title></block><block type="studio_moveDistance"><title name="DIR">8</title><title name="DISTANCE">400</title></block>'),startBlocks:'<block type="studio_repeatForever" deletable="false" x="20" y="20"></block>',requiredBlocks:[[{test:function(a){return"studio_moveDistance"===a.type&&"2"===a.getTitleValue("DIR")},type:"studio_moveDistance",titles:{DIR:2,DISTANCE:"400"}}],[{test:function(a){return"studio_moveDistance"===a.type&&"8"===a.getTitleValue("DIR")},type:"studio_moveDistance",titles:{DIR:8,DISTANCE:"400"}}]]},m.penguin_ouch={ideal:14,requiredBlocks:[c({sprite:"0",requiredText:d.ouchExclamation()}),[{test:"playSound",type:"studio_playSound"}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,16,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,minWorkspaceHeight:900,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)}},timeoutFailureTick:300,toolbox:i('<block type="studio_moveDistance">          <title name="DISTANCE">400</title>          <title name="SPRITE">1</title></block>'+j("studio_saySprite")+j("studio_playSound")),startBlocks:'<block type="studio_whenLeft" deletable="false" x="20" y="20">       <next><block type="studio_move">               <title name="DIR">8</title></block>       </next></block>     <block type="studio_whenRight" deletable="false" x="20" y="150">       <next><block type="studio_move">               <title name="DIR">2</title></block>       </next></block>     <block type="studio_whenUp" deletable="false" x="20" y="280">       <next><block type="studio_move">               <title name="DIR">1</title></block>       </next></block>     <block type="studio_whenDown" deletable="false" x="20" y="410">       <next><block type="studio_move">               <title name="DIR">4</title></block>       </next></block>     <block type="studio_repeatForever" deletable="false" x="20" y="540">       <statement name="DO"><block type="studio_moveDistance">               <title name="SPRITE">1</title>               <title name="DISTANCE">400</title>         <next><block type="studio_moveDistance">                 <title name="SPRITE">1</title>                 <title name="DISTANCE">400</title>                 <title name="DIR">4</title></block>         </next></block>     </statement></block>     <block type="studio_whenSpriteCollided" deletable="false" x="20" y="730"></block>'},m.c2_8=e.extend(m.penguin_ouch,{}),m.c3_game_4=e.extend(m.penguin_ouch,{}),m.penguin_touch_octopus={ideal:16,requiredBlocks:[[{test:"changeScore",type:"studio_changeScore"}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,16,0,16,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,minWorkspaceHeight:1050,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(2)}},timeoutFailureTick:600,toolbox:i('<block type="studio_moveDistance">          <title name="DISTANCE">400</title>          <title name="SPRITE">1</title></block>'+j("studio_saySprite")+j("studio_playSound")+j("studio_changeScore")),startBlocks:'<block type="studio_whenLeft" deletable="false" x="20" y="20">       <next><block type="studio_move">               <title name="DIR">8</title></block>       </next></block>     <block type="studio_whenRight" deletable="false" x="20" y="150">       <next><block type="studio_move">               <title name="DIR">2</title></block>       </next></block>     <block type="studio_whenUp" deletable="false" x="20" y="280">       <next><block type="studio_move">               <title name="DIR">1</title></block>       </next></block>     <block type="studio_whenDown" deletable="false" x="20" y="410">       <next><block type="studio_move">               <title name="DIR">4</title></block>       </next></block>     <block type="studio_repeatForever" deletable="false" x="20" y="540">       <statement name="DO"><block type="studio_moveDistance">               <title name="SPRITE">1</title>               <title name="DISTANCE">400</title>         <next><block type="studio_moveDistance">                 <title name="SPRITE">1</title>                 <title name="DISTANCE">400</title>                 <title name="DIR">4</title></block>         </next></block>     </statement></block>     <block type="studio_whenSpriteCollided" deletable="false" x="20" y="730">       <next><block type="studio_playSound">       <next><block type="studio_saySprite">               <title name="TEXT">Ouch!</title></block>       </next></block>       </next></block>     <block type="studio_whenSpriteCollided" deletable="false" x="20" y="860">      <title name="SPRITE2">2</title></block>'},m.c2_9=e.extend(m.penguin_touch_octopus,{}),m.c3_game_5=e.extend(m.penguin_touch_octopus,{}),m.playlab_8={background:"rainbow",ideal:16,requiredBlocks:[[{test:"changeScore",type:"studio_changeScore"}],[{test:"playSound",type:"studio_playSound",titles:{SOUND:"winpoint"}}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[0,0,0,16,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],avatarList:["unicorn","wizard"],defaultEmotion:h.HAPPY,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)&&1===Studio.playerScore},failureCondition:function(){return Studio.sprite[0].isCollidingWith(1)&&1!==Studio.playerScore}},timeoutFailureTick:600,toolbox:i(j("studio_changeScore")+'<block type="studio_playSound"><title name="SOUND">winpoint</title></block>'),startBlocks:'<block type="studio_whenSpriteCollided" deletable="false" x="20" y="20"></block><block type="studio_repeatForever" deletable="false" x="20" y="150"><statement name="DO">'+f.blockWithNext("studio_moveDistance",{SPRITE:1,DIR:2,DISTANCE:400},j("studio_moveDistance",{SPRITE:1,DIR:8,DISTANCE:400}))+'</statement></block><block type="studio_whenLeft" deletable="false" x="20" y="300"><next>'+j("studio_move",{SPRITE:0,DIR:8})+'</next></block><block type="studio_whenRight" deletable="false" x="20" y="400"><next>'+j("studio_move",{SPRITE:0,DIR:2})+'</next></block><block type="studio_whenUp" deletable="false" x="20" y="500"><next>'+j("studio_move",{SPRITE:0,DIR:1})+'</next></block><block type="studio_whenDown" deletable="false" x="20" y="600"><next>'+j("studio_move",{SPRITE:0,DIR:4})+"</next></block>"},m.change_background_and_speed={ideal:19,requiredBlocks:[[{test:"setBackground",type:"studio_setBackground",titles:{VALUE:'"night"'}}],[{test:"setSpriteSpeed",type:"studio_setSpriteSpeed",titles:{VALUE:"Studio.SpriteSpeed.FAST"}}]],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,16,0,16,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],firstSpriteIndex:2,minWorkspaceHeight:1250,goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(2)}},timeoutFailureTick:600,toolbox:i(j("studio_setBackground",{VALUE:'"night"'})+j("studio_moveDistance",{DISTANCE:400,SPRITE:1})+j("studio_saySprite")+j("studio_playSound")+j("studio_changeScore")+j("studio_setSpriteSpeed",{VALUE:"Studio.SpriteSpeed.FAST"})),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block><block type="studio_whenLeft" deletable="false" x="20" y="200"><next>'+j("studio_move",{DIR:8})+'</next></block><block type="studio_whenRight" deletable="false" x="20" y="330"><next>'+j("studio_move",{DIR:2})+'</next></block><block type="studio_whenUp" deletable="false" x="20" y="460"><next>'+j("studio_move",{DIR:1})+'</next></block><block type="studio_whenDown" deletable="false" x="20" y="590"><next>'+j("studio_move",{DIR:4})+'</next></block><block type="studio_repeatForever" deletable="false" x="20" y="720"><statement name="DO">'+f.blockWithNext("studio_moveDistance",{SPRITE:1,DIR:1,DISTANCE:400},j("studio_moveDistance",{SPRITE:1,DIR:4,DISTANCE:400}))+'</statement></block><block type="studio_whenSpriteCollided" deletable="false" x="20" y="880"><title name="SPRITE2">1</title><next>'+f.blockWithNext("studio_playSound",{},j("studio_saySprite",{TEXT:d.ouchExclamation()}))+'</next></block><block type="studio_whenSpriteCollided" deletable="false" x="20" y="1040"><title name="SPRITE2">2</title><next>'+j("studio_changeScore")+"</next></block>"},m.c2_10=e.extend(m.change_background_and_speed,{}),m.c3_game_6=e.extend(m.change_background_and_speed,{}),m.playlab_9={background:"black",requiredBlocks:[[{test:"setBackground",type:"studio_setBackground",titles:{VALUE:'"space"'}}],[{test:"setSpriteSpeed",type:"studio_setSpriteSpeed",titles:{VALUE:"Studio.SpriteSpeed.FAST"}}]],timeoutFailureTick:400,scale:{snapRadius:2},defaultEmotion:h.ANGRY,softButtons:["leftButton","rightButton","downButton","upButton"],avatarList:["spacebot","alien"],goal:{successCondition:function(){return Studio.sprite[0].isCollidingWith(1)}},map:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[16,0,0,0,0,0,16,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],toolbox:i(j("studio_setSpriteSpeed",{VALUE:"Studio.SpriteSpeed.FAST"})+j("studio_setBackground",{VALUE:'"space"'})+j("studio_moveDistance",{DISTANCE:400,SPRITE:1})+j("studio_saySprite")+j("studio_playSound",{SOUND:"winpoint2"})+j("studio_changeScore")),minWorkspaceHeight:1250,startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block><block type="studio_repeatForever" deletable="false" x="20" y="150"><statement name="DO">'+f.blockWithNext("studio_moveDistance",{SPRITE:1,DIR:1,DISTANCE:400},j("studio_moveDistance",{SPRITE:1,DIR:4,DISTANCE:400}))+'</statement></block><block type="studio_whenSpriteCollided" deletable="false" x="20" y="290"><title name="SPRITE2">0</title><title name="SPRITE2">1</title><next>'+f.blockWithNext("studio_playSound",{SOUND:"winpoint2"},j("studio_saySprite",{TEXT:d.alienInvasion()}))+'</next></block><block type="studio_whenLeft" deletable="false" x="20" y="410"><next>'+j("studio_move",{DIR:8})+'</next></block><block type="studio_whenRight" deletable="false" x="20" y="510"><next>'+j("studio_move",{DIR:2})+'</next></block><block type="studio_whenUp" deletable="false" x="20" y="610"><next>'+j("studio_move",{DIR:1})+'</next></block><block type="studio_whenDown" deletable="false" x="20" y="710"><next>'+j("studio_move",{DIR:4})+"</next></block>"},m.sandbox={ideal:1/0,requiredBlocks:[],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],minWorkspaceHeight:1400,edgeCollisions:!0,projectileCollisions:!0,allowSpritesOutsidePlayspace:!1,spritesHiddenToStart:!0,freePlay:!0,map:[[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0]],toolbox:i(j("studio_setSprite")+j("studio_setBackground")+j("studio_whenArrow")+j("studio_whenSpriteClicked")+j("studio_whenSpriteCollided")+j("studio_repeatForever")+j("studio_showTitleScreen")+j("studio_move")+j("studio_moveDistance")+j("studio_stop")+j("studio_wait")+j("studio_playSound")+j("studio_changeScore")+j("studio_saySprite")+j("studio_setSpritePosition")+j("studio_throw")+j("studio_makeProjectile")+j("studio_setSpriteSpeed")+j("studio_setSpriteEmotion")+j("studio_vanish")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.c2_11=e.extend(m.sandbox,{}),m.c3_game_7=e.extend(m.sandbox,{}),m.playlab_10=e.extend(m.sandbox,{}),m.k1_6={ideal:1/0,requiredBlocks:[],scale:{snapRadius:2},minWorkspaceHeight:1500,spritesHiddenToStart:!0,freePlay:!0,map:[[16,0,16,0,16,0,16,0],[0,16,0,16,0,16,0,0],[16,0,16,0,16,0,16,0],[0,16,0,16,0,16,0,0],[16,0,16,0,16,0,16,0],[0,16,0,16,0,16,0,0],[16,16,16,16,16,16,16,0],[0,0,0,0,0,0,0,0]],isK1:!0,softButtons:[],toolbox:i(j("studio_setSprite")+j("studio_saySprite")+l+j("studio_whenSpriteCollided")+j("studio_setBackground")+j("studio_setSpriteSpeed")+j("studio_setSpriteEmotion")+j("studio_playSound")+j("studio_vanish")),startBlocks:'<block type="when_run" deletable="false" x="20" y="20">      <next><block type="studio_setSprite">         <title name="SPRITE">0</title></block>       </next></block>'},m.k1_block_test=e.extend(m[99],{toolbox:i(j("studio_setSprite")+j("studio_moveNorth")+j("studio_moveSouth")+j("studio_moveEast")+j("studio_moveWest")+j("studio_moveNorth_length")+j("studio_moveSouth_length")+j("studio_moveEast_length")+j("studio_moveWest_length")),isK1:!0}),m.full_sandbox={scrollbars:!0,requiredBlocks:[],scale:{snapRadius:2},softButtons:["leftButton","rightButton","downButton","upButton"],minWorkspaceHeight:1400,edgeCollisions:!0,projectileCollisions:!0,allowSpritesOutsidePlayspace:!0,spritesHiddenToStart:!0,freePlay:!0,map:[[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,16,0,0,0,16,0,0],[0,0,0,0,0,0,0,0]],toolbox:i(k(d.catActions(),j("studio_setSprite")+j("studio_setBackground")+'<block type="studio_showTitleScreenParams">                         <value name="TITLE"><block type="text"></block>                         </value>                         <value name="TEXT"><block type="text"></block>                         </value></block>'+j("studio_move")+'<block type="studio_moveDistanceParams" inline="true">                       <value name="DISTANCE"><block type="math_number">                               <title name="NUM">25</title></block>                       </value></block>'+j("studio_stop")+'<block type="studio_waitParams" inline="true">                         <value name="VALUE"><block type="math_number">                                 <title name="NUM">1</title></block>                         </value></block>'+j("studio_playSound")+'<block type="studio_setScoreText" inline="true">                         <value name="TEXT"><block type="text"></block>                         </value></block><block type="studio_saySpriteParams" inline="true">                         <value name="TEXT"><block type="text"></block>                         </value></block>'+j("studio_setSpritePosition")+j("studio_throw")+j("studio_makeProjectile")+j("studio_setSpriteSpeed")+j("studio_setSpriteEmotion")+j("studio_vanish")+j("studio_setSpriteSize")+j("studio_showCoordinates"))+k(d.catEvents(),j("studio_whenArrow")+j("studio_whenSpriteClicked")+j("studio_whenSpriteCollided"))+k(d.catControl(),j("studio_repeatForever")+'<block type="controls_repeat_ext">                           <value name="TIMES">                             <block type="math_number">                               <title name="NUM">10</title>                             </block>                           </value>                         </block>'+j("controls_whileUntil")+'<block type="controls_for">                           <value name="FROM">                             <block type="math_number">                               <title name="NUM">1</title>                             </block>                           </value>                           <value name="TO">                             <block type="math_number">                               <title name="NUM">10</title>                             </block>                           </value>                           <value name="BY">                             <block type="math_number">                               <title name="NUM">1</title>                             </block>                           </value>                         </block>'+j("controls_flow_statements"))+k(d.catLogic(),j("controls_if")+j("logic_compare")+j("logic_operation")+j("logic_negate")+j("logic_boolean"))+k(d.catMath(),j("math_number")+'<block type="math_change">                           <value name="DELTA">                             <block type="math_number">                               <title name="NUM">1</title>                             </block>                           </value>                         </block><block type="math_random_int">                           <value name="FROM">                             <block type="math_number">                               <title name="NUM">1</title>                             </block>                           </value>                           <value name="TO">                             <block type="math_number">                               <title name="NUM">100</title>                             </block>                           </value>                         </block>'+j("math_arithmetic"))+k(d.catText(),j("text")+j("text_join")+'<block type="text_append">                           <value name="TEXT">                             <block type="text"></block>                           </value>                         </block>')+k(d.catVariables(),"","VARIABLE")+k(d.catProcedures(),"","PROCEDURE")+k("Functional",j("functional_string")+j("functional_background_string_picker")+j("functional_math_number")+'<block type="functional_math_number_dropdown"><title name="NUM" config="2,3,4,5,6,7,8,9,10,11,12">???</title></block>')+k("Functional Start",j("functional_start_setBackground")+j("functional_start_setSpeeds")+j("functional_start_setBackgroundAndSpeeds")+j("functional_start_dummyOnMove"))+k("Functional Logic",j("functional_greater_than")+j("functional_less_than")+j("functional_number_equals")+j("functional_string_equals")+j("functional_logical_and")+j("functional_logical_or")+j("functional_logical_not")+j("functional_boolean"))),startBlocks:'<block type="when_run" deletable="false" x="20" y="20"></block>'},m.full_sandbox_infinity=e.extend(m.full_sandbox,{}),m.ec_sandbox=e.extend(m.sandbox,{editCode:!0,codeFunctions:[{func:"setSprite",params:["0","'cat'"]},{func:"setBackground",params:["'night'"]},{func:"move",params:["0","1"]},{func:"playSound",params:["'slap'"]},{func:"changeScore",params:["1"]},{func:"setSpritePosition",params:["0","7"]},{func:"setSpriteSpeed",params:["0","8"]},{func:"setSpriteEmotion",params:["0","1"]},{func:"throwProjectile",params:["0","1","'blue_fireball'"]},{func:"vanish",params:["0"]},{func:"onEvent",params:["'when-left'","function() {\n  \n}"]}],startBlocks:""})},{"../../locale/current/studio":195,"../block_utils":17,"../utils":184,"./constants":149}],151:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("");var a=require("../../locale/current/common");buf.push("\n\n"),finishButton&&buf.push('\n  <div id="share-cell" class="share-cell-none">\n    <button id="finishButton" class="share">\n      <img src="',escape(assetUrl("media/1x1.gif")),'">',escape(a.finish()),"\n    </button>\n  </div>\n"),buf.push("\n")}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{"../../locale/current/common":189,ejs:205}],150:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("");var a=require("../../locale/current/common");buf.push('\n\n<div id="soft-buttons" class="soft-buttons-none">\n  <button id="leftButton" class="arrow">\n    <img src="',escape(assetUrl("media/1x1.gif")),'" class="left-btn icon21">\n  </button>\n  <button id="rightButton" class="arrow">\n    <img src="',escape(assetUrl("media/1x1.gif")),'" class="right-btn icon21">\n  </button>\n  <button id="upButton" class="arrow">\n    <img src="',escape(assetUrl("media/1x1.gif")),'" class="up-btn icon21">\n  </button>\n  <button id="downButton" class="arrow">\n    <img src="',escape(assetUrl("media/1x1.gif")),'" class="down-btn icon21">\n  </button>\n</div>\n\n'),finishButton&&buf.push('\n  <div id="share-cell" class="share-cell-none">\n    <button id="finishButton" class="share">\n      <img src="',escape(assetUrl("media/1x1.gif")),'">',escape(a.finish()),"\n    </button>\n  </div>\n"),buf.push("\n")}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{"../../locale/current/common":189,ejs:205}],148:[function(a,b){"use strict";var c=a("../StudioApp").singleton,d=a("./constants").Direction,e=function(a){for(var b in a)this[b]=a[b];this.visible=this.visible||!0,this.flags=0,this.collidingWith_={},this.frames=this.frames||1};b.exports=e,e.prototype.clearCollisions=function(){this.collidingWith_={}},e.prototype.startCollision=function(a){return this.isCollidingWith(a)?!1:(this.collidingWith_[a]=!0,!0)},e.prototype.endCollision=function(a){this.collidingWith_[a]=!1},e.prototype.isCollidingWith=function(a){return this.collidingWith_[a]===!0},e.prototype.bounce=function(){switch(this.dir){case d.NORTH:this.dir=d.SOUTH;break;case d.WEST:this.dir=d.EAST;break;case d.SOUTH:this.dir=d.NORTH;break;case d.EAST:this.dir=d.WEST}},e.prototype.outOfBounds=function(){return this.x<-(this.width/2)||this.x>c.MAZE_WIDTH+this.width/2||this.y<-(this.height/2)||this.y>c.MAZE_HEIGHT+this.height/2}},{"../StudioApp":2,"./constants":149}],147:[function(a,b,c){"use strict";function d(a){var b=o.range(0,x);return o.map(b,function(b){return[a({spriteIndex:b+1}),b.toString()]})}function e(a,b,c,d,e){a.Blocks.studio_vanish={helpUrl:"",init:function(){this.setHSV(184,1,.74),e.isK1?this.appendDummyInput().appendTitle(g.vanish()).appendTitle(new a.FieldImage(e.skin.explosionThumbnail)).appendTitle(d(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.vanishActorN),"SPRITE"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.vanishTooltip())}},b.studio_vanish=function(){var a=this.getTitleValue("SPRITE");return"Studio.vanish('block_id_"+this.id+"', "+a+");\n"}}var f=a("../StudioApp").singleton,g=a("../../locale/current/studio"),h=a("../sharedFunctionalBlocks"),i=a("../../locale/current/common"),j=(a("../codegen"),a("../functionalBlockUtils")),k=j.installFunctionalApiCallBlock,l=j.initTitledFunctionalBlock,m=a("./constants"),n=a("../utils"),o=n.getLodash(),p=m.Direction,q=m.Position,r=m.Emotions,s=m.RANDOM_VALUE,t=m.HIDDEN_VALUE,u=m.CLICK_VALUE,v=m.VISIBLE_VALUE,w=function(a){var b=a.value||a.ctx.getTitleValue("VALUE");if(b===s){var c=o(a.ctx.VALUES).map(function(a){return a[1]}).without(s,t,u);b="Studio.random(["+c+"])"}return"Studio."+a.name+"('block_id_"+a.ctx.id+"', "+(a.extraParams?a.extraParams+", ":"")+b+");\n"},x=6,y=!1,z=!1,A=!1,B=[];c.setSpriteCount=function(a,b){x=b},c.enableProjectileCollisions=function(){y=!0},c.enableEdgeCollisions=function(){z=!0},c.enableSpritesOutsidePlayspace=function(){A=!0},c.setStartAvatars=function(a){B=a.slice(0)},c.install=function(a,b){function c(b){return new a.FieldDropdown(d(b))}function m(){var b=o.range(0,x),c=o.map(b,function(a){var b=B[a];return[D[b].dropdownThumbnail,a.toString()]});return new a.FieldImageDropdown(c,D.dropdownThumbnailWidth,D.dropdownThumbnailHeight)}function u(a){var b=Blockly.JavaScript.valueToCode(a,"SPRITE",Blockly.JavaScript.ORDER_NONE)||"1";return b+"-1"}function C(a){a!==s&&f.playAudio(n.stripQuotes(a),{volume:1})}var D=b.skin,E=b.isK1,F=a.Generator.get("JavaScript");a.JavaScript=F,B=D.avatarList.slice(0),F.studio_eventHandlerPrologue=function(){return"\n"},e(a,F,c,m,b),F.studio_eventHandlerPrologue=function(){return"\n"},a.Blocks.studio_whenLeft={helpUrl:"",init:function(){this.setHSV(140,1,.74),E?this.appendDummyInput().appendTitle(i.when()).appendTitle(new Blockly.FieldImage(D.whenLeft)):this.appendDummyInput().appendTitle(g.whenLeft()),this.setPreviousStatement(!1),this.setNextStatement(!0),this.setTooltip(g.whenLeftTooltip())}},F.studio_whenLeft=F.studio_eventHandlerPrologue,a.Blocks.studio_whenRight={helpUrl:"",init:function(){this.setHSV(140,1,.74),E?this.appendDummyInput().appendTitle(i.when()).appendTitle(new Blockly.FieldImage(D.whenRight)):this.appendDummyInput().appendTitle(g.whenRight()),this.setPreviousStatement(!1),this.setNextStatement(!0),this.setTooltip(g.whenRightTooltip())}},F.studio_whenRight=F.studio_eventHandlerPrologue,a.Blocks.studio_whenUp={helpUrl:"",init:function(){this.setHSV(140,1,.74),E?this.appendDummyInput().appendTitle(i.when()).appendTitle(new Blockly.FieldImage(D.whenUp)):this.appendDummyInput().appendTitle(g.whenUp()),this.setPreviousStatement(!1),this.setNextStatement(!0),this.setTooltip(g.whenUpTooltip())}},F.studio_whenUp=F.studio_eventHandlerPrologue,a.Blocks.studio_whenDown={helpUrl:"",init:function(){this.setHSV(140,1,.74),E?this.appendDummyInput().appendTitle(i.when()).appendTitle(new Blockly.FieldImage(D.whenDown)):this.appendDummyInput().appendTitle(g.whenDown()),this.setPreviousStatement(!1),this.setNextStatement(!0),this.setTooltip(g.whenDownTooltip())}},F.studio_whenDown=F.studio_eventHandlerPrologue,a.Blocks.studio_whenArrow={helpUrl:"",init:function(){this.setHSV(140,1,.74),this.appendDummyInput().appendTitle(i.when()),E?this.appendDummyInput().appendTitle(new a.FieldImageDropdown(this.K1_VALUES),"VALUE"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.VALUES),"VALUE"),this.setPreviousStatement(!1),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.whenArrowTooltip())}},a.Blocks.studio_whenArrow.K1_VALUES=[[D.whenUp,"up"],[D.whenRight,"right"],[D.whenDown,"down"],[D.whenLeft,"left"]],a.Blocks.studio_whenArrow.VALUES=[[g.whenArrowUp(),"up"],[g.whenArrowDown(),"down"],[g.whenArrowLeft(),"left"],[g.whenArrowRight(),"right"]],F.studio_whenArrow=F.studio_eventHandlerPrologue,a.Blocks.studio_repeatForever={helpUrl:"",init:function(){this.setHSV(322,.9,.95),E?(this.appendDummyInput().appendTitle(i.repeat()),this.appendStatementInput("DO").appendTitle(new a.FieldImage(D.repeatImage))):(this.appendDummyInput().appendTitle(g.repeatForever()),this.appendStatementInput("DO").appendTitle(g.repeatDo())),this.setPreviousStatement(!1),this.setNextStatement(!1),this.setTooltip(g.repeatForeverTooltip())}},F.studio_repeatForever=function(){var a=Blockly.JavaScript.statementToCode(this,"DO");return F.studio_eventHandlerPrologue()+a},a.Blocks.studio_whenSpriteClicked={helpUrl:"",init:function(){this.setHSV(140,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.whenSpriteClickedN),"SPRITE"):this.appendDummyInput().appendTitle(g.whenSpriteClicked()),this.setPreviousStatement(!1),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.whenSpriteClickedTooltip())}},F.studio_whenSpriteClicked=F.studio_eventHandlerPrologue,a.Blocks.studio_whenSpriteCollided={helpUrl:"",init:function(){var b,e;if(this.setHSV(140,1,.74),E)b=m(),e=m(),this.appendDummyInput().appendTitle(i.when()).appendTitle(new a.FieldImage(D.collide)).appendTitle(b,"SPRITE1"),this.appendDummyInput().appendTitle(i.and()).appendTitle(e,"SPRITE2");else{b=c(g.whenSpriteCollidedN);var f=[this.GROUPINGS[0]];f=f.concat(d(g.whenSpriteCollidedWithN)),f.unshift(this.GROUPINGS[1]),y&&(f=f.concat([this.GROUPINGS[2]]),f=f.concat(this.PROJECTILES)),z&&(f=f.concat([this.GROUPINGS[3]]),f=f.concat(this.EDGES)),e=new a.FieldDropdown(f),this.appendDummyInput().appendTitle(b,"SPRITE1"),this.appendDummyInput().appendTitle(e,"SPRITE2")}x>1&&e.setValue("1"),this.setPreviousStatement(!1),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.whenSpriteCollidedTooltip())}},a.Blocks.studio_whenSpriteCollided.GROUPINGS=[[g.whenSpriteCollidedWithAnything(),"anything"],[g.whenSpriteCollidedWithAnyActor(),"any_actor"],[g.whenSpriteCollidedWithAnyProjectile(),"any_projectile"],[g.whenSpriteCollidedWithAnyEdge(),"any_edge"]],a.Blocks.studio_whenSpriteCollided.PROJECTILES=[[g.whenSpriteCollidedWithBlueFireball(),"blue_fireball"],[g.whenSpriteCollidedWithPurpleFireball(),"purple_fireball"],[g.whenSpriteCollidedWithRedFireball(),"red_fireball"],[g.whenSpriteCollidedWithYellowHearts(),"yellow_hearts"],[g.whenSpriteCollidedWithPurpleHearts(),"purple_hearts"],[g.whenSpriteCollidedWithRedHearts(),"red_hearts"]],a.Blocks.studio_whenSpriteCollided.EDGES=[[g.whenSpriteCollidedWithTopEdge(),"top"],[g.whenSpriteCollidedWithLeftEdge(),"left"],[g.whenSpriteCollidedWithBottomEdge(),"bottom"],[g.whenSpriteCollidedWithRightEdge(),"right"]],F.studio_whenSpriteCollided=F.studio_eventHandlerPrologue,a.Blocks.studio_stop={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.stopSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.stopSprite()),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.stopTooltip())}},a.Blocks.studio_stopSprite={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.stopSpriteN({spriteIndex:""})),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.stopTooltip())}},F.studio_stop=function(){return"Studio.stop('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+");\n"},F.studio_stopSprite=function(){var a=u(this);return"Studio.stop('block_id_"+this.id+"', "+a+");\n"},a.Blocks.studio_throw={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.throwSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.throwSprite()),this.appendDummyInput().appendTitle(new a.FieldDropdown(D.projectileChoices),"VALUE"),this.appendDummyInput().appendTitle("	"),this.appendDummyInput().appendTitle(new a.FieldDropdown(this.DIR),"DIR"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.throwTooltip())}},a.Blocks.studio_throw.DIR=[[g.moveDirectionUp(),p.NORTH.toString()],[g.moveDirectionDown(),p.SOUTH.toString()],[g.moveDirectionLeft(),p.WEST.toString()],[g.moveDirectionRight(),p.EAST.toString()],[g.moveDirectionRandom(),"random"]],F.studio_throw=function(){var a=this.DIR.slice(0,-1).map(function(a){return a[1]}),b=this.getTitleValue("DIR");"random"===b&&(b="Studio.random(["+a+"])");var c=D.projectileChoices.slice(0,-1).map(function(a){return a[1]}),d=this.getTitleValue("VALUE");return"random"===d&&(d="Studio.random(["+c+"])"),"Studio.throwProjectile('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+b+", "+d+");\n"},a.Blocks.studio_makeProjectile={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendDummyInput().appendTitle(new a.FieldDropdown(this.VALUES),"VALUE"),this.appendDummyInput().appendTitle("	"),this.appendDummyInput().appendTitle(new a.FieldDropdown(this.ACTIONS),"ACTION"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.makeProjectileTooltip())}},a.Blocks.studio_makeProjectile.VALUES=[[g.makeProjectileBlueFireball(),'"blue_fireball"'],[g.makeProjectilePurpleFireball(),'"purple_fireball"'],[g.makeProjectileRedFireball(),'"red_fireball"'],[g.makeProjectileYellowHearts(),'"yellow_hearts"'],[g.makeProjectilePurpleHearts(),'"purple_hearts"'],[g.makeProjectileRedHearts(),'"red_hearts"']],a.Blocks.studio_makeProjectile.ACTIONS=[[g.makeProjectileBounce(),'"bounce"'],[g.makeProjectileDisappear(),'"disappear"']],F.studio_makeProjectile=function(){return"Studio.makeProjectile('block_id_"+this.id+"', "+this.getTitleValue("VALUE")+", "+this.getTitleValue("ACTION")+");\n"},a.Blocks.studio_setSpritePosition={helpUrl:"",init:function(){var b;A?(b=new a.FieldDropdown(this.VALUES_EXTENDED),b.setValue(this.VALUES_EXTENDED[4][1])):(b=new a.FieldDropdown(this.VALUES),b.setValue(this.VALUES[1][1])),this.setHSV(184,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),this.appendDummyInput().appendTitle(b,"VALUE"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.setSpritePositionTooltip())
}},a.Blocks.studio_setSpritePosition.VALUES=[[g.positionRandom(),s],[g.positionTopLeft(),q.TOPLEFT.toString()],[g.positionTopCenter(),q.TOPCENTER.toString()],[g.positionTopRight(),q.TOPRIGHT.toString()],[g.positionMiddleLeft(),q.MIDDLELEFT.toString()],[g.positionMiddleCenter(),q.MIDDLECENTER.toString()],[g.positionMiddleRight(),q.MIDDLERIGHT.toString()],[g.positionBottomLeft(),q.BOTTOMLEFT.toString()],[g.positionBottomCenter(),q.BOTTOMCENTER.toString()],[g.positionBottomRight(),q.BOTTOMRIGHT.toString()]],a.Blocks.studio_setSpritePosition.VALUES_EXTENDED=[[g.positionRandom(),s],[g.positionOutTopLeft(),q.OUTTOPLEFT.toString()],[g.positionOutTopRight(),q.OUTTOPRIGHT.toString()],[g.positionTopOutLeft(),q.TOPOUTLEFT.toString()],[g.positionTopLeft(),q.TOPLEFT.toString()],[g.positionTopCenter(),q.TOPCENTER.toString()],[g.positionTopRight(),q.TOPRIGHT.toString()],[g.positionTopOutRight(),q.TOPOUTRIGHT.toString()],[g.positionMiddleLeft(),q.MIDDLELEFT.toString()],[g.positionMiddleCenter(),q.MIDDLECENTER.toString()],[g.positionMiddleRight(),q.MIDDLERIGHT.toString()],[g.positionBottomOutLeft(),q.BOTTOMOUTLEFT.toString()],[g.positionBottomLeft(),q.BOTTOMLEFT.toString()],[g.positionBottomCenter(),q.BOTTOMCENTER.toString()],[g.positionBottomRight(),q.BOTTOMRIGHT.toString()],[g.positionBottomOutRight(),q.BOTTOMOUTRIGHT.toString()],[g.positionOutBottomLeft(),q.OUTBOTTOMLEFT.toString()],[g.positionOutBottomRight(),q.OUTBOTTOMRIGHT.toString()]],F.studio_setSpritePosition=function(){return w({ctx:this,extraParams:this.getTitleValue("SPRITE")||"0",name:"setSpritePosition"})},a.Blocks.studio_setSpriteXY={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.moveSpriteN({spriteIndex:""})):this.appendDummyInput().appendTitle(g.setSprite()),this.appendDummyInput().appendTitle(g.toXY()),this.appendValueInput("XPOS").setCheck("Number"),this.appendValueInput("YPOS").setCheck("Number"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0)}},F.studio_setSpriteXY=function(){var a=u(this),b=Blockly.JavaScript.valueToCode(this,"XPOS",Blockly.JavaScript.ORDER_NONE)||"0",c=Blockly.JavaScript.valueToCode(this,"YPOS",Blockly.JavaScript.ORDER_NONE)||"0";return"Studio.setSpriteXY('block_id_"+this.id+"', "+a+", "+b+", "+c+");\n"};var G={DIRECTION_CONFIGS:{West:{letter:i.directionWestLetter(),image:D.leftArrow,studioValue:p.WEST.toString(),tooltip:g.moveLeftTooltip()},East:{letter:i.directionEastLetter(),image:D.rightArrow,studioValue:p.EAST.toString(),tooltip:g.moveRightTooltip()},North:{letter:i.directionNorthLetter(),image:D.upArrow,studioValue:p.NORTH.toString(),tooltip:g.moveUpTooltip()},South:{letter:i.directionSouthLetter(),image:D.downArrow,studioValue:p.SOUTH.toString(),tooltip:g.moveDownTooltip()}},DISTANCES:[[D.shortLine,"25"],[D.longLine,"400"]],DEFAULT_MOVE_DISTANCE:"100",generateBlocksForAllDirections:function(){G.generateBlocksForDirection("North"),G.generateBlocksForDirection("South"),G.generateBlocksForDirection("West"),G.generateBlocksForDirection("East")},generateBlocksForDirection:function(b){F["studio_move"+b]=G.generateCodeGenerator(b,!0),a.Blocks["studio_move"+b]=G.generateMoveBlock(b,!1),F["studio_move"+b+"Distance"]=G.generateCodeGenerator(b,!1),a.Blocks["studio_move"+b+"Distance"]=G.generateMoveBlock(b,!1),F["studio_move"+b+"_length"]=G.generateCodeGenerator(b,!1),a.Blocks["studio_move"+b+"_length"]=G.generateMoveBlock(b,!0)},generateMoveBlock:function(b,c){var d=G.DIRECTION_CONFIGS[b];return{helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendDummyInput().appendTitle(g.moveSprite()).appendTitle(new a.FieldImage(d.image)).appendTitle(d.letter),x>1&&this.appendDummyInput().appendTitle(m(),"SPRITE"),c&&this.appendDummyInput().appendTitle(new a.FieldImageDropdown(G.DISTANCES),"DISTANCE"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(d.tooltip)}}},generateCodeGenerator:function(a,b){var c=G.DIRECTION_CONFIGS[a];return function(){var a=this.getTitleValue("SPRITE")||"0",d=c.studioValue,e=b?"move":"moveDistance",f=this.getTitleValue("DISTANCE")||G.DEFAULT_MOVE_DISTANCE;return"Studio."+e+"('block_id_"+this.id+"', "+a+", "+d+(b?"":", "+f)+");\n"}}};G.generateBlocksForAllDirections(),a.Blocks.studio_move={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?(E?this.appendDummyInput().appendTitle(g.moveSprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.moveSpriteN),"SPRITE"),this.appendDummyInput().appendTitle("	")):this.appendDummyInput().appendTitle(g.moveSprite()),E?this.appendDummyInput().appendTitle(new a.FieldImageDropdown(this.K1_DIR),"DIR"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.DIR),"DIR"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.moveTooltip())}},a.Blocks.studio_move.K1_DIR=[[D.upArrow,p.NORTH.toString()],[D.rightArrow,p.EAST.toString()],[D.downArrow,p.SOUTH.toString()],[D.leftArrow,p.WEST.toString()]],a.Blocks.studio_move.DIR=[[g.moveDirectionUp(),p.NORTH.toString()],[g.moveDirectionDown(),p.SOUTH.toString()],[g.moveDirectionLeft(),p.WEST.toString()],[g.moveDirectionRight(),p.EAST.toString()]],F.studio_move=function(){return"Studio.move('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+this.getTitleValue("DIR")+");\n"};var H=function(b){var d={};return d.helpUrl="",d.init=function(){this.setHSV(184,1,.74),b.sprite?this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.moveSpriteN({spriteIndex:""})):x>1?(E?this.appendDummyInput().appendTitle(g.moveSprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.moveSpriteN),"SPRITE"),this.appendDummyInput().appendTitle("	")):this.appendDummyInput().appendTitle(g.moveSprite()),E?this.appendDummyInput().appendTitle(new a.FieldImageDropdown(this.K1_DIR),"DIR"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.DIR),"DIR"),this.appendDummyInput().appendTitle("	"),b.params?(this.appendValueInput("DISTANCE").setCheck("Number"),this.appendDummyInput().appendTitle(g.moveDistancePixels())):E?this.appendDummyInput().appendTitle(new a.FieldImageDropdown(this.K1_DISTANCE),"DISTANCE"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.DISTANCE),"DISTANCE"),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.moveDistanceTooltip())},d.K1_DIR=[[D.upArrow,p.NORTH.toString()],[D.rightArrow,p.EAST.toString()],[D.downArrow,p.SOUTH.toString()],[D.leftArrow,p.WEST.toString()]],d.DIR=[[g.moveDirectionUp(),p.NORTH.toString()],[g.moveDirectionDown(),p.SOUTH.toString()],[g.moveDirectionLeft(),p.WEST.toString()],[g.moveDirectionRight(),p.EAST.toString()],[g.moveDirectionRandom(),"random"]],b.params||(d.DISTANCE=[[g.moveDistance25(),"25"],[g.moveDistance50(),"50"],[g.moveDistance100(),"100"],[g.moveDistance200(),"200"],[g.moveDistance400(),"400"],[g.moveDistanceRandom(),"random"]],d.K1_DISTANCE=[[D.shortLine,"25"],[D.longLine,"400"]]),d};a.Blocks.studio_moveDistance=H({}),a.Blocks.studio_moveDistanceParams=H({params:!0}),a.Blocks.studio_moveDistanceParamsSprite=H({params:!0,sprite:!0}),F.studio_moveDistance=function(){var a=this.DISTANCE.slice(0,-1).map(function(a){return a[1]}),b=this.getTitleValue("DISTANCE");"random"===b&&(b="Studio.random(["+a+"])");var c=this.DIR.slice(0,-1).map(function(a){return a[1]}),d=this.getTitleValue("DIR");return"random"===d&&(d="Studio.random(["+c+"])"),"Studio.moveDistance('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+d+", "+b+");\n"},F.studio_moveDistanceParams=function(){var a=this.DIR.slice(0,-1).map(function(a){return a[1]}),b=this.getTitleValue("DIR");"random"===b&&(b="Studio.random(["+a+"])");var c=Blockly.JavaScript.valueToCode(this,"DISTANCE",Blockly.JavaScript.ORDER_NONE)||"0";return"Studio.moveDistance('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+b+", "+c+");\n"},F.studio_moveDistanceParamsSprite=function(){var a=u(this),b=this.DIR.slice(0,-1).map(function(a){return a[1]}),c=this.getTitleValue("DIR");"random"===c&&(c="Studio.random(["+b+"])");var d=Blockly.JavaScript.valueToCode(this,"DISTANCE",Blockly.JavaScript.ORDER_NONE)||"0";return"Studio.moveDistance('block_id_"+this.id+"', "+a+", "+c+", "+d+");\n"},a.Blocks.studio_playSound={helpUrl:"",init:function(){this.setHSV(184,1,.74),E?this.appendDummyInput().appendTitle(i.play()).appendTitle(new a.FieldImage(D.soundIcon)).appendTitle(new a.FieldDropdown(this.K1_SOUNDS,C),"SOUND"):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.SOUNDS,C),"SOUND"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.playSoundTooltip())}},a.Blocks.studio_playSound.K1_SOUNDS=[[g.soundHit(),"hit"],[g.soundWood(),"wood"],[g.soundRetro(),"retro"],[g.soundSlap(),"slap"],[g.soundRubber(),"rubber"],[g.soundCrunch(),"crunch"],[g.soundWinPoint(),"winpoint"],[g.soundWinPoint2(),"winpoint2"],[g.soundLosePoint(),"losepoint"],[g.soundLosePoint2(),"losepoint2"],[g.soundGoal1(),"goal1"],[g.soundGoal2(),"goal2"]],a.Blocks.studio_playSound.SOUNDS=[[g.playSoundHit(),"hit"],[g.playSoundWood(),"wood"],[g.playSoundRetro(),"retro"],[g.playSoundSlap(),"slap"],[g.playSoundRubber(),"rubber"],[g.playSoundCrunch(),"crunch"],[g.playSoundWinPoint(),"winpoint"],[g.playSoundWinPoint2(),"winpoint2"],[g.playSoundLosePoint(),"losepoint"],[g.playSoundLosePoint2(),"losepoint2"],[g.playSoundGoal1(),"goal1"],[g.playSoundGoal2(),"goal2"]],F.studio_playSound=function(){return"Studio.playSound('block_id_"+this.id+"', '"+this.getTitleValue("SOUND")+"');\n"},a.Blocks.studio_changeScore={helpUrl:"",init:function(){this.setHSV(184,1,.74),E?this.appendDummyInput().appendTitle(i.score()).appendTitle(new a.FieldImage(D.scoreCard)):this.appendDummyInput().appendTitle(new a.FieldDropdown(this.VALUES),"VALUE"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(E?g.changeScoreTooltipK1():g.changeScoreTooltip())}},a.Blocks.studio_changeScore.VALUES=[[g.incrementPlayerScore(),"1"],[g.decrementPlayerScore(),"-1"]],F.studio_changeScore=function(){return"Studio.changeScore('block_id_"+this.id+"', '"+(this.getTitleValue("VALUE")||"1")+"');\n"},a.Blocks.studio_setScoreText={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("TEXT").appendTitle(g.setScoreText()),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setScoreTextTooltip())}},F.studio_setScoreText=function(){var a=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"";return"Studio.setScoreText('block_id_"+this.id+"', "+a+");\n"},a.Blocks.studio_showCoordinates={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendDummyInput().appendTitle(g.showCoordinates()),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.showCoordinatesTooltip())}},F.studio_showCoordinates=function(){return"Studio.showCoordinates('block_id_"+this.id+"');\n"},a.Blocks.studio_setSpriteSpeed={helpUrl:"",init:function(){if(this.setHSV(184,1,.74),x>1?E?this.appendDummyInput().appendTitle(g.setSprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),E){var b=new a.FieldImageDropdown(this.K1_VALUES);b.setValue(this.K1_VALUES[1][1]),this.appendDummyInput().appendTitle(g.speed()).appendTitle(b,"VALUE")}else{var d=new a.FieldDropdown(this.VALUES);d.setValue(this.VALUES[3][1]),this.appendDummyInput().appendTitle(d,"VALUE")}this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteSpeedTooltip())}},a.Blocks.studio_setSpriteSpeedParams={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.setSpriteN({spriteIndex:""})),this.appendValueInput("VALUE").setCheck("Number").appendTitle(g.speed()),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteSpeedTooltip())}},a.Blocks.studio_setSpriteSpeed.K1_VALUES=[[D.speedSlow,"Studio.SpriteSpeed.SLOW"],[D.speedMedium,"Studio.SpriteSpeed.NORMAL"],[D.speedFast,"Studio.SpriteSpeed.FAST"]],a.Blocks.studio_setSpriteSpeed.VALUES=[[g.setSpriteSpeedRandom(),s],[g.setSpriteSpeedVerySlow(),"Studio.SpriteSpeed.VERY_SLOW"],[g.setSpriteSpeedSlow(),"Studio.SpriteSpeed.SLOW"],[g.setSpriteSpeedNormal(),"Studio.SpriteSpeed.NORMAL"],[g.setSpriteSpeedFast(),"Studio.SpriteSpeed.FAST"],[g.setSpriteSpeedVeryFast(),"Studio.SpriteSpeed.VERY_FAST"]],F.studio_setSpriteSpeed=function(){return w({ctx:this,extraParams:this.getTitleValue("SPRITE")||"0",name:"setSpriteSpeed"})},F.studio_setSpriteSpeedParams=function(){var a=u(this),b=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE)||"5";return"Studio.setSpriteSpeed('block_id_"+this.id+"', "+a+","+b+");\n"},a.Blocks.studio_setSpriteSize={helpUrl:"",init:function(){this.setHSV(184,1,.74),x>1?this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite());var b=new a.FieldDropdown(this.VALUES);b.setValue(this.VALUES[3][1]),this.appendDummyInput().appendTitle(b,"VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteSizeTooltip())}},a.Blocks.studio_setSpriteSizeParams={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.setSpriteN({spriteIndex:""})),this.appendValueInput("VALUE").setCheck("Number").appendTitle(g.size()),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteSizeTooltip())}},a.Blocks.studio_setSpriteSize.VALUES=[[g.setSpriteSizeRandom(),s],[g.setSpriteSizeVerySmall(),"Studio.SpriteSize.VERY_SMALL"],[g.setSpriteSizeSmall(),"Studio.SpriteSize.SMALL"],[g.setSpriteSizeNormal(),"Studio.SpriteSize.NORMAL"],[g.setSpriteSizeLarge(),"Studio.SpriteSize.LARGE"],[g.setSpriteSizeVeryLarge(),"Studio.SpriteSize.VERY_LARGE"]],F.studio_setSpriteSize=function(){return w({ctx:this,extraParams:this.getTitleValue("SPRITE")||"0",name:"setSpriteSize"})},F.studio_setSpriteSizeParams=function(){var a=u(this),b=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE)||"5";return"Studio.setSpriteSize('block_id_"+this.id+"', "+a+","+b+");\n"},a.Blocks.studio_setBackground={helpUrl:"",init:function(){this.setHSV(312,.32,.62),this.VALUES=[];var b;E?(this.VALUES=D.backgroundChoicesK1,b=new a.FieldImageDropdown(D.backgroundChoicesK1,D.dropdownThumbnailWidth,D.dropdownThumbnailHeight),this.appendDummyInput().appendTitle(g.setBackground()).appendTitle(b,"VALUE")):(this.VALUES=D.backgroundChoices,b=new a.FieldDropdown(D.backgroundChoices),this.appendDummyInput().appendTitle(b,"VALUE")),b.setValue('"'+D.defaultBackground+'"'),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setBackgroundTooltip())}},a.Blocks.studio_setBackgroundParam={helpUrl:"",init:function(){this.setHSV(312,.32,.62),this.VALUES=D.backgroundChoices,this.appendDummyInput().appendTitle(g.setBackground()),this.appendValueInput("VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setBackgroundTooltip())}},F.studio_setBackground=function(){return w({ctx:this,name:"setBackground"})},F.studio_setBackgroundParam=function(){var b=a.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE);return w({value:b,ctx:this,name:"setBackground"})};var I=function(a){var b={};return b.helpUrl="",b.init=function(){this.setHSV(184,1,.74),this.appendDummyInput().appendTitle(g.showTitleScreen()),a.params?(this.appendValueInput("TITLE").setCheck("String").setAlign(Blockly.ALIGN_RIGHT).appendTitle(g.showTitleScreenTitle()),this.appendValueInput("TEXT").setCheck("String").setAlign(Blockly.ALIGN_RIGHT).appendTitle(g.showTitleScreenText())):(this.appendDummyInput().appendTitle(g.showTitleScreenTitle()).appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote0.png"),12,12)).appendTitle(new Blockly.FieldTextInput(g.showTSDefTitle()),"TITLE").appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote1.png"),12,12)),this.appendDummyInput().appendTitle(g.showTitleScreenText()).appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote0.png"),12,12)).appendTitle(new Blockly.FieldTextInput(g.showTSDefText()),"TEXT").appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote1.png"),12,12))),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.showTitleScreenTooltip())},b};a.Blocks.studio_showTitleScreen=I({}),a.Blocks.studio_showTitleScreenParams=I({params:!0}),F.studio_showTitleScreen=function(){return"Studio.showTitleScreen('block_id_"+this.id+"', "+a.JavaScript.quote_(this.getTitleValue("TITLE"))+", "+a.JavaScript.quote_(this.getTitleValue("TEXT"))+");\n"},F.studio_showTitleScreenParams=function(){var a=Blockly.JavaScript.valueToCode(this,"TITLE",Blockly.JavaScript.ORDER_NONE)||"",b=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"";return"Studio.showTitleScreen('block_id_"+this.id+"', "+a+", "+b+");\n"},E?(a.Blocks.studio_setSprite={helpUrl:"",init:function(){this.setHSV(312,.32,.62);var b=new a.FieldDropdown(this.VALUES);b.setValue(v),this.appendDummyInput().appendTitle(b,"VALUE"),x>1&&this.appendDummyInput().appendTitle(m(),"SPRITE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteK1Tooltip())}},a.Blocks.studio_setSprite.VALUES=[[g.setSpriteHideK1(),t],[g.setSpriteShowK1(),v]]):(a.Blocks.studio_setSprite={helpUrl:"",init:function(){this.VALUES=D.spriteChoices;var b=new a.FieldDropdown(D.spriteChoices);b.setValue(D.spriteChoices[2][1]),this.setHSV(312,.32,.62),x>1?this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),this.appendDummyInput().appendTitle(b,"VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteTooltip())}},a.Blocks.studio_setSpriteParams={helpUrl:"",init:function(){var b=new a.FieldDropdown(D.spriteChoices);b.setValue(D.spriteChoices[2][1]),this.setHSV(312,.32,.62),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.setSpriteN({spriteIndex:""})),this.appendDummyInput().appendTitle(b,"VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteTooltip())}},a.Blocks.studio_setSpriteParamValue={helpUrl:"",init:function(){this.setHSV(312,.32,.62),x>1?this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),this.appendValueInput("VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteTooltip())}}),F.studio_setSprite=function(){var a=this.getTitleValue("SPRITE")||"0";return w({ctx:this,extraParams:a,name:"setSprite"})},F.studio_setSpriteParams=function(){var a=u(this);return w({ctx:this,extraParams:a,name:"setSprite"})},F.studio_setSpriteParamValue=function(){var b=this.getTitleValue("SPRITE")||"0",c=a.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE);return w({value:c,ctx:this,extraParams:b,name:"setSprite"})},a.Blocks.studio_setSpriteEmotion={helpUrl:"",init:function(){if(this.setHSV(184,1,.74),x>1?E?this.appendDummyInput().appendTitle(g.setSprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.setSpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.setSprite()),E){var b=new a.FieldImageDropdown(this.K1_VALUES,34,34);b.setValue(this.K1_VALUES[0][1]),this.appendDummyInput().appendTitle(g.emotion()).appendTitle(b,"VALUE")}else{var d=new a.FieldDropdown(this.VALUES);d.setValue(this.VALUES[1][1]),this.appendDummyInput().appendTitle(d,"VALUE")}this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteEmotionTooltip())}},a.Blocks.studio_setSpriteEmotionParams={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.setSpriteN({spriteIndex:""}));var b=new a.FieldDropdown(this.VALUES);b.setValue(this.VALUES[1][1]),this.appendDummyInput().appendTitle(b,"VALUE"),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.setSpriteEmotionTooltip())}},a.Blocks.studio_setSpriteEmotion.VALUES=a.Blocks.studio_setSpriteEmotionParams.VALUES=[[g.setSpriteEmotionRandom(),s],[g.setSpriteEmotionNormal(),r.NORMAL.toString()],[g.setSpriteEmotionHappy(),r.HAPPY.toString()],[g.setSpriteEmotionAngry(),r.ANGRY.toString()],[g.setSpriteEmotionSad(),r.SAD.toString()]],a.Blocks.studio_setSpriteEmotion.K1_VALUES=[[D.emotionNormal,r.NORMAL.toString()],[D.emotionHappy,r.HAPPY.toString()],[D.emotionAngry,r.ANGRY.toString()],[D.emotionSad,r.SAD.toString()],[D.randomPurpleIcon,s]],F.studio_setSpriteEmotion=function(){return w({ctx:this,extraParams:this.getTitleValue("SPRITE")||"0",name:"setSpriteEmotion"})},F.studio_setSpriteEmotionParams=function(){var a=u(this);return w({ctx:this,extraParams:a,name:"setSpriteEmotion"})};var J=function(b){var d={};return d.helpUrl="",d.init=function(){if(this.setHSV(184,1,.74),b.time?(this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.actor()),this.appendDummyInput().appendTitle(g.saySprite())):x>1?E?this.appendDummyInput().appendTitle(g.saySprite()).appendTitle(m(),"SPRITE"):this.appendDummyInput().appendTitle(c(g.saySpriteN),"SPRITE"):this.appendDummyInput().appendTitle(g.saySprite()),b.restrictedDialog){var d=new a.FieldDropdown([[g.saySpriteChoices_1(),g.saySpriteChoices_1()],[g.saySpriteChoices_2(),g.saySpriteChoices_2()],[g.saySpriteChoices_3(),g.saySpriteChoices_3()]]);this.appendDummyInput().appendTitle(d,"VALUE")}else if(b.params)this.appendValueInput("TEXT");else{var e=this.appendDummyInput();E&&e.appendTitle(new Blockly.FieldImage(D.speechBubble)),e.appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote0.png"),12,12)).appendTitle(new Blockly.FieldTextInput(g.defaultSayText()),"TEXT").appendTitle(new Blockly.FieldImage(Blockly.assetUrl("media/quote1.png"),12,12))}b.time&&(this.appendValueInput("TIME").setCheck("Number").appendTitle(g["for"]()),this.appendDummyInput().appendTitle(g.waitSeconds())),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(g.saySpriteTooltip())},d};a.Blocks.studio_saySprite=J({}),a.Blocks.studio_saySpriteChoices=J({restrictedDialog:!0}),a.Blocks.studio_saySpriteParams=J({params:!0}),a.Blocks.studio_saySpriteParamsTime=J({params:!0,time:!0}),F.studio_saySprite=function(){return"Studio.saySprite('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+a.JavaScript.quote_(this.getTitleValue("TEXT"))+");\n"},F.studio_saySpriteChoices=function(){return"Studio.saySprite('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", '"+this.getTitles()[1].getValue()+"');\n"},F.studio_saySpriteParams=function(){var a=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"";return"Studio.saySprite('block_id_"+this.id+"', "+(this.getTitleValue("SPRITE")||"0")+", "+a+");\n"},F.studio_saySpriteParamsTime=function(){var a=u(this),b=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"",c=Blockly.JavaScript.valueToCode(this,"TIME",Blockly.JavaScript.ORDER_NONE)||1;return"Studio.saySprite('block_id_"+this.id+"', "+a+", "+b+","+c+");\n"};var K=function(b){var c={};return c.helpUrl="",c.init=function(){if(this.setHSV(184,1,.74),b.params)this.appendDummyInput().appendTitle(g.waitFor()),this.appendValueInput("VALUE").setCheck("Number"),this.appendDummyInput().appendTitle(g.waitSeconds());else{var c=new a.FieldDropdown(this.VALUES);c.setValue(this.VALUES[2][1]),this.appendDummyInput().appendTitle(c,"VALUE")}this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(b.params?g.waitParamsTooltip():g.waitTooltip())},b.params||(c.VALUES=[[g.waitForClick(),'"click"'],[g.waitForRandom(),"random"],[g.waitForHalfSecond(),"500"],[g.waitFor1Second(),"1000"],[g.waitFor2Seconds(),"2000"],[g.waitFor5Seconds(),"5000"],[g.waitFor10Seconds(),"10000"]]),c};a.Blocks.studio_wait=K({}),a.Blocks.studio_waitParams=K({params:!0}),F.studio_wait=function(){return w({ctx:this,name:"wait"})},F.studio_waitParams=function(){var a=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE)||"0";return"Studio.wait('block_id_"+this.id+"', ("+a+" * 1000));\n"},a.Blocks.functional_start_setValue={init:function(){var a=g.startSetValue(),b="none",c=[{name:"VALUE",type:"function"}];l(this,a,b,c)}},F.functional_start_setValue=function(){},a.Blocks.functional_start_setVars={init:function(){var a=g.startSetVars(),b="none",c=[{name:"title",type:"string"},{name:"subtitle",type:"string"},{name:"background",type:"image"},{name:"player",type:"image"},{name:"target",type:"image"},{name:"danger",type:"image"}];l(this,a,b,c)}},F.functional_start_setVars=function(){},a.Blocks.functional_start_setFuncs={init:function(){this.blockArgs=[{name:"title",type:"string"},{name:"subtitle",type:"string"},{name:"background",type:"image"},{name:"danger",type:"image"},{name:"target",type:"image"},{name:"player",type:"image"},{name:"update-target",type:"function"},{name:"update-danger",type:"function"},{name:"update-player",type:"function"},{name:"collide?",type:"function"},{name:"on-screen?",type:"function"}],this.setFunctional(!0,{headerHeight:30}),this.setHSV.apply(this,j.colors.none);var a={fixedSize:{height:35}};this.appendDummyInput().appendTitle(new Blockly.FieldLabel("game_funcs",a)).setAlign(Blockly.ALIGN_LEFT);var b=["title, subtitle, background",[this.blockArgs[0],this.blockArgs[1],this.blockArgs[2]],"danger, target, player",[this.blockArgs[3],this.blockArgs[4],this.blockArgs[5]],"update-target, update-danger, update-player",[this.blockArgs[6],this.blockArgs[7],this.blockArgs[8]],"collide?, on-screen?",[this.blockArgs[9],this.blockArgs[10]]];b.forEach(function(a){"string"==typeof a?this.appendDummyInput().appendTitle(new Blockly.FieldLabel(a)):a.forEach(function(a,b){var c=this.appendFunctionalInput(a.name);0!==b&&c.setInline(!0),c.setHSV.apply(c,j.colors[a.type]),c.setCheck(a.type),c.setAlign(Blockly.ALIGN_LEFT)},this)},this),this.setFunctionalOutput(!1)}},F.functional_start_setFuncs=function(){this.blockArgs.forEach(function(a){var b=this.getInputTargetBlock(a.name);b&&Studio.customLogic.cacheBlock(a.name,b)},this)},k(a,F,{blockName:"functional_start_dummyOnMove",blockTitle:"on-move (on-screen)",args:[{name:"VAL",type:"function"}]}),k(a,F,{blockName:"functional_start_setBackground",blockTitle:"start (background)",apiName:"Studio.setBackground",args:[{name:"BACKGROUND",type:"string","default":"space"}]}),a.Blocks.functional_start_setSpeeds={init:function(){var a="start (player-speed, enemy-speed)",b="none",c=[{name:"PLAYER_SPEED",type:"Number"},{name:"ENEMY_SPEED",type:"Number"}];l(this,a,b,c)}},F.functional_start_setSpeeds=function(){var a=7,b=Blockly.JavaScript.statementToCode(this,"PLAYER_SPEED",!1)||a,c=Blockly.JavaScript.statementToCode(this,"ENEMY_SPEED",!1)||a,d="0",e="1",f="Studio.setSpriteSpeed('block_id_"+this.id+"',"+d+","+b+");\n";return f+="Studio.setSpriteSpeed('block_id_"+this.id+"',"+e+","+c+");\n"},a.Blocks.functional_start_setBackgroundAndSpeeds={init:function(){var a="start (background, player-speed, enemy-speed)",b="none",c=[{name:"BACKGROUND",type:"string"},{name:"PLAYER_SPEED",type:"Number"},{name:"ENEMY_SPEED",type:"Number"}];l(this,a,b,c)}},F.functional_start_setBackgroundAndSpeeds=function(){var a=Blockly.JavaScript.statementToCode(this,"BACKGROUND",!1)||"cave",b=7,c=Blockly.JavaScript.statementToCode(this,"PLAYER_SPEED",!1)||b,d=Blockly.JavaScript.statementToCode(this,"ENEMY_SPEED",!1)||b,e="Studio.setBackground('block_id_"+this.id+"',"+a+");\n";return e+="Studio.setSpriteSpeed('block_id_"+this.id+"',0,"+c+");\n",e+="Studio.setSpriteSpeed('block_id_"+this.id+"',1,"+d+");\n"},h.install(a,F);var L=D.backgroundChoices.slice(1);j.installStringPicker(a,F,{blockName:"functional_background_string_picker",values:L}),a.Blocks.studio_vanishSprite={helpUrl:"",init:function(){this.setHSV(184,1,.74),this.appendValueInput("SPRITE").setCheck("Number").appendTitle(g.vanishActorN({spriteIndex:""})),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setNextStatement(!0),this.setTooltip(g.vanishTooltip())}},F.studio_vanishSprite=function(){var a=u(this);return"Studio.vanish('block_id_"+this.id+"', "+a+");\n"},a.Blocks.functional_sprite_dropdown={helpUrl:"",init:function(){this.setHSV.apply(this,j.colors.image),this.VALUES=D.spriteChoices;var b=o.map(B,function(a){return[D[a].dropdownThumbnail,a]}),c=new a.FieldImageDropdown(b,D.dropdownThumbnailWidth,D.dropdownThumbnailHeight);this.appendDummyInput().appendTitle(c,"SPRITE_INDEX"),this.setFunctionalOutput(!0)}},F.functional_sprite_dropdown=function(){return a.JavaScript.quote_(this.getTitleValue("SPRITE_INDEX"))},a.Blocks.functional_background_dropdown={helpUrl:"",init:function(){this.setHSV.apply(this,j.colors.image),this.VALUES=D.backgroundChoicesK1;var b=new a.FieldImageDropdown(D.backgroundChoicesK1,D.dropdownThumbnailWidth,D.dropdownThumbnailHeight);this.appendDummyInput().appendTitle(b,"BACKGROUND"),this.setFunctionalOutput(!0)}},F.functional_background_dropdown=function(){return this.getTitleValue("BACKGROUND")},a.Blocks.functional_sqrt={helpUrl:"",init:function(){l(this,"sqrt","Number",[{name:"ARG1",type:"Number"}])}},F.functional_sqrt=function(){var a=Blockly.JavaScript.statementToCode(this,"ARG1",!1)||0;return"Math.sqrt("+a+");"},a.Blocks.functional_keydown={helpUrl:"",init:function(){l(this,"keydown?","boolean",[{name:"ARG1",type:"Number"}])}},F.functional_keydown=function(){var a=Blockly.JavaScript.statementToCode(this,"ARG1",!1)||-1;return"Studio.isKeyDown("+a+");"}}},{"../../locale/current/common":189,"../../locale/current/studio":195,"../StudioApp":2,"../codegen":42,"../functionalBlockUtils":74,"../sharedFunctionalBlocks":142,"../utils":184,"./constants":149}],195:[function(a,b){b.exports=window.blockly.appLocale},{}],146:[function(a,b){var c=a("./constants"),d=c.Direction,e=c.Position,f=a("../codegen"),g=a("./api"),h=function(a){this.studio_=a,this.cached_={},this.playerSpriteIndex=0,this.targetSpriteIndex=1,this.dangerSpriteIndex=2};h.prototype.onTick=function(){if(1===this.studio_.tickCount)return void this.onFirstTick_();var a=document.getElementById("titleScreenTitle");if("visible"!==a.getAttribute("visibility")){this.updateSpriteX_(this.targetSpriteIndex,this.update_target.bind(this)),this.updateSpriteX_(this.dangerSpriteIndex,this.update_danger.bind(this));for(var b in this.studio_.keyState)"keydown"===this.studio_.keyState[b]&&this.handleUpdatePlayer_(b);for(var c in this.studio_.btnState)this.studio_.btnState[c]&&("leftButton"===c?this.handleUpdatePlayer_(37):"upButton"===c?this.handleUpdatePlayer_(38):"rightButton"===c?this.handleUpdatePlayer_(39):"downButton"===c&&this.handleUpdatePlayer_(40))}},h.prototype.onFirstTick_=function(){var a=function(a,b){b.setBackground(null,this.getVar_("background")),b.setSpritePosition(null,this.playerSpriteIndex,e.MIDDLECENTER),b.setSprite(null,this.playerSpriteIndex,this.getVar_("player")),b.setSpritePosition(null,this.targetSpriteIndex,e.TOPLEFT),b.setSprite(null,this.targetSpriteIndex,this.getVar_("target")),b.setSpritePosition(null,this.dangerSpriteIndex,e.BOTTOMRIGHT),b.setSprite(null,this.dangerSpriteIndex,this.getVar_("danger")),b.showTitleScreen(null,this.getVar_("title"),this.getVar_("subtitle"))}.bind(this);this.studio_.callApiCode("BigGame.onFirstTick",a)},h.prototype.updateSpriteX_=function(a,b){var c=this.studio_.sprite[a],e=c.x+c.width/2,f=b(e);c.x=f-c.width/2,this.onscreen(f)||(c.x=c.dir===d.EAST?0-c.width:this.studio_.MAZE_WIDTH,c.y=Math.floor(Math.random()*(this.studio_.MAZE_HEIGHT-c.height)))
},h.prototype.handleUpdatePlayer_=function(a){var b=this.studio_.sprite[this.playerSpriteIndex],c=this.studio_.MAZE_HEIGHT-b.y,d=this.update_player(a,c);b.y=this.studio_.MAZE_HEIGHT-d},h.prototype.cacheBlock=function(a,b){this.cached_[a]=b},h.prototype.resolveCachedBlock_=function(a){var b="",c=this.cached_[a];if(!c)return b;var d="return "+Blockly.JavaScript.blockToCode(c);return b=f.evalWith(d,{Studio:g,Globals:Studio.Globals})},h.prototype.getVar_=function(a){return this.resolveCachedBlock_(a)},h.prototype.getFunc_=function(a){return this.resolveCachedBlock_(a)},h.prototype.update_target=function(a){return this.getFunc_("update-target")(a)},h.prototype.update_danger=function(a){return this.getFunc_("update-danger")(a)},h.prototype.update_player=function(a,b){return this.getFunc_("update-player")(a,b)},h.prototype.onscreen=function(a){return this.getFunc_("on-screen?")(a)},h.prototype.collide=function(a,b,c,d){return this.getFunc_("collide?")(a,b,c,d)},b.exports=h},{"../codegen":42,"./api":145,"./constants":149}],145:[function(a,b,c){a("./constants");c.SpriteSpeed={VERY_SLOW:2,SLOW:3,NORMAL:5,FAST:8,VERY_FAST:12},c.SpriteSize={VERY_SMALL:.5,SMALL:.75,NORMAL:1,LARGE:1.5,VERY_LARGE:2};var d=3;c.random=function(a){var b=Math.floor(Math.random()*a.length);return a[b]},c.setBackground=function(a,b){Studio.queueCmd(a,"setBackground",{value:b})},c.setSprite=function(a,b,c){Studio.queueCmd(a,"setSprite",{spriteIndex:b,value:c})},c.saySprite=function(a,b,c,e){void 0===e&&(e=d),Studio.queueCmd(a,"saySprite",{spriteIndex:b,text:c,seconds:e})},c.showTitleScreen=function(a,b,c){Studio.queueCmd(a,"showTitleScreen",{title:b,text:c})},c.setSpriteEmotion=function(a,b,c){Studio.queueCmd(a,"setSpriteEmotion",{spriteIndex:b,value:c})},c.setSpriteSpeed=function(a,b,c){Studio.queueCmd(a,"setSpriteSpeed",{spriteIndex:b,value:c})},c.setSpriteSize=function(a,b,c){Studio.queueCmd(a,"setSpriteSize",{spriteIndex:b,value:c})},c.setSpritePosition=function(a,b,c){Studio.queueCmd(a,"setSpritePosition",{spriteIndex:b,value:Number(c)})},c.setSpriteXY=function(a,b,c,d){Studio.queueCmd(a,"setSpriteXY",{spriteIndex:b,x:Number(c),y:Number(d)})},c.playSound=function(a,b){Studio.queueCmd(a,"playSound",{soundName:b})},c.stop=function(a,b){Studio.queueCmd(a,"stop",{spriteIndex:b})},c.throwProjectile=function(a,b,c,d){Studio.queueCmd(a,"throwProjectile",{spriteIndex:b,dir:Number(c),className:String(d)})},c.makeProjectile=function(a,b,c){Studio.queueCmd(a,"makeProjectile",{className:b,action:c})},c.move=function(a,b,c){Studio.queueCmd(a,"move",{spriteIndex:b,dir:Number(c)})},c.moveDistance=function(a,b,c,d){Studio.queueCmd(a,"moveDistance",{spriteIndex:b,dir:c,distance:d})},c.changeScore=function(a,b){Studio.queueCmd(a,"changeScore",{value:b})},c.setScoreText=function(a,b){Studio.queueCmd(a,"setScoreText",{text:b})},c.showCoordinates=function(a){Studio.queueCmd(a,"showCoordinates",{})},c.wait=function(a,b){Studio.queueCmd(a,"wait",{value:b})},c.vanish=function(a,b){Studio.queueCmd(a,"vanish",{spriteIndex:b})},c.onEvent=function(a,b,c){Studio.queueCmd(a,"onEvent",{eventName:String(b),func:c})},c.isKeyDown=function(a){return"keydown"===Studio.keyState[a]}},{"./constants":149}],149:[function(a,b,c){"use strict";c.Direction={NONE:0,NORTH:1,EAST:2,SOUTH:4,WEST:8,NORTHEAST:3,SOUTHEAST:6,SOUTHWEST:12,NORTHWEST:9};var d=c.Direction,e={};e[d.NORTH]={x:0,y:-1},e[d.EAST]={x:1,y:0},e[d.SOUTH]={x:0,y:1},e[d.WEST]={x:-1,y:0},c.Direction.getUnitVector=function(a){return e[a]},c.Position={OUTTOPOUTLEFT:1,OUTTOPLEFT:2,OUTTOPCENTER:3,OUTTOPRIGHT:4,OUTTOPOUTRIGHT:5,TOPOUTLEFT:6,TOPLEFT:7,TOPCENTER:8,TOPRIGHT:9,TOPOUTRIGHT:10,MIDDLEOUTLEFT:11,MIDDLELEFT:12,MIDDLECENTER:13,MIDDLERIGHT:14,MIDDLEOUTRIGHT:15,BOTTOMOUTLEFT:16,BOTTOMLEFT:17,BOTTOMCENTER:18,BOTTOMRIGHT:19,BOTTOMOUTRIGHT:20,OUTBOTTOMOUTLEFT:21,OUTBOTTOMLEFT:22,OUTBOTTOMCENTER:23,OUTBOTTOMRIGHT:24,OUTBOTTOMOUTRIGHT:25},c.NextTurn={},c.NextTurn[d.NORTH]={},c.NextTurn[d.NORTH][d.NORTH]=d.NORTH,c.NextTurn[d.NORTH][d.EAST]=d.NORTHEAST,c.NextTurn[d.NORTH][d.SOUTH]=d.NORTHEAST,c.NextTurn[d.NORTH][d.WEST]=d.NORTHWEST,c.NextTurn[d.NORTH][d.NORTHEAST]=d.NORTHEAST,c.NextTurn[d.NORTH][d.SOUTHEAST]=d.NORTHEAST,c.NextTurn[d.NORTH][d.SOUTHWEST]=d.NORTHWEST,c.NextTurn[d.NORTH][d.NORTHWEST]=d.NORTHWEST,c.NextTurn[d.EAST]={},c.NextTurn[d.EAST][d.NORTH]=d.NORTHEAST,c.NextTurn[d.EAST][d.EAST]=d.EAST,c.NextTurn[d.EAST][d.SOUTH]=d.SOUTHEAST,c.NextTurn[d.EAST][d.WEST]=d.SOUTHEAST,c.NextTurn[d.EAST][d.NORTHEAST]=d.NORTHEAST,c.NextTurn[d.EAST][d.SOUTHEAST]=d.SOUTHEAST,c.NextTurn[d.EAST][d.SOUTHWEST]=d.SOUTHEAST,c.NextTurn[d.EAST][d.NORTHWEST]=d.NORTHEAST,c.NextTurn[d.SOUTH]={},c.NextTurn[d.SOUTH][d.NORTH]=d.SOUTHEAST,c.NextTurn[d.SOUTH][d.EAST]=d.SOUTHEAST,c.NextTurn[d.SOUTH][d.SOUTH]=d.SOUTH,c.NextTurn[d.SOUTH][d.WEST]=d.SOUTHWEST,c.NextTurn[d.SOUTH][d.NORTHEAST]=d.SOUTHEAST,c.NextTurn[d.SOUTH][d.SOUTHEAST]=d.SOUTHEAST,c.NextTurn[d.SOUTH][d.SOUTHWEST]=d.SOUTHWEST,c.NextTurn[d.SOUTH][d.NORTHWEST]=d.SOUTHWEST,c.NextTurn[d.WEST]={},c.NextTurn[d.WEST][d.NORTH]=d.NORTHWEST,c.NextTurn[d.WEST][d.EAST]=d.SOUTHWEST,c.NextTurn[d.WEST][d.SOUTH]=d.SOUTHWEST,c.NextTurn[d.WEST][d.WEST]=d.WEST,c.NextTurn[d.WEST][d.NORTHEAST]=d.NORTHWEST,c.NextTurn[d.WEST][d.SOUTHEAST]=d.SOUTHWEST,c.NextTurn[d.WEST][d.SOUTHWEST]=d.SOUTHWEST,c.NextTurn[d.WEST][d.NORTHWEST]=d.NORTHWEST,c.NextTurn[d.NORTHEAST]={},c.NextTurn[d.NORTHEAST][d.NORTH]=d.NORTH,c.NextTurn[d.NORTHEAST][d.EAST]=d.EAST,c.NextTurn[d.NORTHEAST][d.SOUTH]=d.EAST,c.NextTurn[d.NORTHEAST][d.WEST]=d.NORTH,c.NextTurn[d.NORTHEAST][d.NORTHEAST]=d.NORTHEAST,c.NextTurn[d.NORTHEAST][d.SOUTHEAST]=d.EAST,c.NextTurn[d.NORTHEAST][d.SOUTHWEST]=d.EAST,c.NextTurn[d.NORTHEAST][d.NORTHWEST]=d.NORTH,c.NextTurn[d.SOUTHEAST]={},c.NextTurn[d.SOUTHEAST][d.NORTH]=d.EAST,c.NextTurn[d.SOUTHEAST][d.EAST]=d.EAST,c.NextTurn[d.SOUTHEAST][d.SOUTH]=d.SOUTH,c.NextTurn[d.SOUTHEAST][d.WEST]=d.SOUTH,c.NextTurn[d.SOUTHEAST][d.NORTHEAST]=d.EAST,c.NextTurn[d.SOUTHEAST][d.SOUTHEAST]=d.SOUTHEAST,c.NextTurn[d.SOUTHEAST][d.SOUTHWEST]=d.SOUTH,c.NextTurn[d.SOUTHEAST][d.NORTHWEST]=d.SOUTH,c.NextTurn[d.SOUTHWEST]={},c.NextTurn[d.SOUTHWEST][d.NORTH]=d.WEST,c.NextTurn[d.SOUTHWEST][d.EAST]=d.SOUTH,c.NextTurn[d.SOUTHWEST][d.SOUTH]=d.SOUTH,c.NextTurn[d.SOUTHWEST][d.WEST]=d.WEST,c.NextTurn[d.SOUTHWEST][d.NORTHEAST]=d.SOUTH,c.NextTurn[d.SOUTHWEST][d.SOUTHEAST]=d.SOUTH,c.NextTurn[d.SOUTHWEST][d.SOUTHWEST]=d.SOUTHWEST,c.NextTurn[d.SOUTHWEST][d.NORTHWEST]=d.WEST,c.NextTurn[d.NORTHWEST]={},c.NextTurn[d.NORTHWEST][d.NORTH]=d.NORTH,c.NextTurn[d.NORTHWEST][d.EAST]=d.NORTH,c.NextTurn[d.NORTHWEST][d.SOUTH]=d.WEST,c.NextTurn[d.NORTHWEST][d.WEST]=d.WEST,c.NextTurn[d.NORTHWEST][d.NORTHEAST]=d.NORTH,c.NextTurn[d.NORTHWEST][d.SOUTHEAST]=d.WEST,c.NextTurn[d.NORTHWEST][d.SOUTHWEST]=d.WEST,c.NextTurn[d.NORTHWEST][d.NORTHWEST]=d.NORTHWEST,c.Emotions={NORMAL:0,HAPPY:1,ANGRY:2,SAD:3},c.FINISH_COLLIDE_DISTANCE_SCALING=.75,c.SPRITE_COLLIDE_DISTANCE_SCALING=.9,c.DEFAULT_SPRITE_SPEED=5,c.DEFAULT_SPRITE_SIZE=1,c.SquareType={OPEN:0,SPRITEFINISH:1,SPRITESTART:16},c.RANDOM_VALUE="random",c.HIDDEN_VALUE='"hidden"',c.CLICK_VALUE='"click"',c.VISIBLE_VALUE='"visible"'},{}],41:[function(){SVGElement.prototype.toDataURL=function(a,b){function c(){}function d(){var d=e(i),g=f(d);return c(a+" length: "+g.length),b.callback&&b.callback(g),g}function e(a){function b(a){var c="";c+="<"+a.nodeName;for(var d=0;d<a.attributes.length;d++)c+=" "+a.attributes[d].name+"='"+a.attributes[d].value+"'";if(a.hasChildNodes()){c+=">\n";for(var d=0;d<a.childNodes.length;d++)c+=b(a.childNodes[d]);c+="</"+a.nodeName+">\n"}else c+=" />\n";return c}return window.XMLSerializer?(c("using standard XMLSerializer.serializeToString"),(new XMLSerializer).serializeToString(a)):(c("using custom XMLSerializerForIE"),b(a))}function f(a){var b="data:image/svg+xml;base64,";return window.btoa?(c("using window.btoa for base64 encoding"),b+=btoa(a)):(c("using custom base64 encoder"),b+=Base64.encode(a)),b}function g(a){var d=document.createElement("canvas"),g=d.getContext("2d"),h=new Image,j=e(i);h.src=f(j),h.onload=function(){c("exported image size: "+[h.width,h.height]),d.width=h.width,d.height=h.height,g.drawImage(h,0,0);var e=d.toDataURL(a);c(a+" length: "+e.length),b.callback?b.callback(e):c("WARNING: no callback set, so nothing happens.")},h.onerror=function(){console.log("Can't export! Maybe your browser doesn't support SVG in img element or SVG input for Canvas drawImage?\nhttp://en.wikipedia.org/wiki/SVG#Native_support")}}function h(a){var d=document.createElement("canvas"),f=(d.getContext("2d"),e(i)),g=b.keepOutsideViewport;if(g)var h=i.getBBox();return canvg(d,f,{ignoreMouse:!0,ignoreAnimation:!0,offsetX:g?-h.x:void 0,offsetY:g?-h.y:void 0,scaleWidth:g?h.width+h.x:void 0,scaleHeight:g?h.height+h.y:void 0,renderCallback:function(){c("exported image dimensions "+[d.width,d.height]);var e=d.toDataURL(a);c(a+" length: "+e.length),b.callback&&b.callback(e)}}),d.toDataURL(a)}var i=this;switch(a||(a="image/svg+xml"),b||(b={}),b.keepNonSafe&&c("NOTE: keepNonSafe is NOT supported and will be ignored!"),b.keepOutsideViewport&&c("NOTE: keepOutsideViewport is only supported with canvg exporter."),a){case"image/svg+xml":return d();case"image/png":case"image/jpeg":switch(b.renderer||(b.renderer=window.canvg?"canvg":"native"),b.renderer){case"canvg":return c("using canvg renderer for png export"),h(a);case"native":return c("using native renderer for png export. THIS MIGHT FAIL."),g(a);default:c("unknown png renderer given, doing noting ("+b.renderer+")")}break;default:c("Sorry! Exporting as '"+a+"' is not supported!")}}},{}],40:[function(){},{}],38:[function(){},{}]},{},[153]);
>>>>>>> 210ecc
