require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({"/home/ubuntu/staging/apps/build/js/calc/main.js":[function(a,b,c){"use strict";var d=a("../appMain");window.Calc=a("./calc");var e=a("./blocks"),f=a("../skins"),g=a("./levels");window.calcMain=function(a){a.skinsModule=f,a.blocksModule=e,d(window.Calc,g,a)}},{"../appMain":"/home/ubuntu/staging/apps/build/js/appMain.js","../skins":"/home/ubuntu/staging/apps/build/js/skins.js","./blocks":"/home/ubuntu/staging/apps/build/js/calc/blocks.js","./calc":"/home/ubuntu/staging/apps/build/js/calc/calc.js","./levels":"/home/ubuntu/staging/apps/build/js/calc/levels.js"}],"/home/ubuntu/staging/apps/build/js/calc/calc.js":[function(a,b,c){"use strict";function d(a,b,c){a=e(a),b=e(b),c=H.valueOr(c,!1);var d;return a?(d=b?a.getTokenListDiff(b):a.getTokenList(c),K.stripOuterParensFromTokenList(d)):null}function e(a){if(null===a||void 0===a)return a;if(a instanceof K)return a;if(a instanceof M)return a.expression;if(B.isSchemeNumber(a)||"string"==typeof a)return new K(a);throw new Error("unexpected")}function f(a,b){try{var c=new L(Blockly.mainBlockSpace.getTopBlocks()),e=a.getInputTargetBlock("ACTUAL"),f=a.getInputTargetBlock("EXPECTED");A.feedback_.throwOnInvalidExampleBlocks(e,f);var g=L.getEquationFromBlock(e),h=c.evaluateWithExpression(g.expression),i=L.getEquationFromBlock(f),j=c.evaluateWithExpression(i.expression),k=B.equals(j.result,h.result);if(b){var l=d(i,null);j.err||(l.push(new N(" = ",!1)),l.push(new N(j.result,!k))),r("answerExpression"),t("userExpression",null,l,0,"errorToken")}return k?null:"Does not match definition"}catch(m){return"Evaluation Failed."}}function g(){r("userExpression"),h(U.targetSet)}function h(a){var b=a.computeEquation();if(b&&b.expression){var c,e=0,f=a.computesFunctionCall();if(!f&&!a.computesSingleVariable()){var g=a.sortedEquations();g.forEach(function(a){if(a.isFunction()&&g.length>1)throw new Error("Calc doesn't support goal with multiple functions or mixed functions/vars");c=d(a),t("answerExpression",a.signature,c,e++)})}c=d(b);var h=a.evaluate();if(h.err)throw h.err;f&&(c.push(new N(" = ",!1)),c.push(new N(h.result,!1))),t("answerExpression",b.signature,c,e)}}function i(a){if(a){if(0!==Blockly.mainBlockSpace.getTopBlocks().length)throw new Error("generateTargetExpression shouldn't be called with blocksif we already have blocks in the workspace");A.loadBlocks(a)}var b=new L(Blockly.mainBlockSpace.getTopBlocks());return Blockly.mainBlockSpace.getTopBlocks().forEach(function(a){a.dispose()}),b}function j(a,b){return{result:Q.FAILURE,testResults:P.APP_SPECIFIC_FAIL,message:a,failedInput:H.valueOr(b,null)}}function k(a){return a instanceof K.DivideByZeroError?j(D.divideByZeroError(),null):(H.isInfiniteRecursionError(a)||console.log("Unexpected error: "+a),{result:Q.FAILURE,testResults:P.LEVEL_INCOMPLETE_FAIL,message:null,failedInput:null})}function l(a){return a===P.QUESTION_MARKS_IN_NUMBER_FIELD||a===P.EMPTY_FUNCTIONAL_BLOCK||a===P.EXTRA_TOP_BLOCKS_FAIL||a===P.EXAMPLE_FAILED||a===P.EMPTY_FUNCTION_NAME}function m(){r("userExpression");var a=U.userSet.clone(),b=U.targetSet,c=a.computeEquation();if(null!==c&&null!==c.expression){var e=n(a,b);if(!a.computesSingleConstant()){var f=b&&b.computeEquation(),g=d(c,f);(a.hasVariablesOrFunctions()||c.expression.depth()>0)&&(g=g.concat(o(a,b))),t("userExpression",null,g,e++,"errorToken"),g=p(a,b),g&&g.length&&t("userExpression",null,g,e++,"errorToken")}}}function n(a,b){var c=!b.computesFunctionCall()&&!b.computesSingleVariable();if(b.computesSingleVariable()&&null!==U.failedInput){var e=(a.getConstants(),b.getConstants());e.forEach(function(b,c){var d=b.name,e=a.getEquation(d);e.expression.setValue(U.failedInput[c])})}var f,g=0;return a.sortedEquations().forEach(function(a){var e=c?b.getEquation(a.name):null;f=d(a,e),t("userExpression",a.signature,f,g++,"errorToken")}),g}function o(a,b){var c=a.evaluate();if(c.err)return c.err instanceof K.DivideByZeroError||H.isInfiniteRecursionError(c.err)||console.log("Unexpected error: "+c.err),[];var e=c.result,f=e;return b.computesSingleVariable()?[new N(" = ",!1),new N(e,U.failedInput)]:(null!==b.computeEquation()&&(f=b.evaluate().result),d(" = ").concat(d(e,f)))}function p(a,b){if(null===U.failedInput||!b.computesFunctionCall())return[];for(var c=a.computeEquation(),e=c.expression.clone(),f=0;f<e.numChildren();f++)e.setChildValue(f,U.failedInput[f]);var g=a.evaluateWithExpression(e);if(g.err){if(!(g.err instanceof K.DivideByZeroError))throw g.err;g.result=""}var h=g.result;return d(e).concat(new N(" = ",!1)).concat(new N(h,!0))}function q(){U.animating=!1,v()}function r(a){var b=document.getElementById(a);if(b)for(;b.lastChild;)b.removeChild(b.lastChild)}function s(a){var b=U.userSet.computeEquation();if(!b)throw new Error("require user expression");var c=b.expression;if(!c)return!0;var e=!1;if(U.userSet.hasVariablesOrFunctions()||U.targetSet.hasVariablesOrFunctions())throw new Error("Can't animate if either user/target have functions/vars");r("userExpression");for(var f=c.clone(),g=f,h=0,i=0;a>=i&&!e;i++){var j;if(h===a)j=d(f,g);else if(h+1===a){var k=f.getDeepestOperation();k&&A.highlight("block_id_"+k.blockId),j=d(f,null,!0)}else j=d(f);var l=!1;i>0&&(l=!0,j=d("= ").concat(j)),t("userExpression",null,j,h,"markedToken",l),g=f.clone(),f.isDivZero()&&(e=!0),f.collapse()?h++:i===h+1&&(e=!0)}return e}function t(a,b,c,d,e,f){var g=document.getElementById(a),h=document.createElementNS(Blockly.SVG_NS,"g");g.appendChild(h);var i,j=0;b&&(i=new N(b+" = ",!1).renderToParent(h,j,null),j+=i);for(var k=0,l=0;l<c.length;l++)i=c[l].renderToParent(h,j,e),0===l&&(k=i),j+=i;var m;if(f){var n=Blockly.getRelativeXY(g.childNodes[0]);m=parseFloat(n.x)-k}else m=(S-h.getBoundingClientRect().width)/2;var o=d*T;h.setAttribute("transform","translate("+m+", "+o+")")}function u(a){var b=document.getElementById(a).cloneNode(!0);b.removeAttribute("id");for(var c=b.getElementsByTagName("*"),d=0;d<c.length;d++){var e=c[d];e.removeAttribute("id")}return b}function v(){if(!U.waitingForReport&&!U.animating){x.extraTopBlocks=D.extraTopBlocks();var a=null;l(U.testResults)||(a=u("svgCalc"),a.setAttribute("class","svgCalcFeedback"));var b={app:"calc",skin:y.id,response:U.response,level:x,feedbackType:U.testResults,tryAgainText:x.freePlay?C.keepPlaying():void 0,continueText:x.freePlay?C.nextPuzzle():void 0,appStrings:{reinfFeedbackMsg:D.reinfFeedbackMsg()},appDiv:a};U.message&&!x.edit_blocks&&(b.message=U.message),A.displayFeedback(b)}}function w(a){var b=document.getElementById("runButton");b.disabled=!1,U.response=a,U.waitingForReport=!1,A.onReportComplete(a),v()}var x,y,z=b.exports,A=a("../StudioApp").singleton,z=b.exports,B=a("./js-numbers/js-numbers.js"),C=a("../locale"),D=a("./locale"),E=(a("../skins"),a("./levels"),a("../templates/page.html.ejs")),F=a("../dom"),G=a("../block_utils"),H=a("../utils"),I=a("lodash"),J=a("../timeoutList"),K=a("./expressionNode"),L=a("./equationSet"),M=a("./equation"),N=a("./token"),O=a("./inputIterator"),P=A.TestResults,Q=A.ResultType;A.setCheckForEmptyBlocks(!1);var R=400,S=400,T=24,U={targetSet:null,userSet:null,animating:!1,waitingForReport:!1,response:null,message:null,result:null,testResults:null,failedInput:null};z.appState_=U;var V=2e3;z.init=function(b){A.runButtonClick=this.runButtonClick.bind(this),y=b.skin,x=b.level,x.scale&&void 0!==x.scale.stepSpeed&&(V=x.scale.stepSpeed),b.grayOutUndeletableBlocks=!0,b.forceInsertTopBlock="functional_compute",b.enableShowCode=!1,b.skin.staticAvatar=null,b.skin.smallStaticAvatar=null,b.skin.failureAvatar=null,b.skin.winAvatar=null,b.html=E({assetUrl:A.assetUrl,data:{localeDirection:A.localeDirection(),visualization:a("./visualization.html.ejs")(),controls:a("./controls.html.ejs")({assetUrl:A.assetUrl}),blockUsed:void 0,idealBlockNumber:void 0,editCode:x.editCode,blockCounterClass:"block-counter-default",inputOutputTable:x.inputOutputTable,readonlyWorkspace:b.readonlyWorkspace}}),b.loadAudio=function(){A.loadAudio(y.winSound,"win"),A.loadAudio(y.startSound,"start"),A.loadAudio(y.failureSound,"failure")},b.afterInject=function(){var a=document.getElementById("svgCalc");if(a.setAttribute("width",S),a.setAttribute("height",R),x.freePlay){var c=document.getElementById("background");c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","/blockly/media/skins/calc/background_freeplay.png")}Blockly.BROKEN_CONTROL_POINTS=!1,Blockly.JavaScript.addReservedWords("Calc,code");var d=x.solutionBlocks;x.solutionBlocks&&""!==x.solutionBlocks&&(d=G.forceInsertTopBlock(x.solutionBlocks,b.forceInsertTopBlock)),U.targetSet=i(d),h(U.targetSet);var e=document.getElementById("visualizationColumn");e.style.width="400px";var j=document.getElementById("resetButton");F.addClickTouchEvent(j,z.resetButtonClick),Blockly.contractEditor&&(Blockly.contractEditor.registerTestHandler(f),Blockly.contractEditor.registerTestResetHandler(g))},A.init(b)},z.runButtonClick=function(){A.toggleRunReset("reset"),Blockly.mainBlockSpace.traceOn(!0),A.attempts++,z.execute()},z.resetButtonClick=function(){U.animating=!1,U.waitingForReport=!1,U.response=null,U.message=null,U.result=null,U.testResults=null,U.failedInput=null,J.clearTimeouts(),r("userExpression")},z.evaluateFunction_=function(a,b){var c={result:Q.UNSET,testResults:P.NO_TESTS_RUN,message:void 0,failedInput:null},d=a.computeEquation().expression.clone(),e=b.computeEquation(),f=e&&e.expression;if(!d.hasSameSignature(f)||!b.computesFunctionCall()){c.result=Q.FAILURE,c.testResults=P.LEVEL_INCOMPLETE_FAIL;var g=d.getValue();return b.getEquation(g)||(c.message=D.missingFunctionError({functionName:g})),c}var h=a.evaluateWithExpression(d),i=b.evaluateWithExpression(d);if(h.err||i.err)return k(h.err||i.err);if(!B.equals(h.result,i.result))return c.result=Q.FAILURE,c.testResults=P.LEVEL_INCOMPLETE_FAIL,c;for(var j=I.range(1,101).concat(I.range(-0,-101,-1)),l=d.numChildren(),m=new O(j,l),n=function(a,b){d.setChildValue(b,a)};m.remaining()>0&&!c.failedInput;){var o=m.next();if(o.forEach(n),h=a.evaluateWithExpression(d),i=b.evaluateWithExpression(d),h.err||i.err)return k(h.err||i.err);B.equals(h.result,i.result)||(c.failedInput=I.clone(o))}return c.failedInput?(c.result=Q.FAILURE,c.testResults=P.APP_SPECIFIC_FAIL,c.message=D.failedInput()):a.computeEquation().expression.isIdenticalTo(b.computeEquation().expression)?(c.result=Q.SUCCESS,c.testResults=P.ALL_PASS):(c.result=Q.FAILURE,c.testResults=P.APP_SPECIFIC_FAIL,c.message=D.wrongInput()),c},z.evaluateSingleVariable_=function(a,b){var c={result:Q.UNSET,testResults:P.NO_TESTS_RUN,message:void 0,failedInput:null};if(!a.computeEquation().expression.isIdenticalTo(b.computeEquation().expression))return j(D.levelIncompleteError());var d=a.getConstants();if(0===d.length)throw new Error("Unexpected: single variable with no constants");if(1!==d.length)throw new Error("No support for multiple constants");for(var e=b.getConstants(),f=e.map(function(a){return a.name}),g=0;g<d.length;g++)if(-1===f.indexOf(d[g].name))return j(D.missingVariableX({"var":d[g].name}));var h=b.evaluate();if(h.err)return k(h.err);var i=h.result,l=a.clone(),m=b.clone(),n=function(a,b){var c=d[b].name;l.getEquation(c).expression.setValue(a),m.getEquation(c).expression.setValue(a)};if(h=a.evaluate(),h.err)throw h.err;var o=h.result;if(!B.equals(i,o)){if(d.forEach(function(a,b){var c=a.name,d=m.getEquation(c).expression.evaluate().result;n(d,b)}),h=l.evaluate(),h.err)return k(h.err);if(!B.equals(i,h.result))return j(D.wrongResult())}for(var p=I.range(1,101).concat(I.range(-0,-101,-1)),q=d.length,r=new O(p,q);r.remaining()>0&&!c.failedInput;){var s=r.next();s.forEach(n);var t=l.evaluate(),u=m.evaluate(),v=t.err||u.err;if(v)return k(v);B.equals(t.result,u.result)||(c.failedInput=I.clone(s))}if(c.failedInput){var w=D.wrongOtherValuesX({"var":d[0].name});return j(w,c.failedInput)}return c.result=Q.SUCCESS,c.testResults=P.ALL_PASS,c},z.evaluateResults_=function(a,b){var c,d,e,f={result:Q.UNSET,testResults:P.NO_TESTS_RUN,message:void 0,failedInput:null};if(a.computesFunctionCall())return z.evaluateFunction_(a,b);if(a.computesSingleVariable())return z.evaluateSingleVariable_(a,b);if(b.hasVariablesOrFunctions()||a.hasVariablesOrFunctions())return a.isIdenticalTo(b)?(f.result=Q.SUCCESS,f.testResults=P.ALL_PASS):a.isEquivalentTo(b)?(f.result=Q.FAILURE,f.testResults=P.APP_SPECIFIC_FAIL,f.message=D.equivalentExpression()):(f.result=Q.FAILURE,f.testResults=P.LEVEL_INCOMPLETE_FAIL),f;if(d=b.computeEquation(),e=a.computeEquation(),c=a.isIdenticalTo(b))f.result=Q.SUCCESS,f.testResults=P.ALL_PASS;else{f.result=Q.FAILURE;var g=f.result===Q.SUCCESS;f.testResults=A.getTestResults(g),e&&d.expression&&d.expression.isEquivalentTo(e.expression)&&(f.testResults=P.APP_SPECIFIC_FAIL,f.message=D.equivalentExpression())}return f},z.execute=function(){z.generateResults_();var a=Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace),b=Blockly.Xml.domToText(a),c={app:"calc",level:x.id,builder:x.builder,result:U.result===Q.SUCCESS,testResult:U.testResults,program:encodeURIComponent(b),onComplete:w};return U.waitingForReport=!0,A.report(c),A.playAudio(U.result===Q.SUCCESS?"win":"failure"),l(U.testResults)?v():(U.animating=!0,void(U.result===Q.SUCCESS&&U.userSet.isAnimatable()&&!x.edit_blocks?z.step(0):(m(),J.setTimeout(function(){q()},V))))},z.generateResults_=function(){return U.message=void 0,A.hasExtraTopBlocks()?(U.result=Q.FAILURE,void(U.testResults=P.EXTRA_TOP_BLOCKS_FAIL)):A.hasUnfilledFunctionalBlock()?(U.result=Q.FAILURE,U.testResults=P.EMPTY_FUNCTIONAL_BLOCK,void(U.message=A.getUnfilledFunctionalBlockError("functional_compute"))):A.hasQuestionMarksInNumberField()?(U.result=Q.FAILURE,void(U.testResults=P.QUESTION_MARKS_IN_NUMBER_FIELD)):A.hasEmptyFunctionOrVariableName()?(U.result=Q.FAILURE,U.testResults=P.EMPTY_FUNCTION_NAME,void(U.message=C.unnamedFunction())):(U.userSet=new L(Blockly.mainBlockSpace.getTopBlocks()),U.failedInput=null,U.userSet.hasDivZero()?(U.result=Q.FAILURE,U.testResults=P.APP_SPECIFIC_FAIL,void(U.message=D.divideByZeroError())):(x.freePlay||x.edit_blocks?(U.result=Q.SUCCESS,U.testResults=P.FREE_PLAY):(U=$.extend(U,z.checkExamples_()),null===U.result&&(U=$.extend(U,z.evaluateResults_(U.targetSet,U.userSet)))),void(U.testResults!==P.LEVEL_INCOMPLETE_FAIL||U.message||(U.message=D.levelIncompleteError()))))},z.checkExamples_=function(){var a={};if(!x.examplesRequired)return a;var b=A.getFunctionWithoutTwoExamples();if(b)return a.result=Q.FAILURE,a.testResults=P.EXAMPLE_FAILED,a.message=C.emptyExampleBlockErrorMsg({functionName:b}),a;var c=A.getUnfilledFunctionalExample();if(c){a.result=Q.FAILURE,a.testResults=P.EXAMPLE_FAILED;var d=c.getRootBlock().getInputTargetBlock("ACTUAL").getTitleValue("NAME");return a.message=C.emptyExampleBlockErrorMsg({functionName:d}),a}var e=A.checkForFailingExamples(f);return e&&(a.result=!1,a.testResults=P.EXAMPLE_FAILED,a.message=C.exampleErrorMessage({functionName:e})),a},z.step=function(a){var b=s(a);J.setTimeout(function(){b?(s(a+1),q()):z.step(a+1)},V)},z.__testonly__={displayGoal:h,displayComplexUserExpressions:m,appState:U}},{"../StudioApp":"/home/ubuntu/staging/apps/build/js/StudioApp.js","../block_utils":"/home/ubuntu/staging/apps/build/js/block_utils.js","../dom":"/home/ubuntu/staging/apps/build/js/dom.js","../locale":"/home/ubuntu/staging/apps/build/js/locale.js","../skins":"/home/ubuntu/staging/apps/build/js/skins.js","../templates/page.html.ejs":"/home/ubuntu/staging/apps/build/js/templates/page.html.ejs","../timeoutList":"/home/ubuntu/staging/apps/build/js/timeoutList.js","../utils":"/home/ubuntu/staging/apps/build/js/utils.js","./controls.html.ejs":"/home/ubuntu/staging/apps/build/js/calc/controls.html.ejs","./equation":"/home/ubuntu/staging/apps/build/js/calc/equation.js","./equationSet":"/home/ubuntu/staging/apps/build/js/calc/equationSet.js","./expressionNode":"/home/ubuntu/staging/apps/build/js/calc/expressionNode.js","./inputIterator":"/home/ubuntu/staging/apps/build/js/calc/inputIterator.js","./js-numbers/js-numbers.js":"/home/ubuntu/staging/apps/build/js/calc/js-numbers/js-numbers.js","./levels":"/home/ubuntu/staging/apps/build/js/calc/levels.js","./locale":"/home/ubuntu/staging/apps/build/js/calc/locale.js","./token":"/home/ubuntu/staging/apps/build/js/calc/token.js","./visualization.html.ejs":"/home/ubuntu/staging/apps/build/js/calc/visualization.html.ejs",lodash:"/home/ubuntu/staging/apps/node_modules/lodash/dist/lodash.js"}],"/home/ubuntu/staging/apps/build/js/calc/visualization.html.ejs":[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("");require("./locale");buf.push('\n\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="svgCalc">\n  <image id="background" height="400" width="400" x="0" y="0" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/blockly/media/skins/calc/background.png"></image>\n  <g id="userExpression" class="expr" transform="translate(0, 100)">\n  </g>\n  <g id="answerExpression" class="expr" transform="translate(0, 350)">\n  </g>\n</svg>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{"./locale":"/home/ubuntu/staging/apps/build/js/calc/locale.js",ejs:"/home/ubuntu/staging/apps/node_modules/ejs/lib/ejs.js"}],"/home/ubuntu/staging/apps/build/js/calc/levels.js":[function(a,b,c){"use strict";var d=(a("./locale"),a("../block_utils"));b.exports={example1:{solutionBlocks:d.calcBlockXml("functional_times",[d.calcBlockXml("functional_plus",[1,2]),d.calcBlockXml("functional_plus",[3,4])]),ideal:1/0,toolbox:d.createToolbox(d.blockOfType("functional_plus")+d.blockOfType("functional_minus")+d.blockOfType("functional_times")+d.blockOfType("functional_dividedby")+d.blockOfType("functional_math_number")+'<block type="functional_math_number_dropdown">  <title name="NUM" config="0,1,2,3,4,5,6,7,8,9,10">???</title></block>'),startBlocks:"",requiredBlocks:"",freePlay:!1},custom:{answer:"",ideal:1/0,toolbox:"",startBlocks:"",requiredBlocks:"",freePlay:!1}}},{"../block_utils":"/home/ubuntu/staging/apps/build/js/block_utils.js","./locale":"/home/ubuntu/staging/apps/build/js/calc/locale.js"}],"/home/ubuntu/staging/apps/build/js/calc/inputIterator.js":[function(a,b,c){"use strict";var d=function(a,b){this.numParams_=b,this.remaining_=Math.pow(a.length,b),this.availableValues_=a,this.indices_=[-1];for(var c=1;b>c;c++)this.indices_[c]=0};b.exports=d,d.prototype.next=function(){if(0===this.remaining_)throw new Error("empty");var a,b=0;do a=!1,this.indices_[b]++,this.indices_[b]===this.availableValues_.length&&(this.indices_[b]=0,b++,a=!0);while(a&&b<this.numParams_);return this.remaining_--,this.indices_.map(function(a){return this.availableValues_[a]},this)},d.prototype.remaining=function(){return this.remaining_}},{}],"/home/ubuntu/staging/apps/build/js/calc/equationSet.js":[function(a,b,c){"use strict";var d=a("../utils").getLodash(),e=a("./expressionNode"),f=a("./equation"),g=a("./js-numbers/js-numbers"),h=a("../utils"),i=function j(a){this.compute_=null,this.equations_=[],a&&a.forEach(function(a){var b=j.getEquationFromBlock(a);b&&this.addEquation_(b)},this)};b.exports=i,i.prototype.clone=function(){var a=new i;return a.compute_=null,this.compute_&&(a.compute_=this.compute_.clone()),a.equations_=this.equations_.map(function(a){return a.clone()}),a},i.prototype.addEquation_=function(a){if(a.name){if(this.getEquation(a.name))throw new Error("equation already exists: "+a.name);this.equations_.push(a)}else{if(this.compute_)throw new Error("compute expression already exists");this.compute_=a}},i.prototype.getEquation=function(a){if(null===a)return this.computeEquation();for(var b=0;b<this.equations_.length;b++)if(this.equations_[b].name===a)return this.equations_[b];return null},i.prototype.computeEquation=function(){return this.compute_},i.prototype.hasVariablesOrFunctions=function(){return this.equations_.length>0},i.prototype.computesFunctionCall=function(){if(!this.compute_)return!1;var a=this.compute_.expression;return a.isFunctionCall()},i.prototype.computesSingleVariable=function(){if(!this.compute_)return!1;var a=this.compute_.expression;return a.isVariable()},i.prototype.computesSingleConstant=function(){if(!this.compute_||1!==this.equations_.length)return!1;var a=this.equations_[0],b=this.compute_.expression;return b.isVariable()&&a.expression.isNumber()&&b.getValue()===a.name},i.prototype.isAnimatable=function(){return this.compute_?this.hasVariablesOrFunctions()?!1:0===this.compute_.expression.depth()?!1:!0:!1},i.prototype.getConstants=function(){return this.equations_.filter(function(a){return 0===a.params.length&&a.expression.isNumber()})},i.prototype.isIdenticalTo=function(a){if(this.equations_.length!==a.equations_.length)return!1;var b=a.computeEquation().expression;if(!this.compute_.expression.isIdenticalTo(b))return!1;for(var c=0;c<this.equations_.length;c++){var d=this.equations_[c],e=a.getEquation(d.name);if(!e||!d.expression.isIdenticalTo(e.expression))return!1}return!0},i.prototype.isEquivalentTo=function(a){if(this.equations_.length!==a.equations_.length)return!1;var b=a.computeEquation().expression;if(!this.compute_.expression.isEquivalentTo(b))return!1;for(var c=0;c<this.equations_.length;c++){var d=this.equations_[c],e=a.getEquation(d.name);if(!e||!d.expression.isEquivalentTo(e.expression))return!1}return!0},i.prototype.sortedEquations=function(){return this.equations_.sort(function(a,b){return a.name.localeCompare(b.name)}),this.equations_},i.prototype.hasDivZero=function(){var a=this.evaluate();return a.err&&a.err instanceof e.DivideByZeroError},i.prototype.evaluate=function(){return this.evaluateWithExpression(this.compute_.expression)},i.prototype.evaluateWithExpression=function(a){if(0===this.equations_.length)return a.evaluate();var b,c,f,i={},j=function(a){c[a]=g.makeFloat(1)};do{b=!1;for(var k=0;k<this.equations_.length;k++){var l=this.equations_[k];if(l.isFunction()){if(i[l.name])continue;if(c=d.clone(i),c[l.name]={variables:l.params,expression:l.expression},l.params.forEach(j),f=l.expression.evaluate(c),f.err){if(f.err instanceof e.DivideByZeroError||h.isInfiniteRecursionError(f.err))return{err:f.err};continue}b=!0,i[l.name]={variables:l.params,expression:l.expression}}else if(void 0===i[l.name])if(f=l.expression.evaluate(i),f.err){if(f.err instanceof e.DivideByZeroError)return{err:f.err}}else b=!0,i[l.name]=f.result}}while(b);return a.evaluate(i)},i.getEquationFromBlock=function(a){var b;if(!a)return null;var c=a.getChildren()[0];switch(a.type){case"functional_compute":return c?i.getEquationFromBlock(c):new f(null,[],null);case"functional_plus":case"functional_minus":case"functional_times":case"functional_dividedby":case"functional_pow":case"functional_sqrt":case"functional_squared":var d=a.getTitles()[0].getValue(),g=["ARG1"];a.getInput("ARG2")&&g.push("ARG2");var h=g.map(function(b){var c=a.getInputTargetBlock(b);return c?i.getEquationFromBlock(c).expression:0},this);return new f(null,[],new e(d,h,a.id));case"functional_math_number":case"functional_math_number_dropdown":var j=a.getTitleValue("NUM")||0;return"???"===j&&(j=0),new f(null,[],new e(parseFloat(j),[],a.id));case"functional_call":b=a.getCallName();var k=Blockly.Procedures.getDefinition(b,Blockly.mainBlockSpace);if(k.isVariable())return new f(null,[],new e(b));for(var l,m,n=[],o=0;l=a.getInput("ARG"+o);o++)m=l.connection.targetBlock(),n.push(m?i.getEquationFromBlock(m).expression:new e(0));return new f(null,[],new e(b,n));case"functional_definition":b=a.getTitleValue("NAME");var p=c?i.getEquationFromBlock(c).expression:new e(0);return new f(b,a.getVars(),p);case"functional_parameters_get":return new f(null,[],new e(a.getTitleValue("VAR")));case"functional_example":return null;default:throw"Unknown block type: "+a.type}}},{"../utils":"/home/ubuntu/staging/apps/build/js/utils.js","./equation":"/home/ubuntu/staging/apps/build/js/calc/equation.js","./expressionNode":"/home/ubuntu/staging/apps/build/js/calc/expressionNode.js","./js-numbers/js-numbers":"/home/ubuntu/staging/apps/build/js/calc/js-numbers/js-numbers.js"}],"/home/ubuntu/staging/apps/build/js/calc/expressionNode.js":[function(a,b,c){"use strict";function d(a){this.message=a||""}function e(a){return"number"==typeof a?i.makeFloat(a):a}var f=a("../utils"),g=f.getLodash(),h=a("./token"),i=a("./js-numbers/js-numbers"),j={ARITHMETIC:1,FUNCTION_CALL:2,VARIABLE:3,NUMBER:4,EXPONENTIAL:5},k=function l(a,b,c){if(this.value_=e(a),this.blockId_=c,void 0===b&&(b=[]),!Array.isArray(b))throw new Error("Expected array");if(this.children_=b.map(function(a){return a instanceof l||(a=new l(a)),a}),this.isNumber()&&b.length>0)throw new Error("Can't have args for number ExpressionNode");if(this.isArithmetic()&&2!==b.length)throw new Error("Arithmetic ExpressionNode needs 2 args")};b.exports=k,k.DivideByZeroError=d,k.prototype.getType_=function(){return-1!==["+","-","*","/"].indexOf(this.value_)?j.ARITHMETIC:-1!==["pow","sqrt","sqr"].indexOf(this.value_)?j.EXPONENTIAL:"string"==typeof this.value_?0===this.children_.length?j.VARIABLE:j.FUNCTION_CALL:i.isSchemeNumber(this.value_)?j.NUMBER:void 0},k.prototype.isArithmetic=function(){return this.getType_()===j.ARITHMETIC},k.prototype.isFunctionCall=function(){return this.getType_()===j.FUNCTION_CALL},k.prototype.isVariable=function(){return this.getType_()===j.VARIABLE},k.prototype.isNumber=function(){return this.getType_()===j.NUMBER},k.prototype.isExponential=function(){return this.getType_()===j.EXPONENTIAL},k.prototype.isDivZero=function(){var a=this.getChildValue(1);return"/"===this.getValue()&&i.isSchemeNumber(a)&&i.equals(a,0)},k.prototype.clone=function(){var a=this.children_.map(function(a){return a.clone()});return new k(this.value_,a,this.blockId_)},k.prototype.evaluate=function(a,b){var c;try{a=a||{},b=b||{};var g,h=this.getType_();if(h===j.VARIABLE){var k=f.valueOr(b[this.value_],a[this.value_]);if(void 0===k)throw new Error("No mapping for variable during evaluation");var l=this.clone();return l.setValue(k),l.evaluate(a)}if(h===j.FUNCTION_CALL){var m=f.valueOr(b[this.value_],a[this.value_]);if(void 0===m)throw new Error("No mapping for function during evaluation");if(!m.variables||!m.expression)throw new Error("Bad mapping for: "+this.value_);if(m.variables.length!==this.children_.length)throw new Error("Bad mapping for: "+this.value_);var n={};return m.variables.forEach(function(c,d){var e=this.children_[d].evaluate(a,b);if(e.err)throw e.err;var g=e.result;n[c]=f.valueOr(b[g],g)},this),m.expression.evaluate(a,n)}if(h===j.NUMBER)return{result:this.value_};if(h!==j.ARITHMETIC&&h!==j.EXPONENTIAL)throw new Error("Unexpected");var o=this.children_[0].evaluate(a,b);if(o.err)throw o.err;if(o=o.result.toExact(),1===this.children_.length){switch(this.value_){case"sqrt":g=i.sqrt(o);break;case"sqr":g=i.sqr(o);break;default:throw new Error("Unknown operator: "+this.value_)}return{result:e(g)}}var p=this.children_[1].evaluate(a,b);if(p.err)throw p.err;switch(p=p.result.toExact(),this.value_){case"+":g=i.add(o,p);break;case"-":g=i.subtract(o,p);break;case"*":g=i.multiply(o,p);break;case"/":if(i.equals(p,0))throw new d;g=i.divide(o,p);break;case"pow":g=i.expt(o,p);break;default:throw new Error("Unknown operator: "+this.value_)}return{result:e(g)}}catch(q){c=q}return{err:c}},k.prototype.depth=function(){for(var a=0,b=0;b<this.children_.length;b++)a=Math.max(a,1+this.children_[b].depth());return a},k.prototype.getDeepestOperation=function(){if(0===this.children_.length)return null;for(var a=null,b=0,c=0;c<this.children_.length;c++){var d=this.children_[c].depth();d>b&&(b=d,a=this.children_[c])}return 0===b?this:a.getDeepestOperation()},k.prototype.collapse=function(){var a=this.getDeepestOperation();if(null===a)return!1;if(this===a){var b=this.evaluate();return b.err?!1:(this.value_=b.result,this.children_=[],!0)}return a.collapse()},k.prototype.getTokenListDiff=function(a){var b,c=a&&this.hasSameValue_(a)&&this.children_.length===a.children_.length,d=this.getType_();if(0===this.children_.length)return[new h(this.value_,!c)];var e=function(b){return this.children_[b].getTokenListDiff(c&&a.children_[b])}.bind(this);if(d===j.ARITHMETIC)return b=[new h("(",!c)],b.push([e(0),new h(" "+this.value_+" ",!c),e(1)]),b.push(new h(")",!c)),g.flatten(b);if("sqr"===this.value_)return g.flatten([new h("(",!c),e(0),new h(" ^ 2",!c),new h(")",!c)]);if("pow"===this.value_)return g.flatten([new h("(",!c),e(0),new h(" ^ ",!c),e(1),new h(")",!c)]);b=[new h(this.value_,a&&this.value_!==a.value_),new h("(",!c)];for(var f=this.children_.length,i=0;f>i;i++){i>0&&b.push(new h(",",!c));var l=e(i);1===f&&k.stripOuterParensFromTokenList(l),b.push(l)}return b.push(new h(")",!c)),g.flatten(b)},k.prototype.getTokenList=function(a){if(!a)return this.getTokenListDiff(this);if(this.depth()<=1)return this.getTokenListDiff(null);if(this.getType_()!==j.ARITHMETIC&&this.getType_()!==j.EXPONENTIAL)throw new Error("Unsupported");var b=!1;2===this.children_.length&&(b=this.children_[1].depth()>this.children_[0].depth());var c=new h("(",!1),d=new h(")",!1);"sqrt"===this.value_&&(c=new h("sqrt",!1),d=null);var e=[c,this.children_[0].getTokenList(a&&!b)];return this.children_.length>1&&e.push([new h(" "+this.value_+" ",!1),this.children_[1].getTokenList(a&&b)]),d&&e.push(d),g.flatten(e)},k.prototype.hasSameValue_=function(a){return a?this.isNumber()?i.equals(this.value_,a.value_):this.value_===a.value_:!1},k.prototype.isIdenticalTo=function(a){if(!a||!this.hasSameValue_(a)||this.children_.length!==a.children_.length)return!1;for(var b=0;b<this.children_.length;b++)if(!this.children_[b].isIdenticalTo(a.children_[b]))return!1;return!0},k.prototype.hasSameSignature=function(a){return a?this.getType_()!==j.FUNCTION_CALL||a.getType_()!==j.FUNCTION_CALL?!1:this.value_!==a.value_?!1:this.children_.length!==a.children_.length?!1:!0:!1},k.prototype.isEquivalentTo=function(a){if(this.getType_()!==j.ARITHMETIC)return this.isIdenticalTo(a);if(!a||this.value_!==a.value_)return!1;var b=this.children_[0],c=this.children_[1],d=a.children_[0],e=a.children_[1];return b.isEquivalentTo(d)?c.isEquivalentTo(e):b.isEquivalentTo(e)?c.isEquivalentTo(d):!1},k.prototype.numChildren=function(){return this.children_.length},k.prototype.getValue=function(){return this.value_.toString()},k.prototype.setValue=function(a){var b=this.getType_();if(b!==j.VARIABLE&&b!==j.NUMBER)throw new Error("Can't modify value");b===j.NUMBER?this.value_=e(a):this.value_=a},k.prototype.getChildValue=function(a){return void 0===this.children_[a]?void 0:this.children_[a].value_},k.prototype.setChildValue=function(a,b){return this.children_[a].setValue(b)},k.prototype.debug=function(){return 0===this.children_.length?this.isNumber()?this.value_.toFixnum().toString():this.value_.toString():"("+this.value_+" "+this.children_.map(function(a){return a.debug()}).join(" ")+")"},k.stripOuterParensFromTokenList=function(a){return a.length>=2&&a[0].isParenthesis()&&a[a.length-1].isParenthesis()&&(a.splice(-1),a.splice(0,1)),a}},{"../utils":"/home/ubuntu/staging/apps/build/js/utils.js","./js-numbers/js-numbers":"/home/ubuntu/staging/apps/build/js/calc/js-numbers/js-numbers.js","./token":"/home/ubuntu/staging/apps/build/js/calc/token.js"}],"/home/ubuntu/staging/apps/build/js/calc/token.js":[function(a,b,c){"use strict";var d=a("./js-numbers/js-numbers"),e="Â ",f=function(a,b){this.val_=a,this.marked_=b,this.nonRepeated_=null,this.repeated_=null,this.setStringRepresentation_()};b.exports=f,
f.prototype.isParenthesis=function(){return"("===this.val_||")"===this.val_},f.prototype.renderToParent=function(a,b,c){var d,f;d=document.createElementNS(Blockly.SVG_NS,"text");var g=document.createElementNS(Blockly.SVG_NS,"tspan");return g.textContent=this.nonRepeated_.replace(/ /g,e+e),d.appendChild(g),this.repeated_&&(g=document.createElementNS(Blockly.SVG_NS,"tspan"),g.setAttribute("style","text-decoration: overline"),g.textContent=this.repeated_.replace(/ /g,e+e),d.appendChild(g)),a.appendChild(d),f=void 0!==d.offsetWidth?d.offsetWidth:d.getBoundingClientRect().width,d.setAttribute("x",b),this.marked_&&c&&d.setAttribute("class",c),f},f.prototype.setStringRepresentation_=function(){if(!d.isSchemeNumber(this.val_)||"number"==typeof this.val_)return void(this.nonRepeated_=this.val_);if(this.val_.isInteger())return void(this.nonRepeated_=f.numberWithCommas_(this.val_.toFixnum()));var a=d.toExact(this.val_.numerator()),b=d.toExact(this.val_.denominator()),c=d.toRepeatingDecimal(a,b);return c[2]&&"0"!==c[2]?(this.nonRepeated_=f.numberWithCommas_(c[0])+"."+c[1],void(this.repeated_=c[2])):void(this.nonRepeated_=f.numberWithCommas_(this.val_.toFixnum()))},f.numberWithCommas_=function(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}},{"./js-numbers/js-numbers":"/home/ubuntu/staging/apps/build/js/calc/js-numbers/js-numbers.js"}],"/home/ubuntu/staging/apps/build/js/calc/js-numbers/js-numbers.js":[function(a,b,c){"use strict";var d={};b.exports=d,function(){function a(a){return new RegExp("^([+-]?["+a+"]+)/(["+a+"]+)$")}function b(a,b){var c="[+-]",d="[+-]?",e=g(a),f="["+h(a)+"]",i="["+e+"]+",j=i+"/"+i,k=d+j,l=i,m="["+e+"]*\\.["+e+"]+",n="["+e+"]+\\.["+e+"]*",o="(?:"+l+"|"+m+"|"+n+")",p="(?:inf.0|nan.0|inf.f|nan.f)",q="(?:"+o+"|"+j+")",r=q+"(?:"+f+d+i+")?",s="(?:"+r+"|"+p+")",t="(?:"+d+r+"|"+c+p+")",u=new RegExp("^("+k+")("+c+j+"?)i$"),v=new RegExp("^("+t+")?("+c+s+"?)i$"),w=new RegExp("^("+t+")@("+t+")$"),x=b.match(u),y=b.match(v),z=b.match(w);return x?x:y?y:z?z:!1}function c(a){return new RegExp("^[+-]?["+a+"]+$")}function e(a){var b="(["+a+"]*)\\.(["+a+"]+)",c="(["+a+"]+)\\.(["+a+"]*)";return new RegExp("^(?:([+-]?)("+b+"|"+c+"))$")}function f(a,b){var c="["+a+"]+",d="["+a+"]*\\.["+a+"]+",e="["+a+"]+\\.["+a+"]*";return new RegExp("^(?:([+-]?(?:"+c+"|"+d+"|"+e+"))["+b+"]([+-]?["+a+"]+))$")}function g(a){return 2===a?"01":8===a?"0-7":10===a?"0-9":16===a?"0-9a-fA-F":sb("digitsForRadix: invalid radix",this,a)}function h(a){return 2===a||8===a||10===a?"defsl":16===a?"sl":sb("expMarkForRadix: invalid radix",this,a)}function i(a){this.defaultp=function(){return 0==a},this.exactp=function(){return 1==a},this.inexactp=function(){return 2==a}}function j(a,c,d,e){var f=b(c,a);return f?cd.makeInstance(k(f[1]||"0",c,d),k("+"===f[2]?"1":"-"===f[2]?"-1":f[2],c,d)):k(a,c,d,e)}function k(b,d,i,j){var m=b.match(a(g(d)));if(m)return Uc.makeInstance(k(m[1],d,i),k(m[2],d,i));if("+nan.0"===b||"-nan.0"===b)return Vc.nan;if("+inf.0"===b)return Vc.inf;if("-inf.0"===b)return Vc.neginf;if("-0.0"===b)return _c;var n=b.match(e(g(d)));if(n){var o=void 0!==n[3]?n[3]:n[5],p=void 0!==n[4]?n[4]:n[6];return l(n[1],o,p,d,i)}var q=b.match(f(g(d),h(d)));if(q){var r=k(q[1],d,i),s=k(q[2],d,i);return Hb(r,Rb(d,s))}if(b.match(c(g(d)))){var t=parseInt(b,d);return xc(t)?rd(b):i.intAsExactp()?t:Vc.makeInstance(t)}return j?(0===b.length&&sb("no digits"),void sb("bad number: "+b,this)):!1}function l(a,b,c,d,e){var a="-"==a?-1:1,f=""===b?0:e.intAsExactp()?m(b,d):parseInt(b,d),g=""===c?0:e.intAsExactp()?m(c,d):parseInt(c,d),h=e.intAsExactp()?Rb(d,c.length):Math.pow(d,c.length),i=""===c?0:e.intAsExactp()?Jb(g,h):g/h,j=function(a){return"number"==typeof a?Vc.makeInstance(a):a.toInexact()};return e.floatAsInexactp()?j(Hb(a,Eb(f,i))):Hb(a,Eb(f,i))}function m(a,b){return k(a,b,i.on,!0)}function n(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function o(){return new n(null)}function p(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function q(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function s(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function t(a){return nd.charAt(a)}function u(a,b){var c=od[a.charCodeAt(b)];return null==c?-1:c}function v(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function w(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function x(a){var b=o();return b.fromInt(a),b}function y(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void this.fromRadix(a,b);c=2}this.t=0,this.s=0;for(var d=a.length,e=!1,f=0;--d>=0;){var g=8==c?255&a[d]:u(a,d);0>g?"-"==a.charAt(d)&&(e=!0):(e=!1,0==f?this[this.t++]=g:f+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this[this.t++]=g>>this.DB-f):this[this.t-1]|=g<<f,f+=c,f>=this.DB&&(f-=this.DB))}8==c&&0!=(128&a[0])&&(this.s=-1,f>0&&(this[this.t-1]|=(1<<this.DB-f)-1<<f)),this.clamp(),e&&n.ZERO.subTo(this,this)}function z(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function A(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f=[],g=this.t,h=this.DB-g*this.DB%b;if(g-->0)for(h<this.DB&&(c=this[g]>>h)>0&&(e=!0,f.push(t(c)));g>=0;)b>h?(c=(this[g]&(1<<h)-1)<<b-h,c|=this[--g]>>(h+=this.DB-b)):(c=this[g]>>(h-=b)&d,0>=h&&(h+=this.DB,--g)),c>0&&(e=!0),e&&f.push(t(c));return e?f.join(""):"0"}function B(){var a=o();return n.ZERO.subTo(this,a),a}function C(){return this.s<0?this.negate():this}function D(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=this.s<0?a.t-c:c-a.t,0!=b)return b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function E(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function F(){return this.t<=0?0:this.DB*(this.t-1)+E(this[this.t-1]^this.s&this.DM)}function G(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function H(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function I(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function J(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function K(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function L(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;--e>=0;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&n.ZERO.subTo(b,b)}function M(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function N(a,b,c){var d=a.abs();if(!(d.t<=0)){var e=this.abs();if(e.t<d.t)return null!=b&&b.fromInt(0),void(null!=c&&this.copyTo(c));null==c&&(c=o());var f=o(),g=this.s,h=a.s,i=this.DB-E(d[d.t-1]);i>0?(d.lShiftTo(i,f),e.lShiftTo(i,c)):(d.copyTo(f),e.copyTo(c));var j=f.t,k=f[j-1];if(0!=k){var l=k*(1<<this.F1)+(j>1?f[j-2]>>this.F2:0),m=this.FV/l,p=(1<<this.F1)/l,q=1<<this.F2,r=c.t,s=r-j,t=null==b?o():b;for(f.dlShiftTo(s,t),c.compareTo(t)>=0&&(c[c.t++]=1,c.subTo(t,c)),n.ONE.dlShiftTo(j,t),t.subTo(f,f);f.t<j;)f[f.t++]=0;for(;--s>=0;){var u=c[--r]==k?this.DM:Math.floor(c[r]*m+(c[r-1]+q)*p);if((c[r]+=f.am(0,u,c,s,0,j))<u)for(f.dlShiftTo(s,t),c.subTo(t,c);c[r]<--u;)c.subTo(t,c)}null!=b&&(c.drShiftTo(j,b),g!=h&&n.ZERO.subTo(b,b)),c.t=j,c.clamp(),i>0&&c.rShiftTo(i,c),0>g&&n.ZERO.subTo(c,c)}}}function O(a){var b=o();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(n.ZERO)>0&&a.subTo(b,b),b}function P(a){this.m=a}function Q(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function R(a){return a}function S(a){a.divRemTo(this.m,null,a)}function T(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function U(a,b){a.squareTo(b),this.reduce(b)}function V(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function W(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function X(a){var b=o();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(n.ZERO)>0&&this.m.subTo(b,b),b}function Y(a){var b=o();return a.copyTo(b),this.reduce(b),b}function Z(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function $(a,b){a.squareTo(b),this.reduce(b)}function _(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function aa(){return 0==(this.t>0?1&this[0]:this.s)}function ba(a,b){if(a>4294967295||1>a)return n.ONE;var c=o(),d=o(),e=b.convert(this),f=E(a)-1;for(e.copyTo(c);--f>=0;)if(b.sqrTo(c,d),(a&1<<f)>0)b.mulTo(d,e,c);else{var g=c;c=d,d=g}return b.revert(c)}function ca(a,b){var c;return c=256>a||b.isEven()?new P(b):new W(b),this.exp(a,c)}function da(){var a=o();return this.copyTo(a),a}function ea(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function fa(){return 0==this.t?this.s:this[0]<<24>>24}function ga(){return 0==this.t?this.s:this[0]<<16>>16}function ha(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function ia(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function ja(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=x(c),e=o(),f=o(),g="";for(this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g}function ka(a,b){this.fromInt(0),null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,g=0,h=0;h<a.length;++h){var i=u(a,h);0>i?"-"==a.charAt(h)&&0==this.signum()&&(e=!0):(g=b*g+i,++f>=c&&(this.dMultiply(d),this.dAddOffset(g,0),f=0,g=0))}f>0&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(g,0)),e&&n.ZERO.subTo(this,this)}function la(a,b,c){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(n.ONE.shiftLeft(a-1),ta,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(n.ONE.shiftLeft(a-1),this);else{var d=[],e=7&a;d.length=(a>>3)+1,b.nextBytes(d),e>0?d[0]&=(1<<e)-1:d[0]=0,this.fromString(d,256)}}function ma(){var a=this.t,b=[];b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function na(a){return 0==this.compareTo(a)}function oa(a){return this.compareTo(a)<0?this:a}function pa(a){return this.compareTo(a)>0?this:a}function qa(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function ra(a,b){return a&b}function sa(a){var b=o();return this.bitwiseTo(a,ra,b),b}function ta(a,b){return a|b}function ua(a){var b=o();return this.bitwiseTo(a,ta,b),b}function va(a,b){return a^b}function wa(a){var b=o();return this.bitwiseTo(a,va,b),b}function xa(a,b){return a&~b}function ya(a){var b=o();return this.bitwiseTo(a,xa,b),b}function za(){for(var a=o(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a}function Aa(a){var b=o();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function Ba(a){var b=o();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function Ca(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function Da(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+Ca(this[a]);return this.s<0?this.t*this.DB:-1}function Ea(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function Fa(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=Ea(this[c]^b);return a}function Ga(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function Ha(a,b){var c=n.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c}function Ia(a){return this.changeBit(a,ta)}function Ja(a){return this.changeBit(a,xa)}function Ka(a){return this.changeBit(a,va)}function La(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function Ma(a){var b=o();return this.addTo(a,b),b}function Na(a){var b=o();return this.subTo(a,b),b}function Oa(a){var b=o();return this.multiplyTo(a,b),b}function Pa(a){var b=o();return this.divRemTo(a,b,null),b}function Qa(a){var b=o();return this.divRemTo(a,null,b),b}function Ra(a){var b=o(),c=o();return this.divRemTo(a,b,c),[b,c]}function Sa(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Ta(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function Ua(){}function Va(a){return a}function Wa(a,b,c){a.multiplyTo(b,c)}function Xa(a,b){a.squareTo(b)}function Ya(a){return this.bnpExp(a,new Ua)}function Za(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function $a(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function _a(a){this.r2=o(),this.q3=o(),n.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function ab(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=o();return a.copyTo(b),this.reduce(b),b}function bb(a){return a}function cb(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function db(a,b){a.squareTo(b),this.reduce(b)}function eb(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function fb(a,b){var c,d,e=a.bitLength(),f=x(1);if(0>=e)return f;c=18>e?1:48>e?3:144>e?4:768>e?5:6,d=8>e?new P(b):b.isEven()?new _a(b):new W(b);var g=[],h=3,i=c-1,j=(1<<c)-1;if(g[1]=d.convert(this),c>1){var k=o();for(d.sqrTo(g[1],k);j>=h;)g[h]=o(),d.mulTo(k,g[h-2],g[h]),h+=2}var l,m,n=a.t-1,p=!0,q=o();for(e=E(a[n])-1;n>=0;){for(e>=i?l=a[n]>>e-i&j:(l=(a[n]&(1<<e+1)-1)<<i-e,n>0&&(l|=a[n-1]>>this.DB+e-i)),h=c;0==(1&l);)l>>=1,--h;if((e-=h)<0&&(e+=this.DB,--n),p)g[l].copyTo(f),p=!1;else{for(;h>1;)d.sqrTo(f,q),d.sqrTo(q,f),h-=2;h>0?d.sqrTo(f,q):(m=f,f=q,q=m),d.mulTo(q,g[l],f)}for(;n>=0&&0==(a[n]&1<<e);)d.sqrTo(f,q),m=f,f=q,q=m,--e<0&&(e=this.DB-1,--n)}return d.revert(f)}function gb(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function hb(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function ib(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return n.ZERO;for(var c=a.clone(),d=this.clone(),e=x(1),f=x(0),g=x(0),h=x(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(a,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(a,h),h.rShiftTo(1,h);c.compareTo(d)>=0?(c.subTo(d,c),b&&e.subTo(g,e),f.subTo(h,f)):(d.subTo(c,d),b&&g.subTo(e,g),h.subTo(f,h))}return 0!=d.compareTo(n.ONE)?n.ZERO:h.compareTo(a)>=0?h.subtract(a):h.signum()<0?(h.addTo(a,h),h.signum()<0?h.add(a):h):h}function jb(a){var b,c=this.abs();if(1==c.t&&c[0]<=pd[pd.length-1]){for(b=0;b<pd.length;++b)if(c[0]==pd[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<pd.length;){for(var d=pd[b],e=b+1;e<pd.length&&qd>d;)d*=pd[e++];for(d=c.modInt(d);e>b;)if(d%pd[b++]==0)return!1}return c.millerRabin(a)}function kb(a){var b=this.subtract(n.ONE),c=b.getLowestSetBit();if(0>=c)return!1;var d=b.shiftRight(c);a=a+1>>1,a>pd.length&&(a=pd.length);for(var e=o(),f=0;a>f;++f){e.fromInt(pd[f]);var g=e.modPow(d,this);if(0!=g.compareTo(n.ONE)&&0!=g.compareTo(b)){for(var h=1;h++<c&&0!=g.compareTo(b);)if(g=g.modPowInt(2,this),0==g.compareTo(n.ONE))return!1;if(0!=g.compareTo(b))return!1}}return!0}function lb(a){return function(){var b=this.toInexact();return b[a].apply(b,arguments)}}var mb=d,nb=function(a,b,c){return c=c||{},function(d,e){return c.isXSpecialCase&&c.isXSpecialCase(d)?c.onXSpecialCase(d,e):c.isYSpecialCase&&c.isYSpecialCase(e)?c.onYSpecialCase(d,e):"number"==typeof d&&"number"==typeof e?a(d,e):("number"==typeof d&&(d=rb(d,e)),"number"==typeof e&&(e=rb(e,d)),d.level<e.level&&(d=d.liftTo(e)),e.level<d.level&&(e=e.liftTo(d)),b(d,e))}},ob=function(a){if(isNaN(a)||!isFinite(a))return Vc.makeInstance(a);var b=Math.floor(a);return b===a?xc(b)?rd(pb(a+"")):b:Vc.makeInstance(a)},pb=function(a){var b,c,d=a.match(f(g(10),h(10)));return d?(b=d[1].match(/^([^.]*)(.*)$/),c=Number(d[2]),0===b[2].length?b[1]+qb(c):c>=b[2].length-1?b[1]+b[2].substring(1)+qb(c-(b[2].length-1)):b[1]+b[2].substring(1,1+c)):a},qb=function(a){var b=[];b.length=a;for(var c=0;a>c;c++)b[c]="0";return b.join("")},rb=function(a,b){switch(b.level){case 0:return rd(a);case 1:return new Uc(a,1);case 2:return new Vc(a);case 3:return new cd(a,0);default:sb("IMPOSSIBLE: cannot lift fixnum integer to "+b.toString(),a,b)}},sb=function(a,b,c){mb.onThrowRuntimeError(a,b,c)},tb=function(a,b,c){throw new Error(a)},ub=function(a){return"number"==typeof a||a instanceof Uc||a instanceof Vc||a instanceof cd||a instanceof n},vb=function(a){return"number"==typeof a||ub(a)&&a.isRational()},wb=function(a){return"number"==typeof a||ub(a)&&a.isReal()},xb=function(a){return"number"==typeof a||ub(a)&&a.isExact()},yb=function(a){return"number"==typeof a?!1:ub(a)&&a.isInexact()},zb=function(a){return"number"==typeof a||ub(a)&&a.isInteger()},Ab=function(a){return"number"==typeof a||ub(a)&&a.isInteger()&&a.isExact()},Bb=function(a){return"number"==typeof a?a:a.toFixnum()},Cb=function(a){return"number"==typeof a?a:a.toExact()},Db=function(a){return"number"==typeof a?Vc.makeInstance(a):a.toInexact()},Eb=function(a,b){var c;return"number"==typeof a&&"number"==typeof b&&(c=a+b,xc(c))?rd(a).add(rd(b)):a instanceof Vc&&b instanceof Vc?a.add(b):Fb(a,b)},Fb=nb(function(a,b){var c=a+b;return xc(c)?rd(a).add(rd(b)):c},function(a,b){return a.add(b)},{isXSpecialCase:function(a){return Ab(a)&&Gc(a)},onXSpecialCase:function(a,b){return b},isYSpecialCase:function(a){return Ab(a)&&Gc(a)},onYSpecialCase:function(a,b){return a}}),Gb=nb(function(a,b){var c=a-b;return xc(c)?rd(a).subtract(rd(b)):c},function(a,b){return a.subtract(b)},{isXSpecialCase:function(a){return Ab(a)&&Gc(a)},onXSpecialCase:function(a,b){return yc(b)},isYSpecialCase:function(a){return Ab(a)&&Gc(a)},onYSpecialCase:function(a,b){return a}}),Hb=function(a,b){var c;return"number"==typeof a&&"number"==typeof b?(c=a*b,xc(c)?rd(a).multiply(rd(b)):c):a instanceof Vc&&b instanceof Vc?a.multiply(b):Ib(a,b)},Ib=nb(function(a,b){var c=a*b;return xc(c)?rd(a).multiply(rd(b)):c},function(a,b){return a.multiply(b)},{isXSpecialCase:function(a){return Ab(a)&&(Gc(a)||Hc(a)||Ic(a))},onXSpecialCase:function(a,b){return Gc(a)?0:Hc(a)?b:Ic(a)?yc(b):void 0},isYSpecialCase:function(a){return Ab(a)&&(Gc(a)||Hc(a)||Ic(a))},onYSpecialCase:function(a,b){return Gc(b)?0:Hc(b)?a:Ic(b)?yc(a):void 0}}),Jb=nb(function(a,b){Gc(b)&&sb("/: division by zero",a,b);var c=a/b;return xc(c)?rd(a).divide(rd(b)):Math.floor(c)!==c?Uc.makeInstance(a,b):c},function(a,b){return a.divide(b)},{isXSpecialCase:function(a){return Lb(a,0)},onXSpecialCase:function(a,b){return Lb(b,0)&&sb("/: division by zero",a,b),0},isYSpecialCase:function(a){return Lb(a,0)},onYSpecialCase:function(a,b){sb("/: division by zero",a,b)}}),Kb=nb(function(a,b){return a===b},function(a,b){return a.equals(b)}),Lb=function td(a,b){for(var c,d=!0;d;){var e=a,f=b;if(d=!1,e===f)return!0;if("number"==typeof e&&"number"==typeof f)return e===f;if(e===_c||f===_c)return e===f;if(!(e instanceof cd||f instanceof cd)){var g=xb(e),h=xb(f);return(g&&h||!g&&!h)&&Kb(e,f)}if(!(c=td(jc(e),jc(f))))return c;a=ic(e),b=ic(f),d=!0}},Mb=function(a,b,c){return Qb(Xb(Gb(a,b)),c)},Nb=nb(function(a,b){return a>=b},function(a,b){return wb(a)&&wb(b)||sb(">=: couldn't be applied to complex number",a,b),a.greaterThanOrEqual(b)}),Ob=nb(function(a,b){return b>=a},function(a,b){return wb(a)&&wb(b)||sb("<=: couldn't be applied to complex number",a,b),a.lessThanOrEqual(b)}),Pb=nb(function(a,b){return a>b},function(a,b){return wb(a)&&wb(b)||sb(">: couldn't be applied to complex number",a,b),a.greaterThan(b)}),Qb=nb(function(a,b){return b>a},function(a,b){return wb(a)&&wb(b)||sb("<: couldn't be applied to complex number",a,b),a.lessThan(b)}),Rb=function(){var a=nb(function(a,b){var c=Math.pow(a,b);return xc(c)?rd(a).expt(rd(b)):c},function(a,b){return Kb(b,0)?Eb(b,1):a.expt(b)});return function(b,c){return Kb(c,0)?Eb(c,1):wb(c)&&Qb(c,0)?a(Jb(1,b),yc(c)):a(b,c)}}(),Sb=function(a){return Lb(a,0)?1:"number"==typeof a?Vc.makeInstance(Math.exp(a)):a.exp()},Tb=function(a,b){zb(a)||sb("modulo: the first argument "+a+" is not an integer.",a,b),zb(b)||sb("modulo: the second argument "+b+" is not an integer.",a,b);var c;return"number"==typeof a?(c=a%b,0>b?0>=c?c:c+b:0>c?c+b:c):(c=Ec(Yb(a),Yb(b)),Qb(b,0)?Ob(c,0)?c:Eb(c,b):Qb(c,0)?Eb(c,b):c)},Ub=function(a){return"number"==typeof a?a:a.numerator()},Vb=function(a){return"number"==typeof a?1:a.denominator()},Wb=function ud(a){if("number"==typeof a){if(a>=0){var b=Math.sqrt(a);return Math.floor(b)===b?b:Vc.makeInstance(b)}return cd.makeInstance(0,ud(-a))}return a.sqrt()},Xb=function(a){return"number"==typeof a?Math.abs(a):a.abs()},Yb=function(a){return"number"==typeof a?a:a.floor()},Zb=function(a){return"number"==typeof a?a:a.ceiling()},$b=function(a){return"number"==typeof a?a:a.conjugate()},_b=function(a){return"number"==typeof a?Math.abs(a):a.magnitude()},ac=function(a){return Lb(a,1)?0:"number"==typeof a?Vc.makeInstance(Math.log(a)):a.log()},bc=function(a){return"number"==typeof a?a>0?0:Vc.pi:a.angle()},cc=function(a){return Lb(a,0)?0:"number"==typeof a?Vc.makeInstance(Math.tan(a)):a.tan()},dc=function(a){return Lb(a,0)?0:"number"==typeof a?Vc.makeInstance(Math.atan(a)):a.atan()},ec=function(a){return Lb(a,0)?1:"number"==typeof a?Vc.makeInstance(Math.cos(a)):a.cos()},fc=function(a){return Lb(a,0)?0:"number"==typeof a?Vc.makeInstance(Math.sin(a)):a.sin()},gc=function(a){return Lb(a,1)?0:"number"==typeof a?Vc.makeInstance(Math.acos(a)):a.acos()},hc=function(a){return Lb(a,0)?0:"number"==typeof a?Vc.makeInstance(Math.asin(a)):a.asin()},ic=function(a){return"number"==typeof a?0:a.imaginaryPart()},jc=function(a){return"number"==typeof a?a:a.realPart()},kc=function(a){return"number"==typeof a?a:a.round()},lc=function(a){return Hb(a,a)},mc=function(a){return zb(a)||sb("integer-sqrt: the argument "+a.toString()+" is not an integer.",a),"number"==typeof a?0>a?cd.makeInstance(0,Math.floor(Math.sqrt(-a))):Math.floor(Math.sqrt(a)):a.integerSqrt()},nc=function(a,b){zb(a)||sb("gcd: the argument "+a.toString()+" is not an integer.",a);for(var c,d,e=Xb(a),f=0;f<b.length;f++)for(d=Xb(b[f]),zb(d)||sb("gcd: the argument "+d.toString()+" is not an integer.",d);!Gc(d);)c=e,e=d,d=Ec(c,d);return e},oc=function(a,b){zb(a)||sb("lcm: the argument "+a.toString()+" is not an integer.",a);var c=Xb(a);if(Gc(c))return 0;for(var d=0;d<b.length;d++){zb(b[d])||sb("lcm: the argument "+b[d].toString()+" is not an integer.",b[d]);var e=Fc(c,b[d]);if(Gc(e))return 0;c=Jb(Hb(c,b[d]),e)}return c},pc=function(a,b){return zb(a)||sb("quotient: the first argument "+a.toString()+" is not an integer.",a),zb(b)||sb("quotient: the second argument "+b.toString()+" is not an integer.",b),Mc(a,b)},qc=function(a,b){return zb(a)||sb("remainder: the first argument "+a.toString()+" is not an integer.",a),zb(b)||sb("remainder: the second argument "+b.toString()+" is not an integer.",b),Nc(a,b)},rc=function(a){return Lb(a,0)?Vc.makeInstance(1):Jb(Eb(Sb(a),Sb(yc(a))),2)},sc=function(a){return Jb(Gb(Sb(a),Sb(yc(a))),2)},tc=function(a,b){return Lb(b,0)?a:cd.makeInstance(Hb(a,ec(b)),Hb(a,fc(b)))},uc=function(a){return"number"==typeof a?isFinite(a):a.isFinite()},vc=-9e15,wc=9e15,xc=function(a){return vc>a||a>wc},yc=function(a){return"number"==typeof a?-a:a.negate()},zc=function(a){return Jb(a,2)},Ac=function(a){return Hb(a,dd)},Bc=function(a,b){for(var c=1;;){if(Gc(b))return c;Kb(Tb(b,2),0)?(a=Hb(a,a),b=Jb(b,2)):(c=Hb(c,a),b=Gb(b,1))}},Cc=function(a,b,c){return c=c||{},function(d,e){if(d instanceof Uc?d=Ub(d):d instanceof cd&&(d=jc(d)),e instanceof Uc?e=Ub(e):e instanceof cd&&(e=jc(e)),"number"==typeof d&&"number"==typeof e){var f=a(d,e);if(!xc(f)||c.ignoreOverflow)return f}return d instanceof Vc||e instanceof Vc?c.doNotCoerseToFloating?a(Bb(d),Bb(e)):Vc.makeInstance(a(Bb(d),Bb(e))):("number"==typeof d&&(d=rd(d)),"number"==typeof e&&(e=rd(e)),b(d,e))}},Dc=function(a,b,c){return c=c||{},function(d){if(d instanceof Uc?d=Ub(d):d instanceof cd&&(d=jc(d)),"number"==typeof d){var e=a(d);if(!xc(e)||c.ignoreOverflow)return e}return d instanceof Vc?a(Bb(d)):("number"==typeof d&&(d=rd(d)),b(d))}},Ec=Cc(function(a,b){return a%b},function(a,b){return O.call(a,b)}),Fc=Cc(function(a,b){for(var c;0!==b;)c=a,a=b,b=c%b;return a},function(a,b){return gb.call(a,b)}),Gc=Dc(function(a){return 0===a},function(a){return na.call(a,n.ZERO)}),Hc=Dc(function(a){return 1===a},function(a){return na.call(a,n.ONE)}),Ic=Dc(function(a){return-1===a},function(a){return na.call(a,n.NEGATIVE_ONE)}),Jc=Cc(function(a,b){return a+b},function(a,b){return Ma.call(a,b)}),Kc=Cc(function(a,b){return a-b},function(a,b){return Na.call(a,b)}),Lc=Cc(function(a,b){return a*b},function(a,b){return Oa.call(a,b)}),Mc=Cc(function(a,b){return(a-a%b)/b},function(a,b){return Pa.call(a,b)}),Nc=Cc(function(a,b){return a%b},function(a,b){return Qa.call(a,b)}),Oc=Cc(function(a,b){return a/b},function(a,b){return Bb(a)/Bb(b)},{ignoreOverflow:!0,doNotCoerseToFloating:!0}),Pc=Cc(function(a,b){return a===b},function(a,b){return na.call(a,b)},{doNotCoerseToFloating:!0}),Qc=Cc(function(a,b){return a>b},function(a,b){return D.call(a,b)>0},{doNotCoerseToFloating:!0}),Rc=Cc(function(a,b){return b>a},function(a,b){return D.call(a,b)<0},{doNotCoerseToFloating:!0}),Sc=Cc(function(a,b){return a>=b},function(a,b){return D.call(a,b)>=0},{doNotCoerseToFloating:!0}),Tc=Cc(function(a,b){return b>=a},function(a,b){return D.call(a,b)<=0},{doNotCoerseToFloating:!0}),Uc=function(a,b){this.n=a,this.d=b};Uc.prototype.toString=function(){return Hc(this.d)?this.n.toString()+"":this.n.toString()+"/"+this.d.toString()},Uc.prototype.level=1,Uc.prototype.liftTo=function(a){return 2===a.level?new Vc(Oc(this.n,this.d)):3===a.level?new cd(this,0):sb("invalid level of Number",this,a)},Uc.prototype.isFinite=function(){return!0},Uc.prototype.equals=function(a){return a instanceof Uc&&Pc(this.n,a.n)&&Pc(this.d,a.d)},Uc.prototype.isInteger=function(){return Hc(this.d)},Uc.prototype.isRational=function(){return!0},Uc.prototype.isReal=function(){return!0},Uc.prototype.add=function(a){return Uc.makeInstance(Jc(Lc(this.n,a.d),Lc(this.d,a.n)),Lc(this.d,a.d))},Uc.prototype.subtract=function(a){return Uc.makeInstance(Kc(Lc(this.n,a.d),Lc(this.d,a.n)),Lc(this.d,a.d))},Uc.prototype.negate=function(){return Uc.makeInstance(-this.n,this.d)},Uc.prototype.multiply=function(a){return Uc.makeInstance(Lc(this.n,a.n),Lc(this.d,a.d))},Uc.prototype.divide=function(a){return(Gc(this.d)||Gc(a.n))&&sb("/: division by zero",this,a),Uc.makeInstance(Lc(this.n,a.d),Lc(this.d,a.n))},Uc.prototype.toExact=function(){return this},Uc.prototype.toInexact=function(){return Vc.makeInstance(this.toFixnum())},Uc.prototype.isExact=function(){return!0},Uc.prototype.isInexact=function(){return!1},Uc.prototype.toFixnum=function(){return Oc(this.n,this.d)},Uc.prototype.numerator=function(){return this.n},Uc.prototype.denominator=function(){return this.d},Uc.prototype.greaterThan=function(a){return Qc(Lc(this.n,a.d),Lc(this.d,a.n))},Uc.prototype.greaterThanOrEqual=function(a){return Sc(Lc(this.n,a.d),Lc(this.d,a.n))},Uc.prototype.lessThan=function(a){return Rc(Lc(this.n,a.d),Lc(this.d,a.n))},Uc.prototype.lessThanOrEqual=function(a){return Tc(Lc(this.n,a.d),Lc(this.d,a.n))},Uc.prototype.integerSqrt=function(){var a=Wb(this);return vb(a)?Cb(Yb(a)):wb(a)?Cb(Yb(a)):cd.makeInstance(Cb(Yb(jc(a))),Cb(Yb(ic(a))))},Uc.prototype.sqrt=function(){if(Sc(this.n,0)){var a=Wb(this.n),b=Wb(this.d);return Kb(Yb(a),a)&&Kb(Yb(b),b)?Uc.makeInstance(a,b):Vc.makeInstance(Oc(a,b))}var a=Wb(yc(this.n)),b=Wb(this.d);return Kb(Yb(a),a)&&Kb(Yb(b),b)?cd.makeInstance(0,Uc.makeInstance(a,b)):cd.makeInstance(0,Vc.makeInstance(Oc(a,b)))},Uc.prototype.abs=function(){return Uc.makeInstance(Xb(this.n),this.d)},Uc.prototype.floor=function(){var a=Mc(this.n,this.d);return Rc(this.n,0)?Gb(a,1):a},Uc.prototype.ceiling=function(){var a=Mc(this.n,this.d);return Rc(this.n,0)?a:Eb(a,1)},Uc.prototype.conjugate=function(){return this},Uc.prototype.magnitude=Uc.prototype.abs,Uc.prototype.log=function(){return Vc.makeInstance(Math.log(this.n/this.d))},Uc.prototype.angle=function(){return Gc(this.n)?0:Qc(this.n,0)?0:Vc.pi},Uc.prototype.tan=function(){return Vc.makeInstance(Math.tan(Oc(this.n,this.d)))},Uc.prototype.atan=function(){return Vc.makeInstance(Math.atan(Oc(this.n,this.d)))},Uc.prototype.cos=function(){return Vc.makeInstance(Math.cos(Oc(this.n,this.d)))},Uc.prototype.sin=function(){return Vc.makeInstance(Math.sin(Oc(this.n,this.d)))},Uc.prototype.expt=function(a){return Ab(a)&&Nb(a,0)?Bc(this,a):Vc.makeInstance(Math.pow(Oc(this.n,this.d),Oc(a.n,a.d)));
},Uc.prototype.exp=function(){return Vc.makeInstance(Math.exp(Oc(this.n,this.d)))},Uc.prototype.acos=function(){return Vc.makeInstance(Math.acos(Oc(this.n,this.d)))},Uc.prototype.asin=function(){return Vc.makeInstance(Math.asin(Oc(this.n,this.d)))},Uc.prototype.imaginaryPart=function(){return 0},Uc.prototype.realPart=function(){return this},Uc.prototype.round=function(){if(Kb(this.d,2)){var a=Oc(this.n,this.d),b=Math.floor(a),c=Math.ceil(a);return Gc(b%2)?b:c}return Math.round(this.n/this.d)},Uc.makeInstance=function(a,b){void 0===a&&sb("n undefined",a,b),void 0===b&&(b=1),Gc(b)&&sb("division by zero: "+a+"/"+b),Rc(b,0)&&(a=yc(a),b=yc(b));var c=Fc(Xb(a),Xb(b));return a=Mc(a,c),b=Mc(b,c),Hc(b)||Gc(a)?a:new Uc(a,b)};var Vc=function(a){this.n=a};Vc=Vc;var Wc=new Vc(Number.NaN),Xc=new Vc(Number.POSITIVE_INFINITY),Yc=new Vc(Number.NEGATIVE_INFINITY),Zc=new Vc(Number.POSITIVE_INFINITY),$c=new Vc(Number.NEGATIVE_INFINITY),_c=new Vc(-0),ad=new Vc(0);Vc.pi=new Vc(Math.PI),Vc.e=new Vc(Math.E),Vc.nan=Wc,Vc.inf=Xc,Vc.neginf=Yc,Vc.makeInstance=function(a){return isNaN(a)?Vc.nan:a===Number.POSITIVE_INFINITY?Vc.inf:a===Number.NEGATIVE_INFINITY?Vc.neginf:0===a?1/a===-(1/0)?_c:ad:new Vc(a)},Vc.prototype.isExact=function(){return!1},Vc.prototype.isInexact=function(){return!0},Vc.prototype.isFinite=function(){return isFinite(this.n)||this===Zc||this===$c},Vc.prototype.toExact=function(){(!isFinite(this.n)||isNaN(this.n))&&sb("toExact: no exact representation for "+this,this);var a=this.n.toString(),b=a.match(/^(.*)\.(.*)$/);if(b){var c=(parseInt(b[1]),parseInt(b[2]),Math.pow(10,b[2].length));return Uc.makeInstance(Math.round(this.n*c),c)}return this.n},Vc.prototype.toInexact=function(){return this},Vc.prototype.isInexact=function(){return!0},Vc.prototype.level=2,Vc.prototype.liftTo=function(a){return 3===a.level?new cd(this,0):sb("invalid level of Number",this,a)},Vc.prototype.toString=function(){if(isNaN(this.n))return"+nan.0";if(this.n===Number.POSITIVE_INFINITY)return"+inf.0";if(this.n===Number.NEGATIVE_INFINITY)return"-inf.0";if(this===_c)return"-0.0";var a=this.n.toString();return a.match("\\.")?a:a+".0"},Vc.prototype.equals=function(a,b){return a instanceof Vc&&this.n===a.n},Vc.prototype.isRational=function(){return this.isFinite()},Vc.prototype.isInteger=function(){return this.isFinite()&&this.n===Math.floor(this.n)},Vc.prototype.isReal=function(){return!0};var bd=function(a){return Qb(a,0)?-1:Pb(a,0)?1:a===_c?-1:0};Vc.prototype.add=function(a){return this.isFinite()&&a.isFinite()?Vc.makeInstance(this.n+a.n):isNaN(this.n)||isNaN(a.n)?Wc:this.isFinite()&&!a.isFinite()?a:!this.isFinite()&&a.isFinite()?this:bd(this)*bd(a)===1?this:Wc},Vc.prototype.subtract=function(a){return this.isFinite()&&a.isFinite()?Vc.makeInstance(this.n-a.n):isNaN(this.n)||isNaN(a.n)?Wc:this.isFinite()||a.isFinite()?this.isFinite()?Hb(a,-1):this:bd(this)===bd(a)?Wc:this},Vc.prototype.negate=function(){return Vc.makeInstance(-this.n)},Vc.prototype.multiply=function(a){return Vc.makeInstance(this.n*a.n)},Vc.prototype.divide=function(a){return Vc.makeInstance(this.n/a.n)},Vc.prototype.toFixnum=function(){return this.n},Vc.prototype.numerator=function(){var a=this.n.toString(),b=a.match(/^(.*)\.(.*)$/);if(b){var c=parseInt(b[2]),d=Math.pow(10,b[2].length),e=Fc(d,c),f=d/e;return Vc.makeInstance(Math.round(this.n*f))}return this},Vc.prototype.denominator=function(){var a=this.n.toString(),b=a.match(/^(.*)\.(.*)$/);if(b){var c=parseInt(b[2]),d=Math.pow(10,b[2].length),e=Fc(d,c);return Vc.makeInstance(Math.round(d/e))}return Vc.makeInstance(1)},Vc.prototype.floor=function(){return Vc.makeInstance(Math.floor(this.n))},Vc.prototype.ceiling=function(){return Vc.makeInstance(Math.ceil(this.n))},Vc.prototype.greaterThan=function(a){return this.n>a.n},Vc.prototype.greaterThanOrEqual=function(a){return this.n>=a.n},Vc.prototype.lessThan=function(a){return this.n<a.n},Vc.prototype.lessThanOrEqual=function(a){return this.n<=a.n},Vc.prototype.integerSqrt=function(){return this===_c?this:zb(this)?this.n>=0?Vc.makeInstance(Math.floor(Math.sqrt(this.n))):cd.makeInstance(ad,Vc.makeInstance(Math.floor(Math.sqrt(-this.n)))):void sb("integerSqrt: can only be applied to an integer",this)},Vc.prototype.sqrt=function(){if(this.n<0){var a=cd.makeInstance(0,Vc.makeInstance(Math.sqrt(-this.n)));return a}return Vc.makeInstance(Math.sqrt(this.n))},Vc.prototype.abs=function(){return Vc.makeInstance(Math.abs(this.n))},Vc.prototype.log=function(){return this.n<0?new cd(this,0).log():Vc.makeInstance(Math.log(this.n))},Vc.prototype.angle=function(){return 0===this.n?0:this.n>0?0:Vc.pi},Vc.prototype.tan=function(){return Vc.makeInstance(Math.tan(this.n))},Vc.prototype.atan=function(){return Vc.makeInstance(Math.atan(this.n))},Vc.prototype.cos=function(){return Vc.makeInstance(Math.cos(this.n))},Vc.prototype.sin=function(){return Vc.makeInstance(Math.sin(this.n))},Vc.prototype.expt=function(a){return 1===this.n?a.isFinite()?this:isNaN(a.n)?this:this:Vc.makeInstance(Math.pow(this.n,a.n))},Vc.prototype.exp=function(){return Vc.makeInstance(Math.exp(this.n))},Vc.prototype.acos=function(){return Vc.makeInstance(Math.acos(this.n))},Vc.prototype.asin=function(){return Vc.makeInstance(Math.asin(this.n))},Vc.prototype.imaginaryPart=function(){return 0},Vc.prototype.realPart=function(){return this},Vc.prototype.round=function(){return isFinite(this.n)?this===_c?this:.5===Math.abs(Math.floor(this.n)-this.n)?Math.floor(this.n)%2===0?Vc.makeInstance(Math.floor(this.n)):Vc.makeInstance(Math.ceil(this.n)):Vc.makeInstance(Math.round(this.n)):this},Vc.prototype.conjugate=function(){return this},Vc.prototype.magnitude=Vc.prototype.abs;var cd=function(a,b){this.r=a,this.i=b};cd.makeInstance=function(a,b){return void 0===b&&(b=0),xb(b)&&zb(b)&&Gc(b)?a:((yb(a)||yb(b))&&(a=Db(a),b=Db(b)),new cd(a,b))},cd.prototype.toString=function(){var a=this.r.toString(),b=this.i.toString();return"-"===b[0]||"+"===b[0]?a+b+"i":a+"+"+b+"i"},cd.prototype.isFinite=function(){return uc(this.r)&&uc(this.i)},cd.prototype.isRational=function(){return vb(this.r)&&Lb(this.i,0)},cd.prototype.isInteger=function(){return zb(this.r)&&Lb(this.i,0)},cd.prototype.toExact=function(){return cd.makeInstance(Cb(this.r),Cb(this.i))},cd.prototype.toInexact=function(){return cd.makeInstance(Db(this.r),Db(this.i))},cd.prototype.isExact=function(){return xb(this.r)&&xb(this.i)},cd.prototype.isInexact=function(){return yb(this.r)||yb(this.i)},cd.prototype.level=3,cd.prototype.liftTo=function(a){sb("Don't know how to lift Complex number",this,a)},cd.prototype.equals=function(a){var b=a instanceof cd&&Kb(this.r,a.r)&&Kb(this.i,a.i);return b},cd.prototype.greaterThan=function(a){return this.isReal()&&a.isReal()||sb(">: expects argument of type real number",this,a),Pb(this.r,a.r)},cd.prototype.greaterThanOrEqual=function(a){return this.isReal()&&a.isReal()||sb(">=: expects argument of type real number",this,a),Nb(this.r,a.r)},cd.prototype.lessThan=function(a){return this.isReal()&&a.isReal()||sb("<: expects argument of type real number",this,a),Qb(this.r,a.r)},cd.prototype.lessThanOrEqual=function(a){return this.isReal()&&a.isReal()||sb("<=: expects argument of type real number",this,a),Ob(this.r,a.r)},cd.prototype.abs=function(){return Kb(this.i,0).valueOf()||sb("abs: expects argument of type real number",this),Xb(this.r)},cd.prototype.toFixnum=function(){return Kb(this.i,0).valueOf()||sb("toFixnum: expects argument of type real number",this),Bb(this.r)},cd.prototype.numerator=function(){return this.isReal()||sb("numerator: can only be applied to real number",this),Ub(this.n)},cd.prototype.denominator=function(){return this.isReal()||sb("floor: can only be applied to real number",this),Vb(this.n)},cd.prototype.add=function(a){return cd.makeInstance(Eb(this.r,a.r),Eb(this.i,a.i))},cd.prototype.subtract=function(a){return cd.makeInstance(Gb(this.r,a.r),Gb(this.i,a.i))},cd.prototype.negate=function(){return cd.makeInstance(yc(this.r),yc(this.i))},cd.prototype.multiply=function(a){if(a.isReal())return cd.makeInstance(Hb(this.r,a.r),Hb(this.i,a.r));var b=Gb(Hb(this.r,a.r),Hb(this.i,a.i)),c=Eb(Hb(this.r,a.i),Hb(this.i,a.r));return cd.makeInstance(b,c)},cd.prototype.divide=function(a){var b,c,d,e,f,g,h;if(a.isReal())return cd.makeInstance(Jb(this.r,a.r),Jb(this.i,a.r));if(this.isInexact()||a.isInexact())return b=this.r,c=this.i,d=a.r,e=a.i,Ob(Xb(e),Xb(d))?(f=Jb(e,d),g=Jb(Eb(b,Hb(c,f)),Eb(d,Hb(e,f))),h=Jb(Gb(c,Hb(b,f)),Eb(d,Hb(e,f)))):(f=Jb(d,e),g=Jb(Eb(Hb(b,f),c),Eb(Hb(d,f),e)),h=Jb(Gb(Hb(c,f),b),Eb(Hb(d,f),e))),cd.makeInstance(g,h);var i=$b(a),j=Hb(this,i),k=jc(Hb(a,i)),l=cd.makeInstance(Jb(jc(j),k),Jb(ic(j),k));return l},cd.prototype.conjugate=function(){var a=cd.makeInstance(this.r,Gb(0,this.i));return a},cd.prototype.magnitude=function(){var a=Eb(Hb(this.r,this.r),Hb(this.i,this.i));return Wb(a)},cd.prototype.isReal=function(){return Lb(this.i,0)},cd.prototype.integerSqrt=function(){return zb(this)?mc(this.r):void sb("integerSqrt: can only be applied to an integer",this)},cd.prototype.sqrt=function(){if(this.isReal())return Wb(this.r);var a=Eb(this.magnitude(),this.r),b=Wb(zc(a)),c=Jb(this.i,Wb(Hb(a,2)));return cd.makeInstance(b,c)},cd.prototype.log=function(){var a=this.magnitude(),b=this.angle(),c=Eb(ac(a),Ac(b));return c},cd.prototype.angle=function(){if(this.isReal())return bc(this.r);if(Kb(0,this.r)){var a=zc(Vc.pi);return Pb(this.i,0)?a:yc(a)}var a=dc(Jb(Xb(this.i),Xb(this.r)));return Pb(this.r,0)?Pb(this.i,0)?a:yc(a):Pb(this.i,0)?Gb(Vc.pi,a):Gb(a,Vc.pi)};var dd=cd.makeInstance(0,1),ed=cd.makeInstance(0,-1);cd.prototype.tan=function(){return Jb(this.sin(),this.cos())},cd.prototype.atan=function(){return Kb(this,dd)||Kb(this,ed)?Yc:Hb(dd,Hb(Vc.makeInstance(.5),ac(Jb(Eb(dd,this),Eb(dd,Gb(0,this))))))},cd.prototype.cos=function(){if(this.isReal())return ec(this.r);var a=Ac(this),b=yc(a);return zc(Eb(Sb(a),Sb(b)))},cd.prototype.sin=function(){if(this.isReal())return fc(this.r);var a=Ac(this),b=yc(a),c=cd.makeInstance(0,2),d=Gb(Sb(a),Sb(b)),e=Jb(d,c);return e},cd.prototype.expt=function(a){if(Ab(a)&&Nb(a,0))return Bc(this,a);var b=Hb(a,this.log());return Sb(b)},cd.prototype.exp=function(){var a=Sb(this.r),b=ec(this.i),c=fc(this.i);return Hb(a,Eb(b,Ac(c)))},cd.prototype.acos=function(){if(this.isReal())return gc(this.r);var a=zc(Vc.pi),b=Ac(this),c=Wb(Gb(1,lc(this))),d=Ac(ac(Eb(b,c)));return Eb(a,d)},cd.prototype.asin=function(){if(this.isReal())return hc(this.r);var a=Gb(1,lc(this)),b=Wb(a);return Hb(2,dc(Jb(this,Eb(1,b))))},cd.prototype.ceiling=function(){return this.isReal()||sb("ceiling: can only be applied to real number",this),Zb(this.r)},cd.prototype.floor=function(){return this.isReal()||sb("floor: can only be applied to real number",this),Yb(this.r)},cd.prototype.imaginaryPart=function(){return this.i},cd.prototype.realPart=function(){return this.r},cd.prototype.round=function(){return this.isReal()||sb("round: can only be applied to real number",this),kc(this.r)};var fd=new RegExp("^(#[ei]#[bodx]|#[bodx]#[ei]|#[bodxei])(.*)$");i.def=new i(0),i.on=new i(1),i.off=new i(2),i.prototype.intAsExactp=function(){return this.defaultp()||this.exactp()},i.prototype.floatAsInexactp=function(){return this.defaultp()||this.inexactp()};var gd,hd=function(a,b){var c=10,b="undefined"==typeof b?i.def:b===!0?i.on:b===!1?i.off:sb("exactness must be true or false",this,r),d=a.toLowerCase().match(fd);if(d){var e=d[1].toLowerCase(),f=e.match(new RegExp("(#[ei])")),g=e.match(new RegExp("(#[bodx])"));if(f){var h=f[1].charAt(1);b="e"===h?i.on:"i"===h?i.off:sb("invalid exactness flag",this,r)}if(g){var h=g[1].charAt(1);c="b"===h?2:"o"===h?8:"d"===h?10:"x"===h?16:sb("invalid radix flag",this,r)}}var k=d?d[2]:a,l=d?!0:!1;return j(k,c,b,l)},id=0xdeadbeefcafe,jd=15715070==(16777215&id);jd&&"undefined"!=typeof navigator&&"Microsoft Internet Explorer"==navigator.appName?(n.prototype.am=q,gd=30):jd&&"undefined"!=typeof navigator&&"Netscape"!=navigator.appName?(n.prototype.am=p,gd=26):(n.prototype.am=s,gd=28),n.prototype.DB=gd,n.prototype.DM=(1<<gd)-1,n.prototype.DV=1<<gd;var kd=52;n.prototype.FV=Math.pow(2,kd),n.prototype.F1=kd-gd,n.prototype.F2=2*gd-kd;var ld,md,nd="0123456789abcdefghijklmnopqrstuvwxyz",od=[];for(ld="0".charCodeAt(0),md=0;9>=md;++md)od[ld++]=md;for(ld="a".charCodeAt(0),md=10;36>md;++md)od[ld++]=md;for(ld="A".charCodeAt(0),md=10;36>md;++md)od[ld++]=md;P.prototype.convert=Q,P.prototype.revert=R,P.prototype.reduce=S,P.prototype.mulTo=T,P.prototype.sqrTo=U,W.prototype.convert=X,W.prototype.revert=Y,W.prototype.reduce=Z,W.prototype.mulTo=_,W.prototype.sqrTo=$,n.prototype.copyTo=v,n.prototype.fromInt=w,n.prototype.fromString=y,n.prototype.clamp=z,n.prototype.dlShiftTo=G,n.prototype.drShiftTo=H,n.prototype.lShiftTo=I,n.prototype.rShiftTo=J,n.prototype.subTo=K,n.prototype.multiplyTo=L,n.prototype.squareTo=M,n.prototype.divRemTo=N,n.prototype.invDigit=V,n.prototype.isEven=aa,n.prototype.bnpExp=ba,n.prototype.toString=A,n.prototype.negate=B,n.prototype.abs=C,n.prototype.compareTo=D,n.prototype.bitLength=F,n.prototype.mod=O,n.prototype.modPowInt=ca,n.ZERO=x(0),n.ONE=x(1),Ua.prototype.convert=Va,Ua.prototype.revert=Va,Ua.prototype.mulTo=Wa,Ua.prototype.sqrTo=Xa,_a.prototype.convert=ab,_a.prototype.revert=bb,_a.prototype.reduce=cb,_a.prototype.mulTo=eb,_a.prototype.sqrTo=db;var pd=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],qd=(1<<26)/pd[pd.length-1];n.prototype.chunkSize=ha,n.prototype.toRadix=ja,n.prototype.fromRadix=ka,n.prototype.fromNumber=la,n.prototype.bitwiseTo=qa,n.prototype.changeBit=Ha,n.prototype.addTo=La,n.prototype.dMultiply=Sa,n.prototype.dAddOffset=Ta,n.prototype.multiplyLowerTo=Za,n.prototype.multiplyUpperTo=$a,n.prototype.modInt=hb,n.prototype.millerRabin=kb,n.prototype.clone=da,n.prototype.intValue=ea,n.prototype.byteValue=fa,n.prototype.shortValue=ga,n.prototype.signum=ia,n.prototype.toByteArray=ma,n.prototype.equals=na,n.prototype.min=oa,n.prototype.max=pa,n.prototype.and=sa,n.prototype.or=ua,n.prototype.xor=wa,n.prototype.andNot=ya,n.prototype.not=za,n.prototype.shiftLeft=Aa,n.prototype.shiftRight=Ba,n.prototype.getLowestSetBit=Da,n.prototype.bitCount=Fa,n.prototype.testBit=Ga,n.prototype.setBit=Ia,n.prototype.clearBit=Ja,n.prototype.flipBit=Ka,n.prototype.add=Ma,n.prototype.subtract=Na,n.prototype.multiply=Oa,n.prototype.divide=Pa,n.prototype.remainder=Qa,n.prototype.divideAndRemainder=Ra,n.prototype.modPow=fb,n.prototype.modInverse=ib,n.prototype.pow=Ya,n.prototype.expt=Ya,n.prototype.gcd=gb,n.prototype.isProbablePrime=jb,n.NEGATIVE_ONE=n.ONE.negate();var rd=function(a){return"number"==typeof a&&(a+=""),a=pb(a),new n(a,10)};n.prototype.level=0,n.prototype.liftTo=function(a){if(1===a.level)return new Uc(this,1);if(2===a.level){var b=this.toFixnum();return b===Number.POSITIVE_INFINITY?Zc:b===Number.NEGATIVE_INFINITY?$c:new Vc(b)}return 3===a.level?new cd(this,0):sb("invalid level for BigInteger lift",this,a)},n.prototype.isFinite=function(){return!0},n.prototype.isInteger=function(){return!0},n.prototype.isRational=function(){return!0},n.prototype.isReal=function(){return!0},n.prototype.isExact=function(){return!0},n.prototype.isInexact=function(){return!1},n.prototype.toExact=function(){return this},n.prototype.toInexact=function(){return Vc.makeInstance(this.toFixnum())},n.prototype.toFixnum=function(){var a,b=0,c=this.toString();if("-"===c[0]){for(a=1;a<c.length;a++)b=10*b+Number(c[a]);return-b}for(a=0;a<c.length;a++)b=10*b+Number(c[a]);return b},n.prototype.greaterThan=function(a){return this.compareTo(a)>0},n.prototype.greaterThanOrEqual=function(a){return this.compareTo(a)>=0},n.prototype.lessThan=function(a){return this.compareTo(a)<0},n.prototype.lessThanOrEqual=function(a){return this.compareTo(a)<=0},n.prototype.divide=function(a){var b=Ra.call(this,a);if(0===b[1].compareTo(n.ZERO))return b[0];var c=Eb(b[0],Uc.makeInstance(b[1],a));return c},n.prototype.numerator=function(){return this},n.prototype.denominator=function(){return 1},function(){var a=function(a,b){for(;!Ob(lc(b),a)||!Qb(a,lc(Eb(b,1)));)b=Yb(Jb(Eb(b,Yb(Jb(a,b))),2));return b};n.prototype.integerSqrt=function(){var b;return bd(this)>=0?a(this,this):(b=this.negate(),cd.makeInstance(0,a(b,b)))}}(),function(){n.prototype.sqrt=function(){var a,b=this.integerSqrt();return Lb(lc(b),this)?b:(a=Bb(this),isFinite(a)?a>=0?Vc.makeInstance(Math.sqrt(a)):cd.makeInstance(0,Vc.makeInstance(Math.sqrt(-a))):b)}}(),n.prototype.floor=function(){return this},n.prototype.ceiling=function(){return this},n.prototype.conjugate=lb("conjugate"),n.prototype.magnitude=lb("magnitude"),n.prototype.log=lb("log"),n.prototype.angle=lb("angle"),n.prototype.atan=lb("atan"),n.prototype.acos=lb("acos"),n.prototype.asin=lb("asin"),n.prototype.tan=lb("tan"),n.prototype.cos=lb("cos"),n.prototype.sin=lb("sin"),n.prototype.exp=lb("exp"),n.prototype.imaginaryPart=function(){return 0},n.prototype.realPart=function(){return this},n.prototype.round=function(){return this};var sd=function(){var a=function(a,b,c){var d=[],e={};for(e[a]=!0;;){if(c--<=0)return[d.join(""),"..."];var f=pc(Hb(a,10),b),g=qc(Hb(a,10),b);if(d.push(f.toString()),e[g]){a=g;break}e[g]=!0,a=g}for(var h=a,i=[];;){var f=pc(Hb(a,10),b),g=qc(Hb(a,10),b);if(i.push(f.toString()),Kb(g,h))break;a=g}for(var j=d.join(""),k=i.join("");j.length>=k.length&&j.substring(j.length-k.length)===k;)j=j.substring(0,j.length-k.length);return[j,k]};return function(b,c,d){var e=512;d&&"undefined"!=typeof d.limit&&(e=d.limit),zb(b)||sb("toRepeatingDecimal: n "+b.toString()+" is not an integer."),zb(c)||sb("toRepeatingDecimal: d "+c.toString()+" is not an integer."),Kb(c,0)&&sb("toRepeatingDecimal: d equals 0"),Qb(c,0)&&sb("toRepeatingDecimal: d < 0");var f=Qb(b,0)?"-":"";b=Xb(b);var g=f+pc(b,c),h=a(qc(b,c),c,e);return[g].concat(h)}}();mb.fromFixnum=ob,mb.fromString=hd,mb.makeBignum=rd,mb.makeRational=Uc.makeInstance,mb.makeFloat=Vc.makeInstance,mb.makeComplex=cd.makeInstance,mb.makeComplexPolar=tc,mb.pi=Vc.pi,mb.e=Vc.e,mb.nan=Vc.nan,mb.negative_inf=Vc.neginf,mb.inf=Vc.inf,mb.negative_one=-1,mb.zero=0,mb.one=1,mb.i=dd,mb.negative_i=ed,mb.negative_zero=_c,mb.onThrowRuntimeError=tb,mb.isSchemeNumber=ub,mb.isRational=vb,mb.isReal=wb,mb.isExact=xb,mb.isInexact=yb,mb.isInteger=zb,mb.toFixnum=Bb,mb.toExact=Cb,mb.toInexact=Db,mb.add=Eb,mb.subtract=Gb,mb.multiply=Hb,mb.divide=Jb,mb.equals=Kb,mb.eqv=Lb,mb.approxEquals=Mb,mb.greaterThanOrEqual=Nb,mb.lessThanOrEqual=Ob,mb.greaterThan=Pb,mb.lessThan=Qb,mb.expt=Rb,mb.exp=Sb,mb.modulo=Tb,mb.numerator=Ub,mb.denominator=Vb,mb.integerSqrt=mc,mb.sqrt=Wb,mb.abs=Xb,mb.quotient=pc,mb.remainder=qc,mb.floor=Yb,mb.ceiling=Zb,mb.conjugate=$b,mb.magnitude=_b,mb.log=ac,mb.angle=bc,mb.tan=cc,mb.atan=dc,mb.cos=ec,mb.sin=fc,mb.tan=cc,mb.acos=gc,mb.asin=hc,mb.cosh=rc,mb.sinh=sc,mb.imaginaryPart=ic,mb.realPart=jc,mb.round=kc,mb.sqr=lc,mb.gcd=nc,mb.lcm=oc,mb.toRepeatingDecimal=sd,mb.BigInteger=n,mb.Rational=Uc,mb.FloatPoint=Vc,mb.Complex=cd,mb.MIN_FIXNUM=vc,mb.MAX_FIXNUM=wc}()},{}],"/home/ubuntu/staging/apps/build/js/calc/equation.js":[function(a,b,c){"use strict";var d=function(a,b,c){if(this.name=a,this.params=b||[],this.expression=c,3!==arguments.length)throw new Error("Equation requires name, params, and expression");this.signature=this.name,this.params.length>0&&(this.signature+="("+this.params.join(",")+")")};b.exports=d,d.prototype.isFunction=function(){return this.params.length>0},d.prototype.clone=function(){return new d(this.name,this.params.slice(),this.expression.clone())}},{}],"/home/ubuntu/staging/apps/build/js/calc/controls.html.ejs":[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("");require("./locale"),require("../locale");buf.push("\n")}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{"../locale":"/home/ubuntu/staging/apps/build/js/locale.js","./locale":"/home/ubuntu/staging/apps/build/js/calc/locale.js",ejs:"/home/ubuntu/staging/apps/node_modules/ejs/lib/ejs.js"}],"/home/ubuntu/staging/apps/build/js/calc/blocks.js":[function(a,b,c){"use strict";function d(a,b,c){a.Blocks.functional_compute={helpUrl:"",init:function(){a.FunctionalBlockUtils.initTitledFunctionalBlock(this,e.evaluate(),a.BlockValueType.NONE,[{name:"ARG1",type:a.BlockValueType.NUMBER}])}},b.functional_compute=function(){var a=Blockly.JavaScript.statementToCode(this,"ARG1",!1)||0;return"Calc.compute("+a+", 'block_id_"+this.id+"');\n"}}var e=a("./locale"),f=(a("../locale"),a("../sharedFunctionalBlocks"));c.install=function(a,b){var c=a.Generator.get("JavaScript");a.JavaScript=c;var e=function(b){var d=a.Variables.NAME_TYPE;return c.variableDB_.getDistinctName(b,d)};f.install(a,c,e),d(a,c,e)}},{"../locale":"/home/ubuntu/staging/apps/build/js/locale.js","../sharedFunctionalBlocks":"/home/ubuntu/staging/apps/build/js/sharedFunctionalBlocks.js","./locale":"/home/ubuntu/staging/apps/build/js/calc/locale.js"}],"/home/ubuntu/staging/apps/build/js/calc/locale.js":[function(a,b,c){"use strict";b.exports=window.blockly.calc_locale},{}]},{},["/home/ubuntu/staging/apps/build/js/calc/main.js"]);